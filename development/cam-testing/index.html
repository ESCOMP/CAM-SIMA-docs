
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cam-coding-standards/">
      
      
        <link rel="next" href="../debugging/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Testing - CAM-SIMA</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 8H6l6-6 6 6h-4v8h4l-6 6-6-6h4z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#testing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CAM-SIMA" class="md-header__button md-logo" aria-label="CAM-SIMA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CAM-SIMA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CAM-SIMA" class="md-nav__button md-logo" aria-label="CAM-SIMA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CAM-SIMA
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Conversion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Conversion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/conversion-background/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0 - Background &amp; Prep work
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/convert-portable-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1 - Convert the "portable" layer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/create-metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 - Create metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/create-namelist-xml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 - Create namelist XML file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/interstitials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 - Interstitials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/create-sdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5 - Create an SDF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/create-snapshots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6 - Create snapshots of CAM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/check-metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7 - Check metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/run-cam-sima/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8 - Run CAM-SIMA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/back-to-cam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9 - Bring back into CAM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/final-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10 - Final steps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversion/walkthrough/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Walkthrough Example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/cam-build-process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/cam-run-process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/ccpp-in-cam-sima/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CCPP in CAM-SIMA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/constituents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constituents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/directory-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CAM-SIMA directory structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History &amp; model output
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/sima-design-goals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design goals &amp; features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cam-sima-workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development workflow for CAM-SIMA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cam-coding-standards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding standards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#regression-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Regression Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Regression Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-the-regression-tests-manual" class="md-nav__link">
    <span class="md-ellipsis">
      Running the regression tests (manual)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running the regression tests (manual)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inspecting-test-output" class="md-nav__link">
    <span class="md-ellipsis">
      Inspecting test output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-test-info" class="md-nav__link">
    <span class="md-ellipsis">
      Additional test info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#archiving-baselines" class="md-nav__link">
    <span class="md-ellipsis">
      Archiving baselines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-regression-test" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a new regression test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-continuous-integration-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Github continuous integration testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Github continuous integration testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-unit-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Python unit testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python unit testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-sample-files" class="md-nav__link">
    <span class="md-ellipsis">
      Updating sample files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-source-code-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Static Source Code Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Source Code Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-fleximod-tests" class="md-nav__link">
    <span class="md-ellipsis">
      git-fleximod tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging techniques
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with git and GitHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git &amp; GitHub FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-fleximod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git-fleximod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tool-recommendations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tool recommendations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/creating-a-case/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating, configuring, and running a case
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History &amp; model output
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Atmospheric_physics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Atmospheric_physics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../atmospheric_physics/directory-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    atmospheric_physics directory structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../atmospheric_physics/development_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development workflow for atmospheric_physics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../atmospheric_physics/Tagging-Instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to properly tag an atmospheric_physics commit
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#regression-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Regression Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Regression Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-the-regression-tests-manual" class="md-nav__link">
    <span class="md-ellipsis">
      Running the regression tests (manual)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running the regression tests (manual)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inspecting-test-output" class="md-nav__link">
    <span class="md-ellipsis">
      Inspecting test output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-test-info" class="md-nav__link">
    <span class="md-ellipsis">
      Additional test info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#archiving-baselines" class="md-nav__link">
    <span class="md-ellipsis">
      Archiving baselines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-regression-test" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a new regression test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-continuous-integration-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Github continuous integration testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Github continuous integration testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-unit-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Python unit testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python unit testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-sample-files" class="md-nav__link">
    <span class="md-ellipsis">
      Updating sample files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-source-code-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Static Source Code Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Source Code Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-fleximod-tests" class="md-nav__link">
    <span class="md-ellipsis">
      git-fleximod tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="testing">Testing</h1>
<p>This page describes the various automated and manual tests that are run for CAM-SIMA whenever the code is modified, as well as instructions for how to add new tests.</p>
<h2 id="regression-testing">Regression Testing</h2>
<h3 id="running-the-regression-tests-manual">Running the regression tests (manual)</h3>
<p><strong>NOTE:  Regression testing on derecho should be done for every PR before merging!</strong></p>
<p>Users can manually run regression tests on Derecho to ensure that the model builds correctly in various configurations.  The tests can be run with a local copy of CAM-SIMA by using the <code>test_driver.sh</code> script under <code>$CAM-SIMA/test/system</code>.  To run the tests associated with a particular compiler option one can do the following commands:</p>
<div class="admonition warning">
<p class="admonition-title">run git-fleximod</p>
<p>Make sure you have run <code>bin/git-fleximod update</code> before you run the tests!</p>
</div>
<p>For running GNU tests*:</p>
<pre><code>env CAM_FC=gnu ./test_driver.sh -f
</code></pre>
<p>For running Intel tests*:</p>
<pre><code>env CAM_FC=intel ./test_driver.sh -f
</code></pre>
<p>*Note: you may also have to include the environment variable <code>CAM_ACCOUNT</code> on derecho, which is your account key</p>
<div class="admonition note">
<p class="admonition-title">test_driver.sh default</p>
<p>By default, <code>test_driver.sh</code> will compare against the baselines in <code>/glade/campaign/cesm/community/amwg/sima_baselines/latest_&lt;CAM_FC&gt;</code>. If you wish to compare against different baselines, specify the path to those baselines with the environment variable <code>BL_TESTDIR</code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Running test_driver.sh with no baseline comparison</p>
<p>If you do not wish to compare to baselines, don't use the <code>BL_TESTDIR</code> environment variable and use the flag <code>--no-bl-compare</code></p>
</div>
<p>Running the script will produce a directory in your scratch space labeled <code>aux_sima_&lt;CAM_FC&gt;_&lt;timestamp&gt;</code>, where <code>&lt;CAM_FC&gt;</code> is the compiler you chose, and <code>&lt;timestamp&gt;</code> is the timestamp (starting with the date) of when the tests were started, along with a job submitted to the local batch system.</p>
<p>Inside the directory you should see an executable labeled <code>cs.status.*</code>.  Running that command after the submitted job has finished will display the test results. <strong>Everything should be labeled <code>PASS</code>.  Any other label indicates that a test may have failed, and should be investigated.</strong> Expected failures can be found in the <code>$CAM-SIMA/test/existing-test-failures.txt</code> file.</p>
<h4 id="inspecting-test-output">Inspecting test output</h4>
<p>If you have an unexpected FAIL or PEND or DIFF, you will want to investigate further. Start by navigating into the test directory, for example:</p>
<pre><code>cd SMS_Ln9.ne5pg3_ne5pg3_mg37.FTJ16.derecho_intel.cam-outfrq_se_cslam.GC.aux_sima_intel_20241223100339
</code></pre>
<p>If you have familiarity with CAM cases, the setup and directory structure will be familiar.</p>
<ul>
<li>A good place to start is the <code>TestStatus.log</code> file, which will include almost all test output (including build failures and information on where to look for other failures)</li>
<li>Build logs for each component are in the <code>bld</code> directory. If you look at the filenames and one or more doesn't have the <code>.gz</code> end tag, those are likely culprits for having the error.</li>
<li>Run logs are in the <code>run</code> directory. Similar to the build logs, log files that aren't zipped up are candidates for containing errors. The <code>atm.log.*</code> and <code>cesm.log.*</code> files are likely going to contain the information about the error you're seeking.</li>
<li>Refer to the procedures for <a href="../../conversion/check-metadata/">checking metadata</a> and <a href="../../conversion/run-cam-sima/">running CAM-SIMA</a> for additional debugging help</li>
</ul>
<h4 id="additional-test-info">Additional test info</h4>
<p>The tests themselves are listed in <code>&lt;CAM-SIMA&gt;/cime_config/testdefs/testlist_cam.xml</code>. Any files that need to be included in order for the tests to run properly are located in <code>&lt;CAM-SIMA/cime_config/testdefs/testmods_dirs/cam/outfrq_XXX</code>, where <code>XXX</code> is the name of the test.  Additional information on the CIME testing system, which is what this testing infrastructure is built on, can be found <a href="https://esmci.github.io/cime/versions/master/html/users_guide/testing.html">online here</a>. </p>
<h3 id="archiving-baselines">Archiving baselines</h3>
<p><strong>If your PR changes answers</strong>, then after you have run the tests, merged your PR, and created a tag (see <a href="../git-basics/#tagging-a-commit">tag workflow</a>), you will need to archive your baselines for the next person.</p>
<p>To do this, navigate to <code>$CAM-SIMA/test/system</code> on derecho and run:</p>
<pre><code>env CESM_TESTDIR=/glade/derecho/scratch/YourName/aux_sima_yyyymmddsssss CAM_FC=INTEL ./archive_baseline.sh &lt;sima tag&gt;
</code></pre>
<pre><code>env CESM_TESTDIR=/glade/derecho/scratch/YourName/aux_sima_yyyymmddsssss CAM_FC=GNU ./archive_baseline.sh &lt;sima tag&gt;
</code></pre>
<div class="admonition note">
<p class="admonition-title">Baseline 'latest' symlink</p>
<p>By default, <code>archive_baseline.sh</code> will create a symlink to the relevant <code>latest_&lt;CAM_FC&gt;</code> directory. If you are archiving old baselines and do not want to create the symlink, use the <code>--no-symlink</code> flag.</p>
</div>
<h3 id="adding-a-new-regression-test">Adding a new regression test</h3>
<p>The test list can be found here: <code>$CAM-SIMA/cime_config/testdefs/testlist_cam.xml</code></p>
<ul>
<li>If you are adding a new machine, compiler or category for an existing test, add a new <code>&lt;machine&gt;</code> XML entry to that <code>&lt;test&gt;</code> entry</li>
<li>If you are adding a fully new test, add a <em>new</em> <code>&lt;test&gt;</code> XML entry with the following structure:</li>
</ul>
<pre><code>&lt;test compset=&quot;&lt;COMPSET_NAME&gt;&quot; grid=&quot;&lt;GRID_ALIAS&gt;&quot; name=&quot;&lt;TEST_TYPE&gt;_&lt;TEST_MOD&gt;&quot; testmods=&quot;&lt;RELPATH_TO_TESTMODS_DIR&gt;&quot;&gt;
  &lt;machines&gt;
    &lt;machine name=&quot;&lt;MACH_NAME&gt;&quot; compiler=&quot;&lt;COMPILER&gt;&quot; category=&quot;&lt;TEST_CATEGORY&gt;&quot;/&gt;
  &lt;/machines&gt;
  &lt;options&gt;
    &lt;option name=&quot;comment&quot;&gt;COMMENT HERE&lt;/option&gt;
    &lt;option name=&quot;wallclock&quot;&gt;WALLCLOCK_TIME&lt;/option&gt;
  &lt;/options&gt;
&lt;/test&gt;
</code></pre>
<ul>
<li><code>&lt;COMPSET_NAME&gt;</code>: component set alias (or long name) - you can see more about compsets <a href="../../usage/creating-a-case/">here</a></li>
<li><code>&lt;GRID_ALIAS&gt;</code>: model grid/resolution you'd like to run on - you can see more about grids <a href="../../usage/creating-a-case/">here</a><ul>
<li><strong>Try to use the lowest/coarsest resolution that will still accomplish your testing goals</strong></li>
</ul>
</li>
<li><code>&lt;TEST_TYPE&gt;</code>: type of test to be run. You can find the testing types <a href="https://esmci.github.io/cime/versions/master/html/users_guide/testing.html#testtype">here</a>.</li>
<li><code>&lt;TEST_MOD&gt;</code>: test modifier that changes the default behavior of the test type. More <a href="https://esmci.github.io/cime/versions/master/html/users_guide/testing.html#modifiers">here</a><ul>
<li><strong>Unless a longer run is necessary to exercise the code you are testing, run for 9 timesteps (_Ln9)</strong></li>
</ul>
</li>
<li><code>&lt;RELPATH_TO_TESTMODS_DIR&gt;</code>: relative path to the testmods directory for this run; usually looks something like <code>"cam/some_directory_name/"</code><ul>
<li>The testmods directory will contain any namelist mods and XML configuration variable changes for the test (<code>user_nl_cam</code> and/or <code>shell_commands</code>)</li>
<li>testmods directories can be found in <code>$CAM-SIMA/cime_config/testdefs/testmods_dirs/cam/</code></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">standard snapshot test mods</p>
<p>All new test mod directories will likely include a mod to CAM_CONFIG_OPTS in <code>shell_commands</code> as well as the following mods to <code>user_nl_cam</code>:</p>
<ul>
<li><code>ncdata</code> (initial data file - the "before" snapshot)</li>
<li><code>ncdata_check</code> (check file - the "after" snapshot)</li>
<li><code>ncdata_check_err=.true.</code> (will cause the test to fail if the ncdata check process fails)</li>
<li><code>min_difference=&lt;some small number&gt;</code> (if your ncdata_check had roundoff errors, set this to a number slightly above your roundoff)</li>
<li><code>pver=30</code> (to match your snapshot file)</li>
<li>Some relevant history fields for baseline comparisons - see <a href="../../usage/history/">history usage</a></li>
</ul>
</div>
<ul>
<li><code>&lt;MACH_NAME&gt;</code>: machine name (options: <code>derecho</code>, <code>izumi</code>, <code>casper</code>)</li>
<li><code>&lt;COMPILER&gt;</code>: compiler to be used (options: <code>gnu</code>, <code>nag</code>, <code>intel</code>, <code>nvhpc</code>)</li>
<li><code>&lt;TEST_CATEGORY&gt;</code>: group of tests that this test belongs to - the default run by <code>test_driver.sh</code> is <code>aux_sima</code> (which is run for each PR to CAM-SIMA)</li>
<li><code>WALLCLOCK_TIME</code>: maximum amount of time that the job will be allowed to run</li>
</ul>
<p>Here is an example test entry for a 2-timestep smoke test of kessler physics on a coarse MPAS grid, run with both intel and gnu </p>
<pre><code>  &lt;test compset=&quot;FKESSLER&quot; grid=&quot;mpasa480_mpasa480&quot; name=&quot;SMS_Ln2&quot; testmods=&quot;cam/outfrq_kessler_mpas_derecho_nooutput/&quot;&gt;
    &lt;machines&gt;
      &lt;machine name=&quot;derecho&quot; compiler=&quot;intel&quot; category=&quot;aux_sima&quot;/&gt;
      &lt;machine name=&quot;derecho&quot; compiler=&quot;gnu&quot; category=&quot;aux_sima&quot;/&gt;
    &lt;/machines&gt;
    &lt;options&gt;
      &lt;option name=&quot;wallclock&quot;&gt;00:10:00&lt;/option&gt;
      &lt;option name=&quot;comment&quot;&gt;GNU build test for MPAS dycore (with Kessler physics)&lt;/option&gt;
    &lt;/options&gt;
  &lt;/test&gt;
</code></pre>
<h2 id="github-continuous-integration-testing">Github continuous integration testing</h2>
<p>The following tests/linters are run automatically on pull requests to <code>develop</code> in github. You can see previous runs of the CI tests <a href="https://github.com/ESCOMP/CAM-SIMA/actions">here</a></p>
<h3 id="python-unit-testing">Python unit testing</h3>
<p>CAM-SIMA supports two kinds of python unit tests, <code>doctest</code> and <code>unittest</code> tests, both of which are part of the standard python library.  </p>
<p>All <code>unittest</code> tests should  be in:</p>
<p><code>CAM-SIMA/test/unit</code></p>
<p>while all files used by the tests should be in:</p>
<p><code>CAM-SIMA/test/unit/sample_files</code></p>
<p>All <code>unittest</code> tests are automatically run via Github Actions whenever a Pull Request (PR) is opened, modified, or merged.  </p>
<p>All <code>doctest</code> tests are also run automatically as long as the scripts they are located in are under <code>CAM-SIMA/cime_config</code> or <code>CAM-SIMA/src/data</code>.</p>
<p>To manually run all of the unit tests at any time, simply run the following shell script:</p>
<p><code>CAM-SIMA/test/run_unit_tests.sh</code></p>
<p>Finally, when adding new tests, determine if the test can be done in only a few lines with minimal interaction with external files or variables.  If so, then it would likely be best as a <code>doctest</code>.  Otherwise it should be a <code>unittest</code> test.  Failure to follow this rule of thumb could result in test failures in the Github Actions workflow.  Also remember to add your new tests to the <code>run_tests.sh</code> script so future users can easily run the tests manually.</p>
<h4 id="updating-sample-files">Updating sample files</h4>
<p>If you modified any python files in your code modifications (those in <code>cime_config</code> or in <code>src/data</code>), you may need to update the sample files to match what is now expected.</p>
<ol>
<li>Run the unit tests as described above</li>
<li>
<p>If you have failures, quickly check that the diffs are expected</p>
<p><code>diff &lt;tmp file&gt; &lt;sample file&gt;</code></p>
</li>
<li>
<p>Copy over the changed files from the <code>tmp</code> directory to the <code>sample_files</code> directory</p>
</li>
<li>Rerun the tests to confirm they all pass now.</li>
</ol>
<h3 id="static-source-code-analysis">Static Source Code Analysis</h3>
<h4 id="python">Python</h4>
<p>Any python script which is added or modified via a PR will automatically be analyzed using <code>pylint</code>, and must have a score of 9.5 or greater in order to not be marked as a test failure.  The hidden <code>pylintrc</code> file used for the analysis can be found here:</p>
<p><code>CAM-SIMA/test/.pylintrc</code></p>
<p>Users can also manually run <code>pylint</code> against the core python build scripts by running the following shell script:</p>
<p><code>CAM-SIMA/test/pylint_test.sh</code></p>
<p>Please note that <code>pylint</code> is not part of the standard python library, and so it may need to be installed before being able to run the shell script.</p>
<h3 id="git-fleximod-tests">git-fleximod tests</h3>
<p><a href="../git-fleximod/">git-fleximod</a> CI tests are run on both the oldest supported (currently 3.8) and latest versions of python to confirm:</p>
<ul>
<li><code>bin/git-fleximod update</code> works on the existing <code>.gitmodules</code> file</li>
<li>All module <code>url</code>s and <code>fxDONOTUSEurl</code>s match (e.g. a temporary fork was not committed)</li>
<li>All module <code>fxtag</code>s exist and are in sync with submodule hashes<ul>
<li>Also confirms that no <code>fxtag</code> is a branch</li>
</ul>
</li>
<li>Spare checkout files exist</li>
</ul>
<p>If a test fails:</p>
<ul>
<li>View the run on github (either on the PR itself or in the <a href="https://github.com/ESCOMP/CAM-SIMA/actions">actions</a> tab)</li>
<li>View the output under <code>Run $GITHUB_WORKSPACE/bin/git-fleximod update</code><ul>
<li>Errors will be reported in course of the test execution <ul>
<li>Compare with the last time the test succeeded to see what has changed</li>
</ul>
</li>
<li>Errors may also be reported at the end of the execution</li>
</ul>
</li>
<li>Update the <code>.gitmodules</code> file to fix any errors and push up your changes to the branch, at which time the tests will be rerun</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Run git-fleximod tests locally</p>
<p>You can (somewhat) reproduce the git-fleximod test locally by running the following</p>
<p><code>bin/git-fleximod update &amp;&amp; 
bin/git-fleximod test</code></p>
</div>
<p><strong>Some example failures:</strong></p>
<p>URL does not match (no forks allowed!):</p>
<pre><code>cice url https://github.com/peverwhee/CESM_CICE not in sync with required https://github.com/ESCOMP/CESM_CICE
</code></pre>
<p>Tags out of sync (may need to commit the updated module directory):</p>
<pre><code>hemco hemco-cesm2_0_hemco_3_9_0 7bd8358 is out of sync with .gitmodules hemco-cesm2_0_hemco3_9_0
</code></pre>
<p>Sparse checkout file missing (check the path):</p>
<pre><code>mpas sparse checkout file .mpas_sparse_checkout not found
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>