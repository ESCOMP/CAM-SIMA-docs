<!-- -*- mode: jinja2 -*- -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="MPAS dynamical core solves the fully compressible non-hydrostatic equations of atmospheric motion.">
    <meta name="author" content="CAM-SIMA & MPAS Developers">
    <link href="../favicon.png" rel="icon">

    <title>dynamics_to_physics_coupling – MPAS Dynamical Core</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      crossorigin="anonymous"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      rel="stylesheet"
    >
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    ></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
      async
      crossorigin="anonymous"
      integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw="
    ></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>
    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html"
            >MPAS Dynamical Core </a
          >
          <button
            class="navbar-toggler"
            data-bs-target="#navbar"
            data-bs-toggle="collapse"
            type="button"
            aria-controls="navbar"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse collapse" id="navbar">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div>
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>
      dynamics_to_physics_coupling
      <small
        >          Module
          Subroutine
</small
      >
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 6.3% of total for procedures.">229 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dyn_coupling_impl.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dyn_coupling_impl.f90.html'>dyn_coupling_impl.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/dyn_coupling_impl.html'>dyn_coupling_impl</a></li>
            <li class="breadcrumb-item active" aria-current="page">dynamics_to_physics_coupling</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">  <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-column_index">column_index</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-dp_col">dp_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-dpd_col">dpd_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-dz_col">dz_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-exner">exner</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-index_qv~4">index_qv</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-is_water_species_index~2">is_water_species_index</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-omega_mid_col">omega_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-p_int_col">p_int_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-p_mid_col~2">p_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-pd_int_col">pd_int_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-pd_mid_col">pd_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-qv_mid_col~2">qv_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-rho_mid_col">rho_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-rho_zz">rho_zz</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-rhod_mid_col">rhod_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-scalars~4">scalars</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-sigma_all_q_mid_col">sigma_all_q_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-subname~68">subname</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-t_mid_col">t_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-theta_m">theta_m</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-tm_mid_col~2">tm_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-tv_mid_col~2">tv_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-u_mid_col">u_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-ucellmeridional~3">ucellmeridional</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-ucellzonal~3">ucellzonal</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-v_mid_col">v_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-w~2">w</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-z_int_col">z_int_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-zgrid~3">zgrid</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-zz~2">zz</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-final_shared_variables~2">final_shared_variables</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-init_shared_variables~2">init_shared_variables</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_column">set_physics_state_column</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_external">set_physics_state_external</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-update_shared_variables">update_shared_variables</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#src">dynamics_to_physics_coupling</a>
      </div>
    </div>


  </div>
</div>

    <div class="col-md-9" id="text">
      <h2>module subroutine dynamics_to_physics_coupling()  
    <a href="../interface/dynamics_to_physics_coupling.html"><button type="button" class="btn btn-info depwarn">Interface →</button></a>
</h2>
          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item">cam_logfile</li>
                  <li class="list-inline-item"><a href='../module/dyn_comp.html'>dyn_comp</a></li>
                  <li class="list-inline-item"><a href='../module/dyn_grid.html'>dyn_grid</a></li>
                  <li class="list-inline-item">shr_kind_mod</li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dynamics_to_physics_coupling~~UsesGraph Pages: 1 -->
<svg id="procdynamics_to_physics_couplingUsesGraph" width="641pt" height="149pt"
 viewBox="0.00 0.00 641.00 148.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph" class="graph" transform="scale(0.84 0.84) rotate(0) translate(4 173)">
<title>proc~~dynamics_to_physics_coupling~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-173 760,-173 760,4 -4,4"/>
<!-- proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node1" class="node">
<title>proc~dynamics_to_physics_coupling</title>
<polygon fill="none" stroke="black" points="756,-86 581,-86 581,-62 756,-62 756,-86"/>
<text text-anchor="middle" x="668.5" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50">dynamics_to_physics_coupling</text>
</g>
<!-- cam_logfile -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node2" class="node">
<title>cam_logfile</title>
<polygon fill="#337ab7" stroke="#337ab7" points="539,-146 465,-146 465,-122 539,-122 539,-146"/>
<text text-anchor="middle" x="502" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_logfile</text>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;cam_logfile -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge1" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;cam_logfile</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M634.21,-86.14C608.6,-95.48 573.02,-108.46 545.38,-118.54"/>
<polygon fill="#000000" stroke="#000000" points="544.15,-115.26 535.96,-121.98 546.55,-121.84 544.15,-115.26"/>
</g>
<!-- module~dyn_comp -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node3" class="node">
<title>module~dyn_comp</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node3"><a xlink:href="../module/dyn_comp.html" xlink:title="dyn_comp">
<polygon fill="#337ab7" stroke="#337ab7" points="402.5,-106 335.5,-106 335.5,-82 402.5,-82 402.5,-106"/>
<text text-anchor="middle" x="369" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_comp</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_comp -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge2" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_comp</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M580.65,-79.84C525.4,-83.55 456.27,-88.2 412.61,-91.14"/>
<polygon fill="#000000" stroke="#000000" points="412.36,-87.64 402.62,-91.81 412.83,-94.63 412.36,-87.64"/>
</g>
<!-- module~dyn_grid -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node4" class="node">
<title>module~dyn_grid</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node4"><a xlink:href="../module/dyn_grid.html" xlink:title="dyn_grid">
<polygon fill="#337ab7" stroke="#337ab7" points="531,-66 473,-66 473,-42 531,-42 531,-66"/>
<text text-anchor="middle" x="502" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_grid</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_grid -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge3" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_grid</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M580.91,-63.47C567.03,-61.78 553.3,-60.12 541.33,-58.66"/>
<polygon fill="#000000" stroke="#000000" points="541.66,-55.17 531.31,-57.44 540.81,-62.12 541.66,-55.17"/>
</g>
<!-- shr_kind_mod -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node5" class="node">
<title>shr_kind_mod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="545,-24 459,-24 459,0 545,0 545,-24"/>
<text text-anchor="middle" x="502" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shr_kind_mod</text>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;shr_kind_mod -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge4" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;shr_kind_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M635.39,-61.9C609.46,-52.13 572.79,-38.3 544.61,-27.68"/>
<polygon fill="#000000" stroke="#000000" points="545.62,-24.32 535.03,-24.07 543.15,-30.87 545.62,-24.32"/>
</g>
<!-- module~dyn_mpas_subdriver -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node7" class="node">
<title>module~dyn_mpas_subdriver</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node7"><a xlink:href="../module/dyn_mpas_subdriver.html" xlink:title="dyn_mpas_subdriver">
<polygon fill="#337ab7" stroke="#337ab7" points="279,-106 157,-106 157,-82 279,-82 279,-106"/>
<text text-anchor="middle" x="218" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_mpas_subdriver</text>
</a>
</g>
</g>
<!-- module~dyn_comp&#45;&gt;module~dyn_mpas_subdriver -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge5" class="edge">
<title>module~dyn_comp&#45;&gt;module~dyn_mpas_subdriver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335.3,-94C321.81,-94 305.61,-94 289.65,-94"/>
<polygon fill="#000000" stroke="#000000" points="289.23,-90.5 279.23,-94 289.23,-97.5 289.23,-90.5"/>
</g>
<!-- module~dyn_grid&#45;&gt;module~dyn_comp -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge7" class="edge">
<title>module~dyn_grid&#45;&gt;module~dyn_comp</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M472.9,-62.58C455.28,-67.96 432.22,-75 412.4,-81.05"/>
<polygon fill="#000000" stroke="#000000" points="411.22,-77.75 402.68,-84.02 413.26,-84.45 411.22,-77.75"/>
</g>
<!-- cam_grid_support -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node6" class="node">
<title>cam_grid_support</title>
<polygon fill="#337ab7" stroke="#337ab7" points="423,-64 315,-64 315,-40 423,-40 423,-64"/>
<text text-anchor="middle" x="369" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_support</text>
</g>
<!-- module~dyn_grid&#45;&gt;cam_grid_support -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge6" class="edge">
<title>module~dyn_grid&#45;&gt;cam_grid_support</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M472.9,-53.57C461.22,-53.39 447.16,-53.18 433.24,-52.97"/>
<polygon fill="#000000" stroke="#000000" points="433.21,-49.46 423.16,-52.81 433.1,-56.46 433.21,-49.46"/>
</g>
<!-- iso_fortran_env -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node8" class="node">
<title>iso_fortran_env</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node8"><a xlink:href="https://www.intel.com/content/www/us/en/docs/fortran-compiler/developer-guide-reference/2024-2/iso-fortran-env-module.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="107.5,-169 13.5,-169 13.5,-145 107.5,-145 107.5,-169"/>
<text text-anchor="middle" x="60.5" y="-154.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;iso_fortran_env -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge8" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.73,-106.11C171.56,-114.8 144.86,-126.58 121,-136 116.28,-137.86 111.32,-139.74 106.36,-141.56"/>
<polygon fill="#000000" stroke="#000000" points="105.11,-138.29 96.9,-144.99 107.49,-144.88 105.11,-138.29"/>
</g>
<!-- mpas_derived_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node9" class="node">
<title>mpas_derived_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="121,-127 0,-127 0,-103 121,-103 121,-127"/>
<text text-anchor="middle" x="60.5" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_derived_types</text>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;mpas_derived_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge9" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;mpas_derived_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M156.88,-102.12C148.46,-103.26 139.76,-104.43 131.18,-105.59"/>
<polygon fill="#000000" stroke="#000000" points="130.65,-102.13 121.2,-106.94 131.58,-109.07 130.65,-102.13"/>
</g>
<!-- mpas_kind_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node10" class="node">
<title>mpas_kind_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="112,-85 9,-85 9,-61 112,-61 112,-85"/>
<text text-anchor="middle" x="60.5" y="-70.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_kind_types</text>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;mpas_kind_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge10" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;mpas_kind_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M156.88,-85.88C145.63,-84.36 133.85,-82.77 122.57,-81.25"/>
<polygon fill="#000000" stroke="#000000" points="122.75,-77.74 112.37,-79.87 121.81,-84.68 122.75,-77.74"/>
</g>
<!-- mpi -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node11" class="node">
<title>mpi</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node11"><a xlink:href="https://www.mpi-forum.org/docs/mpi-4.1/mpi41-report/node467.htm" xlink:title="mpi">
<polygon fill="#337ab7" stroke="#337ab7" points="87.5,-43 33.5,-43 33.5,-19 87.5,-19 87.5,-43"/>
<text text-anchor="middle" x="60.5" y="-28.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi</text>
</a>
</g>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;mpi -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge11" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;mpi</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M190.73,-81.89C171.56,-73.2 144.86,-61.42 121,-52 113.41,-49 105.19,-45.97 97.36,-43.18"/>
<polygon fill="#000000" stroke="#000000" points="98.31,-39.81 87.72,-39.79 95.99,-46.41 98.31,-39.81"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocdynamics_to_physics_couplingUsesGraph = svgPanZoom('#procdynamics_to_physics_couplingUsesGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 </div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


        <p>Perform one-way coupling from the dynamics output states to the physics input states.
The other coupling direction is implemented by its counterpart, <code>physics_to_dynamics_coupling</code>.
(KCW, 2024-07-31)</p>


      <h3>Arguments</h3>
        <em>None</em>
        <br>
        <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Calls</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dynamics_to_physics_coupling~~CallsGraph Pages: 1 -->
<svg id="procdynamics_to_physics_couplingCallsGraph" width="641pt" height="557pt"
 viewBox="0.00 0.00 641.00 557.25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph" class="graph" transform="scale(0.3 0.3) rotate(0) translate(4 1859.87)">
<title>proc~~dynamics_to_physics_coupling~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1859.87 2140,-1859.87 2140,4 -4,4"/>
<!-- proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node1" class="node">
<title>proc~dynamics_to_physics_coupling</title>
<polygon fill="none" stroke="black" points="175,-1361 0,-1361 0,-1337 175,-1337 175,-1361"/>
<text text-anchor="middle" x="87.5" y="-1346.6" font-family="Helvetica,sans-Serif" font-size="10.50">dynamics_to_physics_coupling</text>
</g>
<!-- interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node2" class="node">
<title>interface~dyn_debug_print</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node2"><a xlink:href="../interface/dyn_debug_print.html" xlink:title="dyn_debug_print">
<polygon fill="#a7506f" stroke="#a7506f" points="1085.5,-1157 984.5,-1157 984.5,-1133 1085.5,-1133 1085.5,-1157"/>
<text text-anchor="middle" x="1035" y="-1142.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_debug_print</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge1" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M90.31,-1361.08C97.69,-1407.03 129.15,-1573.66 211,-1680 320.91,-1822.79 444.57,-1913.7 594,-1813 658.32,-1769.65 794.34,-1213.04 856,-1166 889.24,-1140.64 936.63,-1136.12 974.15,-1137.54"/>
<polygon fill="#000000" stroke="#000000" points="974.28,-1141.05 984.45,-1138.09 974.65,-1134.06 974.28,-1141.05"/>
</g>
<!-- interface~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node3" class="node">
<title>interface~dyn_exchange_constituent_states</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node3"><a xlink:href="../interface/dyn_exchange_constituent_states.html" xlink:title="dyn_exchange_constituent_states">
<polygon fill="#a7506f" stroke="#a7506f" points="592,-907 402,-907 402,-883 592,-883 592,-907"/>
<text text-anchor="middle" x="497" y="-892.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_exchange_constituent_states</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge2" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_exchange_constituent_states</title>
<path fill="none" stroke="#000000" d="M95.86,-1336.77C127.27,-1285.28 255.14,-1082.87 400,-954 418.72,-937.35 442.73,-922.6 462.05,-912.01"/>
<polygon fill="#000000" stroke="#000000" points="463.96,-914.96 471.12,-907.15 460.65,-908.79 463.96,-914.96"/>
</g>
<!-- none~final_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node4" class="node">
<title>none~final_shared_variables~2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node4"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-final_shared_variables~2" xlink:title="final_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="353,-1403 222,-1403 222,-1379 353,-1379 353,-1403"/>
<text text-anchor="middle" x="287.5" y="-1388.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">final_shared_variables</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~final_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge3" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~final_shared_variables~2</title>
<path fill="none" stroke="#000000" d="M145.24,-1361.04C168.54,-1365.98 195.69,-1371.74 219.92,-1376.88"/>
<polygon fill="#000000" stroke="#000000" points="219.24,-1380.31 229.75,-1378.96 220.7,-1373.46 219.24,-1380.31"/>
</g>
<!-- none~init_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node5" class="node">
<title>none~init_shared_variables~2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node5"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-init_shared_variables~2" xlink:title="init_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="787,-1185 663,-1185 663,-1161 787,-1161 787,-1185"/>
<text text-anchor="middle" x="725" y="-1170.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_shared_variables</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~init_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge4" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~init_shared_variables~2</title>
<path fill="none" stroke="#000000" d="M94.14,-1361.26C134.46,-1447.3 383.34,-1952.44 594,-1782 688.18,-1705.8 717.09,-1296.28 722.84,-1195.45"/>
<polygon fill="#000000" stroke="#000000" points="726.34,-1195.38 723.4,-1185.2 719.35,-1194.99 726.34,-1195.38"/>
</g>
<!-- none~set_physics_state_column -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node6" class="node">
<title>none~set_physics_state_column</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node6"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_column" xlink:title="set_physics_state_column">
<polygon fill="#d9534f" stroke="#d9534f" points="362,-1361 213,-1361 213,-1337 362,-1337 362,-1361"/>
<text text-anchor="middle" x="287.5" y="-1346.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_physics_state_column</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_column -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge5" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_column</title>
<path fill="none" stroke="#000000" d="M175.06,-1349C184.21,-1349 193.5,-1349 202.62,-1349"/>
<polygon fill="#000000" stroke="#000000" points="202.82,-1352.5 212.82,-1349 202.82,-1345.5 202.82,-1352.5"/>
</g>
<!-- none~set_physics_state_external -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node7" class="node">
<title>none~set_physics_state_external</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node7"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_external" xlink:title="set_physics_state_external">
<polygon fill="#d9534f" stroke="#d9534f" points="364,-659 211,-659 211,-635 364,-635 364,-659"/>
<text text-anchor="middle" x="287.5" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_physics_state_external</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_external -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge6" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_external</title>
<path fill="none" stroke="#000000" d="M91.94,-1336.82C115.2,-1254.35 249.57,-777.93 280.26,-669.12"/>
<polygon fill="#000000" stroke="#000000" points="283.7,-669.82 283.05,-659.24 276.96,-667.92 283.7,-669.82"/>
</g>
<!-- none~update_shared_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node8" class="node">
<title>none~update_shared_variables</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node8"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-update_shared_variables" xlink:title="update_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-129 215,-129 215,-105 360,-105 360,-129"/>
<text text-anchor="middle" x="287.5" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_shared_variables</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~update_shared_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge7" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~update_shared_variables</title>
<path fill="none" stroke="#000000" d="M90.46,-1336.81C109.27,-1219.78 257.66,-296.44 282.87,-139.6"/>
<polygon fill="#000000" stroke="#000000" points="286.39,-139.72 284.52,-129.29 279.48,-138.61 286.39,-139.72"/>
</g>
<!-- proc~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node36" class="node">
<title>proc~dyn_debug_print</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node36"><a xlink:href="../proc/dyn_debug_print.html" xlink:title="dyn_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="1478.5,-834 1377.5,-834 1377.5,-810 1478.5,-810 1478.5,-834"/>
<text text-anchor="middle" x="1428" y="-819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_debug_print</text>
</a>
</g>
</g>
<!-- interface~dyn_debug_print&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge8" class="edge">
<title>interface~dyn_debug_print&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1085.67,-1153.79C1125.59,-1157.79 1180.37,-1155.92 1214,-1124 1282.69,-1058.82 1194.16,-990.48 1250,-914 1278.77,-874.59 1329.48,-850.7 1369.27,-837.17"/>
<polygon fill="#000000" stroke="#000000" points="1370.45,-840.47 1378.87,-834.04 1368.28,-833.82 1370.45,-840.47"/>
</g>
<!-- proc~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node37" class="node">
<title>proc~dyn_exchange_constituent_states</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node37"><a xlink:href="../proc/dyn_exchange_constituent_states.html" xlink:title="dyn_exchange_constituent_states">
<polygon fill="#d9534f" stroke="#d9534f" points="820,-920 630,-920 630,-896 820,-896 820,-920"/>
<text text-anchor="middle" x="725" y="-905.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_exchange_constituent_states</text>
</a>
</g>
</g>
<!-- interface~dyn_exchange_constituent_states&#45;&gt;proc~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge9" class="edge">
<title>interface~dyn_exchange_constituent_states&#45;&gt;proc~dyn_exchange_constituent_states</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M592.21,-900.42C601.37,-900.95 610.7,-901.48 619.95,-902.01"/>
<polygon fill="#000000" stroke="#000000" points="619.76,-905.51 629.94,-902.59 620.16,-898.52 619.76,-905.51"/>
</g>
<!-- none~init_shared_variables~2&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge12" class="edge">
<title>none~init_shared_variables~2&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M787.22,-1167.43C841.44,-1162.51 920.13,-1155.35 973.99,-1150.46"/>
<polygon fill="#000000" stroke="#000000" points="974.44,-1153.93 984.08,-1149.54 973.8,-1146.96 974.44,-1153.93"/>
</g>
<!-- check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node14" class="node">
<title>check_allocate</title>
<polygon fill="#777777" stroke="#777777" points="1081,-905 989,-905 989,-881 1081,-881 1081,-905"/>
<text text-anchor="middle" x="1035" y="-890.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_allocate</text>
</g>
<!-- none~init_shared_variables~2&#45;&gt;check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge10" class="edge">
<title>none~init_shared_variables~2&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M727.96,-1160.87C735.5,-1118.54 766.82,-976.53 856,-914 891.4,-889.18 940.8,-885.11 978.59,-886.59"/>
<polygon fill="#000000" stroke="#000000" points="978.74,-890.1 988.91,-887.14 979.11,-883.11 978.74,-890.1"/>
</g>
<!-- const_is_water_species -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node15" class="node">
<title>const_is_water_species</title>
<polygon fill="#777777" stroke="#777777" points="1102.5,-1073 967.5,-1073 967.5,-1049 1102.5,-1049 1102.5,-1073"/>
<text text-anchor="middle" x="1035" y="-1058.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">const_is_water_species</text>
</g>
<!-- none~init_shared_variables~2&#45;&gt;const_is_water_species -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge11" class="edge">
<title>none~init_shared_variables~2&#45;&gt;const_is_water_species</title>
<path fill="none" stroke="#000000" d="M787.04,-1163.71C798.8,-1159.9 810.42,-1154.55 820,-1147 845.94,-1126.56 828.58,-1100.41 856,-1082 885.27,-1062.35 923.49,-1055.98 957,-1054.98"/>
<polygon fill="#000000" stroke="#000000" points="957.29,-1058.48 967.24,-1054.84 957.19,-1051.48 957.29,-1058.48"/>
</g>
<!-- none~get_variable_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node26" class="node">
<title>none~get_variable_pointer</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node26"><a xlink:href="../type/mpas_dynamical_core_type.html#boundprocedure-get_variable_pointer" xlink:title="mpas_dynamical_core_type%get_variable_pointer">
<polygon fill="#a7506f" stroke="#a7506f" points="1174.5,-1199 895.5,-1199 895.5,-1175 1174.5,-1175 1174.5,-1199"/>
<text text-anchor="middle" x="1035" y="-1184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%get_variable_pointer</text>
</a>
</g>
</g>
<!-- none~init_shared_variables~2&#45;&gt;none~get_variable_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge13" class="edge">
<title>none~init_shared_variables~2&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M787.22,-1175.78C815.48,-1177.07 850.39,-1178.65 884.96,-1180.23"/>
<polygon fill="#000000" stroke="#000000" points="885.04,-1183.73 895.19,-1180.69 885.36,-1176.74 885.04,-1183.73"/>
</g>
<!-- proc~dyn_mpas_map_mpas_scalar_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node39" class="node">
<title>proc~dyn_mpas_map_mpas_scalar_index</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node39"><a xlink:href="../proc/dyn_mpas_map_mpas_scalar_index.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_map_mpas_scalar_index">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1214,-1115 856,-1115 856,-1091 1214,-1091 1214,-1115"/>
<text text-anchor="middle" x="1035" y="-1100.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_map_mpas_scalar_index</text>
</a>
</g>
</g>
<!-- none~init_shared_variables~2&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge14" class="edge">
<title>none~init_shared_variables~2&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index</title>
<path fill="none" stroke="#000000" d="M780.16,-1160.99C793.46,-1157.23 807.47,-1152.58 820,-1147 837.34,-1139.27 838.12,-1130.39 856,-1124 862.75,-1121.59 869.72,-1119.44 876.83,-1117.53"/>
<polygon fill="#000000" stroke="#000000" points="877.75,-1120.91 886.59,-1115.07 876.04,-1114.12 877.75,-1120.91"/>
</g>
<!-- lnpint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node22" class="node">
<title>lnpint</title>
<polygon fill="#777777" stroke="#777777" points="524,-1193 470,-1193 470,-1169 524,-1169 524,-1193"/>
<text text-anchor="middle" x="497" y="-1178.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpint</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge15" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpint</title>
<path fill="none" stroke="#000000" d="M294.01,-1336.79C307.58,-1308.22 345.48,-1236.84 400,-1202 417.71,-1190.68 440.6,-1185.4 459.59,-1182.95"/>
<polygon fill="#000000" stroke="#000000" points="460.11,-1186.42 469.68,-1181.87 459.37,-1179.46 460.11,-1186.42"/>
</g>
<!-- lnpintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node23" class="node">
<title>lnpintdry</title>
<polygon fill="#777777" stroke="#777777" points="527,-1151 467,-1151 467,-1127 527,-1127 527,-1151"/>
<text text-anchor="middle" x="497" y="-1136.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpintdry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge16" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpintdry</title>
<path fill="none" stroke="#000000" d="M291.87,-1336.95C302,-1303.12 335.5,-1206.69 400,-1160 416.32,-1148.18 438.02,-1142.8 456.66,-1140.43"/>
<polygon fill="#000000" stroke="#000000" points="457.06,-1143.91 466.65,-1139.4 456.34,-1136.94 457.06,-1143.91"/>
</g>
<!-- lnpmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node24" class="node">
<title>lnpmid</title>
<polygon fill="#777777" stroke="#777777" points="524,-1109 470,-1109 470,-1085 524,-1085 524,-1109"/>
<text text-anchor="middle" x="497" y="-1094.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpmid</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge17" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpmid</title>
<path fill="none" stroke="#000000" d="M290.53,-1336.88C297.67,-1298.23 325.37,-1176.91 400,-1118 416.8,-1104.74 440.19,-1099.43 459.67,-1097.47"/>
<polygon fill="#000000" stroke="#000000" points="460.03,-1100.95 469.74,-1096.71 459.51,-1093.97 460.03,-1100.95"/>
</g>
<!-- lnpmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node25" class="node">
<title>lnpmiddry</title>
<polygon fill="#777777" stroke="#777777" points="530.5,-1773 463.5,-1773 463.5,-1749 530.5,-1749 530.5,-1773"/>
<text text-anchor="middle" x="497" y="-1758.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpmiddry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge18" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpmiddry</title>
<path fill="none" stroke="#000000" d="M353.99,-1361.21C357.72,-1363.66 361.11,-1366.56 364,-1370 417.11,-1433.28 345.14,-1678.23 400,-1740 413.16,-1754.81 434.13,-1760.51 453.12,-1762.31"/>
<polygon fill="#000000" stroke="#000000" points="452.92,-1765.8 463.12,-1762.93 453.35,-1758.82 452.92,-1765.8"/>
</g>
<!-- omega -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node27" class="node">
<title>omega</title>
<polygon fill="#777777" stroke="#777777" points="524,-1731 470,-1731 470,-1707 524,-1707 524,-1731"/>
<text text-anchor="middle" x="497" y="-1716.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omega</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;omega -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge19" class="edge">
<title>none~set_physics_state_column&#45;&gt;omega</title>
<path fill="none" stroke="#000000" d="M353.6,-1361.04C357.47,-1363.52 361,-1366.48 364,-1370 458.97,-1481.75 301.94,-1588.95 400,-1698 414.83,-1714.5 439.37,-1719.65 459.92,-1720.73"/>
<polygon fill="#000000" stroke="#000000" points="459.85,-1724.23 469.93,-1720.97 460.01,-1717.23 459.85,-1724.23"/>
</g>
<!-- pdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node28" class="node">
<title>pdel</title>
<polygon fill="#777777" stroke="#777777" points="1062,-1031 1008,-1031 1008,-1007 1062,-1007 1062,-1031"/>
<text text-anchor="middle" x="1035" y="-1016.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pdel</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge20" class="edge">
<title>none~set_physics_state_column&#45;&gt;pdel</title>
<path fill="none" stroke="#000000" d="M351.8,-1361.1C356.25,-1363.55 360.39,-1366.49 364,-1370 402.99,-1407.94 356.24,-1454.68 400,-1487 469.36,-1538.22 529.86,-1544.62 594,-1487 649.7,-1436.97 580.2,-1207.91 630,-1152 687.59,-1087.35 751.4,-1161.83 820,-1109 847.41,-1087.9 827.52,-1059.64 856,-1040 897.91,-1011.1 958.96,-1010.56 997.56,-1013.94"/>
<polygon fill="#000000" stroke="#000000" points="997.52,-1017.45 1007.82,-1014.98 998.22,-1010.49 997.52,-1017.45"/>
</g>
<!-- pdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node29" class="node">
<title>pdeldry</title>
<polygon fill="#777777" stroke="#777777" points="1062,-989 1008,-989 1008,-965 1062,-965 1062,-989"/>
<text text-anchor="middle" x="1035" y="-974.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pdeldry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge21" class="edge">
<title>none~set_physics_state_column&#45;&gt;pdeldry</title>
<path fill="none" stroke="#000000" d="M350.67,-1361.16C355.48,-1363.59 360.01,-1366.51 364,-1370 394.57,-1396.74 366.09,-1431.64 400,-1454 435.99,-1477.73 561.97,-1482.86 594,-1454 651.26,-1402.4 578.1,-1165.99 630,-1109 687.98,-1045.33 751.71,-1123.46 820,-1071 848.69,-1048.96 826.45,-1018.87 856,-998 897.58,-968.62 958.72,-968.22 997.43,-971.75"/>
<polygon fill="#000000" stroke="#000000" points="997.41,-975.27 1007.72,-972.83 998.14,-968.31 997.41,-975.27"/>
</g>
<!-- phis -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node30" class="node">
<title>phis</title>
<polygon fill="#777777" stroke="#777777" points="524,-1689 470,-1689 470,-1665 524,-1665 524,-1689"/>
<text text-anchor="middle" x="497" y="-1674.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phis</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;phis -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge22" class="edge">
<title>none~set_physics_state_column&#45;&gt;phis</title>
<path fill="none" stroke="#000000" d="M353.54,-1361.09C357.42,-1363.56 360.98,-1366.5 364,-1370 447.74,-1466.96 313.58,-1561.42 400,-1656 414.8,-1672.2 438.95,-1677.42 459.33,-1678.61"/>
<polygon fill="#000000" stroke="#000000" points="459.47,-1682.11 469.57,-1678.9 459.67,-1675.12 459.47,-1682.11"/>
</g>
<!-- pint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node31" class="node">
<title>pint</title>
<polygon fill="#777777" stroke="#777777" points="524,-1647 470,-1647 470,-1623 524,-1623 524,-1647"/>
<text text-anchor="middle" x="497" y="-1632.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pint</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge23" class="edge">
<title>none~set_physics_state_column&#45;&gt;pint</title>
<path fill="none" stroke="#000000" d="M353.45,-1361.16C357.36,-1363.61 360.94,-1366.53 364,-1370 436.53,-1452.19 325.2,-1533.87 400,-1614 414.97,-1630.04 439.12,-1635.26 459.45,-1636.49"/>
<polygon fill="#000000" stroke="#000000" points="459.57,-1640 469.67,-1636.8 459.78,-1633 459.57,-1640"/>
</g>
<!-- pintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node32" class="node">
<title>pintdry</title>
<polygon fill="#777777" stroke="#777777" points="524,-1605 470,-1605 470,-1581 524,-1581 524,-1605"/>
<text text-anchor="middle" x="497" y="-1590.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pintdry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge24" class="edge">
<title>none~set_physics_state_column&#45;&gt;pintdry</title>
<path fill="none" stroke="#000000" d="M352.99,-1361.05C357.06,-1363.52 360.8,-1366.48 364,-1370 425.35,-1437.47 336.79,-1506.27 400,-1572 415.21,-1587.81 439.36,-1593.04 459.63,-1594.32"/>
<polygon fill="#000000" stroke="#000000" points="459.7,-1597.83 469.81,-1594.67 459.94,-1590.83 459.7,-1597.83"/>
</g>
<!-- pmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node33" class="node">
<title>pmid</title>
<polygon fill="#777777" stroke="#777777" points="524,-987 470,-987 470,-963 524,-963 524,-987"/>
<text text-anchor="middle" x="497" y="-972.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pmid</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge25" class="edge">
<title>none~set_physics_state_column&#45;&gt;pmid</title>
<path fill="none" stroke="#000000" d="M292.52,-1336.9C303.96,-1302.45 337.53,-1200.84 364,-1116 380.58,-1062.85 359.16,-1033.85 400,-996 415.98,-981.19 439.92,-975.93 459.89,-974.38"/>
<polygon fill="#000000" stroke="#000000" points="460.1,-977.87 469.91,-973.87 459.74,-970.88 460.1,-977.87"/>
</g>
<!-- pmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node34" class="node">
<title>pmiddry</title>
<polygon fill="#777777" stroke="#777777" points="525.5,-1563 468.5,-1563 468.5,-1539 525.5,-1539 525.5,-1563"/>
<text text-anchor="middle" x="497" y="-1548.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pmiddry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge26" class="edge">
<title>none~set_physics_state_column&#45;&gt;pmiddry</title>
<path fill="none" stroke="#000000" d="M352.43,-1361.03C356.68,-1363.51 360.61,-1366.46 364,-1370 412.92,-1421.07 350.91,-1474.09 400,-1525 415,-1540.56 438.29,-1547.12 458.17,-1549.76"/>
<polygon fill="#000000" stroke="#000000" points="457.88,-1553.25 468.19,-1550.81 458.61,-1546.29 457.88,-1553.25"/>
</g>
<!-- proc~reverse -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node42" class="node">
<title>proc~reverse</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node42"><a xlink:href="../proc/reverse.html" xlink:title="reverse">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1062,-947 1008,-947 1008,-923 1062,-923 1062,-947"/>
<text text-anchor="middle" x="1035" y="-932.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reverse</text>
</a>
</g>
</g>
<!-- none~set_physics_state_column&#45;&gt;proc~reverse -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge27" class="edge">
<title>none~set_physics_state_column&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M289.5,-1336.84C293.74,-1293.66 314.19,-1146.57 400,-1076 467.86,-1020.19 508.84,-1059.6 594,-1038 712.27,-1008.01 736.68,-981.48 856,-956 904.47,-945.65 961.53,-940.05 997.73,-937.3"/>
<polygon fill="#000000" stroke="#000000" points="998.09,-940.78 1007.81,-936.56 997.58,-933.8 998.09,-940.78"/>
</g>
<!-- ps -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node44" class="node">
<title>ps</title>
<polygon fill="#777777" stroke="#777777" points="524,-1029 470,-1029 470,-1005 524,-1005 524,-1029"/>
<text text-anchor="middle" x="497" y="-1014.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ps</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;ps -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge28" class="edge">
<title>none~set_physics_state_column&#45;&gt;ps</title>
<path fill="none" stroke="#000000" d="M292.2,-1336.86C308.8,-1282.64 376.68,-1064.42 400,-1043 416.14,-1028.18 439.86,-1021.66 459.69,-1018.86"/>
<polygon fill="#000000" stroke="#000000" points="460.11,-1022.33 469.64,-1017.71 459.3,-1015.38 460.11,-1022.33"/>
</g>
<!-- psdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node45" class="node">
<title>psdry</title>
<polygon fill="#777777" stroke="#777777" points="524,-1445 470,-1445 470,-1421 524,-1421 524,-1445"/>
<text text-anchor="middle" x="497" y="-1430.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">psdry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;psdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge29" class="edge">
<title>none~set_physics_state_column&#45;&gt;psdry</title>
<path fill="none" stroke="#000000" d="M346.12,-1361.12C352.39,-1363.56 358.49,-1366.49 364,-1370 384.74,-1383.2 378.9,-1399.39 400,-1412 418.04,-1422.78 440.95,-1428.05 459.86,-1430.62"/>
<polygon fill="#000000" stroke="#000000" points="459.56,-1434.1 469.9,-1431.78 460.37,-1427.15 459.56,-1434.1"/>
</g>
<!-- rpdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node47" class="node">
<title>rpdel</title>
<polygon fill="#777777" stroke="#777777" points="524,-1403 470,-1403 470,-1379 524,-1379 524,-1403"/>
<text text-anchor="middle" x="497" y="-1388.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpdel</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;rpdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge30" class="edge">
<title>none~set_physics_state_column&#45;&gt;rpdel</title>
<path fill="none" stroke="#000000" d="M347.96,-1361.04C384.11,-1368.35 429.1,-1377.46 459.93,-1383.7"/>
<polygon fill="#000000" stroke="#000000" points="459.32,-1387.15 469.81,-1385.7 460.71,-1380.28 459.32,-1387.15"/>
</g>
<!-- rpdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node48" class="node">
<title>rpdeldry</title>
<polygon fill="#777777" stroke="#777777" points="526,-1361 468,-1361 468,-1337 526,-1337 526,-1361"/>
<text text-anchor="middle" x="497" y="-1346.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpdeldry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;rpdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge31" class="edge">
<title>none~set_physics_state_column&#45;&gt;rpdeldry</title>
<path fill="none" stroke="#000000" d="M362.24,-1349C394.53,-1349 431.07,-1349 457.78,-1349"/>
<polygon fill="#000000" stroke="#000000" points="457.87,-1352.5 467.87,-1349 457.87,-1345.5 457.87,-1352.5"/>
</g>
<!-- t -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node50" class="node">
<title>t</title>
<polygon fill="#777777" stroke="#777777" points="524,-1319 470,-1319 470,-1295 524,-1295 524,-1319"/>
<text text-anchor="middle" x="497" y="-1304.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">t</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;t -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge32" class="edge">
<title>none~set_physics_state_column&#45;&gt;t</title>
<path fill="none" stroke="#000000" d="M347.96,-1336.96C384.11,-1329.65 429.1,-1320.54 459.93,-1314.3"/>
<polygon fill="#000000" stroke="#000000" points="460.71,-1317.72 469.81,-1312.3 459.32,-1310.85 460.71,-1317.72"/>
</g>
<!-- u -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node51" class="node">
<title>u</title>
<polygon fill="#777777" stroke="#777777" points="524,-1277 470,-1277 470,-1253 524,-1253 524,-1277"/>
<text text-anchor="middle" x="497" y="-1262.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">u</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;u -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge33" class="edge">
<title>none~set_physics_state_column&#45;&gt;u</title>
<path fill="none" stroke="#000000" d="M306.22,-1336.76C327.55,-1322.57 364.9,-1299.41 400,-1286 419.14,-1278.69 441.45,-1273.62 459.74,-1270.29"/>
<polygon fill="#000000" stroke="#000000" points="460.46,-1273.72 469.72,-1268.57 459.27,-1266.82 460.46,-1273.72"/>
</g>
<!-- v -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node54" class="node">
<title>v</title>
<polygon fill="#777777" stroke="#777777" points="524,-1235 470,-1235 470,-1211 524,-1211 524,-1235"/>
<text text-anchor="middle" x="497" y="-1220.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">v</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;v -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge34" class="edge">
<title>none~set_physics_state_column&#45;&gt;v</title>
<path fill="none" stroke="#000000" d="M297.73,-1336.71C315.12,-1314.48 355.08,-1267.69 400,-1244 418.46,-1234.26 441.2,-1229.04 459.92,-1226.23"/>
<polygon fill="#000000" stroke="#000000" points="460.4,-1229.7 469.85,-1224.91 459.47,-1222.76 460.4,-1229.7"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge45" class="edge">
<title>none~set_physics_state_external&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M289.59,-659.29C294.11,-702.22 315.28,-846.7 400,-916 468.01,-971.63 533.27,-890.51 594,-954 668.55,-1031.95 548.27,-1123.62 630,-1194 693.99,-1249.1 740.13,-1221.41 820,-1194 839.17,-1187.42 837.25,-1173.69 856,-1166 893.34,-1150.68 938.53,-1145.5 974.04,-1144.11"/>
<polygon fill="#000000" stroke="#000000" points="974.36,-1147.6 984.25,-1143.8 974.15,-1140.6 974.36,-1147.6"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;interface~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge46" class="edge">
<title>none~set_physics_state_external&#45;&gt;interface~dyn_exchange_constituent_states</title>
<path fill="none" stroke="#000000" d="M290.65,-659.18C298.08,-697.47 326.39,-816.31 400,-874 401.8,-875.41 403.68,-876.73 405.61,-877.97"/>
<polygon fill="#000000" stroke="#000000" points="404.02,-881.09 414.46,-882.86 407.41,-874.96 404.02,-881.09"/>
</g>
<!-- cam_constituents_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node9" class="node">
<title>cam_constituents_array</title>
<polygon fill="#777777" stroke="#777777" points="1104.5,-557 965.5,-557 965.5,-533 1104.5,-533 1104.5,-557"/>
<text text-anchor="middle" x="1035" y="-542.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_constituents_array</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_constituents_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge35" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_constituents_array</title>
<path fill="none" stroke="#000000" d="M298.27,-634.76C315.93,-613.72 355.49,-571.39 400,-555 592.97,-483.94 841.91,-511.26 962.38,-531.22"/>
<polygon fill="#000000" stroke="#000000" points="962.14,-534.73 972.58,-532.95 963.3,-527.83 962.14,-534.73"/>
</g>
<!-- cam_model_const_properties -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node10" class="node">
<title>cam_model_const_properties</title>
<polygon fill="#777777" stroke="#777777" points="581,-377 413,-377 413,-353 581,-353 581,-377"/>
<text text-anchor="middle" x="497" y="-362.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_model_const_properties</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_model_const_properties -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge36" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_model_const_properties</title>
<path fill="none" stroke="#000000" d="M290.05,-634.93C295.97,-594.01 320.93,-459.27 400,-391 404.25,-387.33 408.96,-384.18 413.96,-381.46"/>
<polygon fill="#000000" stroke="#000000" points="415.71,-384.51 423.22,-377.04 412.69,-378.19 415.71,-384.51"/>
</g>
<!-- cam_thermo_dry_air_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node11" class="node">
<title>cam_thermo_dry_air_update</title>
<polygon fill="#777777" stroke="#777777" points="579.5,-335 414.5,-335 414.5,-311 579.5,-311 579.5,-335"/>
<text text-anchor="middle" x="497" y="-320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_thermo_dry_air_update</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_thermo_dry_air_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge37" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_thermo_dry_air_update</title>
<path fill="none" stroke="#000000" d="M289.01,-634.9C291.65,-589.05 307.45,-424.64 400,-344 401.78,-342.45 403.64,-341.01 405.58,-339.67"/>
<polygon fill="#000000" stroke="#000000" points="407.67,-342.49 414.5,-334.39 404.11,-336.47 407.67,-342.49"/>
</g>
<!-- cam_thermo_water_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node12" class="node">
<title>cam_thermo_water_update</title>
<polygon fill="#777777" stroke="#777777" points="576,-293 418,-293 418,-269 576,-269 576,-293"/>
<text text-anchor="middle" x="497" y="-278.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_thermo_water_update</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_thermo_water_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge38" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_thermo_water_update</title>
<path fill="none" stroke="#000000" d="M288.4,-635C288.69,-585.53 296.74,-395.68 400,-302 402.67,-299.58 405.56,-297.41 408.6,-295.47"/>
<polygon fill="#000000" stroke="#000000" points="410.44,-298.46 417.56,-290.61 407.1,-292.31 410.44,-298.46"/>
</g>
<!-- cappav -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node13" class="node">
<title>cappav</title>
<polygon fill="#777777" stroke="#777777" points="524,-865 470,-865 470,-841 524,-841 524,-865"/>
<text text-anchor="middle" x="497" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cappav</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cappav -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge39" class="edge">
<title>none~set_physics_state_external&#45;&gt;cappav</title>
<path fill="none" stroke="#000000" d="M292.1,-659.28C302.62,-692.83 336.6,-786.56 400,-832 417.2,-844.33 440.27,-849.64 459.48,-851.84"/>
<polygon fill="#000000" stroke="#000000" points="459.42,-855.35 469.7,-852.77 460.05,-848.38 459.42,-855.35"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge40" class="edge">
<title>none~set_physics_state_external&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M305.79,-659.12C327.01,-673.42 364.54,-696.9 400,-710 482.42,-740.45 509,-725.76 594,-748 743.05,-786.99 915.4,-848.82 992.73,-877.47"/>
<polygon fill="#000000" stroke="#000000" points="991.53,-880.76 1002.12,-880.96 993.96,-874.2 991.53,-880.76"/>
</g>
<!-- const_qmin -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node16" class="node">
<title>const_qmin</title>
<polygon fill="#777777" stroke="#777777" points="533.5,-823 460.5,-823 460.5,-799 533.5,-799 533.5,-823"/>
<text text-anchor="middle" x="497" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">const_qmin</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;const_qmin -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge41" class="edge">
<title>none~set_physics_state_external&#45;&gt;const_qmin</title>
<path fill="none" stroke="#000000" d="M294.31,-659.3C308.26,-687.36 346.45,-756.28 400,-790 414.94,-799.41 433.5,-804.64 450.3,-807.54"/>
<polygon fill="#000000" stroke="#000000" points="450.08,-811.05 460.49,-809.06 451.11,-804.12 450.08,-811.05"/>
</g>
<!-- endrun -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node17" class="node">
<title>endrun</title>
<polygon fill="#777777" stroke="#777777" points="1062,-457 1008,-457 1008,-433 1062,-433 1062,-457"/>
<text text-anchor="middle" x="1035" y="-442.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endrun</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;endrun -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge42" class="edge">
<title>none~set_physics_state_external&#45;&gt;endrun</title>
<path fill="none" stroke="#000000" d="M290.16,-634.89C296.23,-595.81 321.2,-472.7 400,-424 500.6,-361.83 878.63,-418.75 997.79,-438.7"/>
<polygon fill="#000000" stroke="#000000" points="997.41,-442.19 1007.85,-440.4 998.58,-435.29 997.41,-442.19"/>
</g>
<!-- exner -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node18" class="node">
<title>exner</title>
<polygon fill="#777777" stroke="#777777" points="524,-781 470,-781 470,-757 524,-757 524,-781"/>
<text text-anchor="middle" x="497" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;exner -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge43" class="edge">
<title>none~set_physics_state_external&#45;&gt;exner</title>
<path fill="none" stroke="#000000" d="M299.24,-659.28C317.76,-679.71 357.8,-720.62 400,-743 418.66,-752.9 441.41,-759.27 460.08,-763.23"/>
<polygon fill="#000000" stroke="#000000" points="459.49,-766.68 469.98,-765.19 460.85,-759.82 459.49,-766.68"/>
</g>
<!-- geopotential_temp_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node19" class="node">
<title>geopotential_temp_run</title>
<polygon fill="#777777" stroke="#777777" points="565,-701 429,-701 429,-677 565,-677 565,-701"/>
<text text-anchor="middle" x="497" y="-686.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geopotential_temp_run</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;geopotential_temp_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge44" class="edge">
<title>none~set_physics_state_external&#45;&gt;geopotential_temp_run</title>
<path fill="none" stroke="#000000" d="M347.96,-659.04C372.49,-664 401.08,-669.79 426.56,-674.95"/>
<polygon fill="#000000" stroke="#000000" points="426.03,-678.41 436.53,-676.96 427.42,-671.55 426.03,-678.41"/>
</g>
<!-- interface~exner_function -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node21" class="node">
<title>interface~exner_function</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node21"><a xlink:href="../interface/exner_function.html" xlink:title="exner_function">
<polygon fill="#a7506f" stroke="#a7506f" points="542.5,-659 451.5,-659 451.5,-635 542.5,-635 542.5,-659"/>
<text text-anchor="middle" x="497" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner_function</text>
</a>
</g>
</g>
<!-- none~set_physics_state_external&#45;&gt;interface~exner_function -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge47" class="edge">
<title>none~set_physics_state_external&#45;&gt;interface~exner_function</title>
<path fill="none" stroke="#000000" d="M364.29,-647C389.81,-647 417.76,-647 441.32,-647"/>
<polygon fill="#000000" stroke="#000000" points="441.47,-650.5 451.47,-647 441.47,-643.5 441.47,-650.5"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;pmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge48" class="edge">
<title>none~set_physics_state_external&#45;&gt;pmid</title>
<path fill="none" stroke="#000000" d="M289.18,-659.24C292.37,-704.85 309.88,-866.58 400,-949 416.17,-963.79 439.89,-970.3 459.71,-973.11"/>
<polygon fill="#000000" stroke="#000000" points="459.32,-976.59 469.66,-974.27 460.13,-969.64 459.32,-976.59"/>
</g>
<!-- proc~dyn_mpas_map_constituent_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node38" class="node">
<title>proc~dyn_mpas_map_constituent_index</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node38"><a xlink:href="../proc/dyn_mpas_map_constituent_index.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_map_constituent_index">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1210.5,-634 859.5,-634 859.5,-610 1210.5,-610 1210.5,-634"/>
<text text-anchor="middle" x="1035" y="-619.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_map_constituent_index</text>
</a>
</g>
</g>
<!-- none~set_physics_state_external&#45;&gt;proc~dyn_mpas_map_constituent_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge49" class="edge">
<title>none~set_physics_state_external&#45;&gt;proc~dyn_mpas_map_constituent_index</title>
<path fill="none" stroke="#000000" d="M303.97,-634.78C324.52,-619.41 362.59,-593.84 400,-584 608.64,-529.13 868.66,-580.32 979.68,-607.51"/>
<polygon fill="#000000" stroke="#000000" points="979.09,-610.97 989.64,-609.98 980.78,-604.17 979.09,-610.97"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;ps -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge50" class="edge">
<title>none~set_physics_state_external&#45;&gt;ps</title>
<path fill="none" stroke="#000000" d="M288.35,-659.14C288.45,-709.17 295.81,-901.16 400,-996 416.12,-1010.67 440.05,-1015.93 459.99,-1017.52"/>
<polygon fill="#000000" stroke="#000000" points="459.82,-1021.01 469.99,-1018.04 460.18,-1014.02 459.82,-1021.01"/>
</g>
<!-- qneg_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node46" class="node">
<title>qneg_run</title>
<polygon fill="#777777" stroke="#777777" points="528.5,-617 465.5,-617 465.5,-593 528.5,-593 528.5,-617"/>
<text text-anchor="middle" x="497" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qneg_run</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;qneg_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge51" class="edge">
<title>none~set_physics_state_external&#45;&gt;qneg_run</title>
<path fill="none" stroke="#000000" d="M347.96,-634.96C382.39,-628 424.83,-619.4 455.43,-613.21"/>
<polygon fill="#000000" stroke="#000000" points="456.22,-616.62 465.33,-611.21 454.83,-609.76 456.22,-616.62"/>
</g>
<!-- stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node49" class="node">
<title>stringify</title>
<polygon fill="#777777" stroke="#777777" points="1828.5,-606 1773.5,-606 1773.5,-582 1828.5,-582 1828.5,-606"/>
<text text-anchor="middle" x="1801" y="-591.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge52" class="edge">
<title>none~set_physics_state_external&#45;&gt;stringify</title>
<path fill="none" stroke="#000000" d="M290.08,-634.66C298.13,-573.92 336.73,-307.61 400,-260 514.92,-173.52 1555.46,-512.73 1763.79,-581.9"/>
<polygon fill="#000000" stroke="#000000" points="1762.75,-585.24 1773.35,-585.08 1764.96,-578.6 1762.75,-585.24"/>
</g>
<!-- update_dry_static_energy_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node52" class="node">
<title>update_dry_static_energy_run</title>
<polygon fill="#777777" stroke="#777777" points="583,-499 411,-499 411,-475 583,-475 583,-499"/>
<text text-anchor="middle" x="497" y="-484.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_dry_static_energy_run</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;update_dry_static_energy_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge53" class="edge">
<title>none~set_physics_state_external&#45;&gt;update_dry_static_energy_run</title>
<path fill="none" stroke="#000000" d="M295.08,-634.87C310.05,-608.46 349.32,-545.53 400,-513 406.29,-508.96 413.21,-505.54 420.35,-502.65"/>
<polygon fill="#000000" stroke="#000000" points="422.01,-505.77 430.19,-499.03 419.6,-499.2 422.01,-505.77"/>
</g>
<!-- update_thermodynamic_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node53" class="node">
<title>update_thermodynamic_variables</title>
<polygon fill="#777777" stroke="#777777" points="594,-457 400,-457 400,-433 594,-433 594,-457"/>
<text text-anchor="middle" x="497" y="-442.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_thermodynamic_variables</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;update_thermodynamic_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge54" class="edge">
<title>none~set_physics_state_external&#45;&gt;update_thermodynamic_variables</title>
<path fill="none" stroke="#000000" d="M292.19,-634.98C302.91,-602.15 337.39,-510.42 400,-466 402.13,-464.49 404.35,-463.08 406.64,-461.78"/>
<polygon fill="#000000" stroke="#000000" points="408.4,-464.81 415.78,-457.21 405.27,-458.55 408.4,-464.81"/>
</g>
<!-- interface~clamp -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node20" class="node">
<title>interface~clamp</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node20"><a xlink:href="../interface/clamp.html" xlink:title="clamp">
<polygon fill="#a7506f" stroke="#a7506f" points="524,-192 470,-192 470,-168 524,-168 524,-192"/>
<text text-anchor="middle" x="497" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;interface~clamp -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge55" class="edge">
<title>none~update_shared_variables&#45;&gt;interface~clamp</title>
<path fill="none" stroke="#000000" d="M316.99,-129.04C339.29,-138.14 371.24,-150.49 400,-159 419.51,-164.78 441.68,-169.73 459.79,-173.37"/>
<polygon fill="#000000" stroke="#000000" points="459.18,-176.82 469.66,-175.31 460.52,-169.95 459.18,-176.82"/>
</g>
<!-- proc~dp_by_hydrostatic_equation -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node35" class="node">
<title>proc~dp_by_hydrostatic_equation</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node35"><a xlink:href="../proc/dp_by_hydrostatic_equation.html" xlink:title="dp_by_hydrostatic_equation">
<polygon fill="#d94e8f" stroke="#d94e8f" points="577,-150 417,-150 417,-126 577,-126 577,-150"/>
<text text-anchor="middle" x="497" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dp_by_hydrostatic_equation</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~dp_by_hydrostatic_equation -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge56" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~dp_by_hydrostatic_equation</title>
<path fill="none" stroke="#000000" d="M360.2,-124.26C375.19,-125.77 391.17,-127.39 406.71,-128.96"/>
<polygon fill="#000000" stroke="#000000" points="406.54,-132.46 416.84,-129.99 407.25,-125.5 406.54,-132.46"/>
</g>
<!-- proc~omega_of_w_rho -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node40" class="node">
<title>proc~omega_of_w_rho</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node40"><a xlink:href="../proc/omega_of_w_rho.html" xlink:title="omega_of_w_rho">
<polygon fill="#d94e8f" stroke="#d94e8f" points="548.5,-108 445.5,-108 445.5,-84 548.5,-84 548.5,-108"/>
<text text-anchor="middle" x="497" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omega_of_w_rho</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~omega_of_w_rho -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge57" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~omega_of_w_rho</title>
<path fill="none" stroke="#000000" d="M360.2,-109.74C384.59,-107.28 411.6,-104.54 435.06,-102.17"/>
<polygon fill="#000000" stroke="#000000" points="435.63,-105.63 445.23,-101.14 434.92,-98.66 435.63,-105.63"/>
</g>
<!-- proc~p_by_equation_of_state -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node41" class="node">
<title>proc~p_by_equation_of_state</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node41"><a xlink:href="../proc/p_by_equation_of_state.html" xlink:title="p_by_equation_of_state">
<polygon fill="#d94e8f" stroke="#d94e8f" points="565.5,-66 428.5,-66 428.5,-42 565.5,-42 565.5,-66"/>
<text text-anchor="middle" x="497" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_by_equation_of_state</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~p_by_equation_of_state -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge58" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~p_by_equation_of_state</title>
<path fill="none" stroke="#000000" d="M316.99,-104.96C339.29,-95.86 371.24,-83.51 400,-75 408,-72.63 416.44,-70.4 424.86,-68.35"/>
<polygon fill="#000000" stroke="#000000" points="425.8,-71.72 434.72,-66.01 424.18,-64.91 425.8,-71.72"/>
</g>
<!-- proc~t_of_tm_qv -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node43" class="node">
<title>proc~t_of_tm_qv</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node43"><a xlink:href="../proc/t_of_tm_qv.html" xlink:title="t_of_tm_qv">
<polygon fill="#d94e8f" stroke="#d94e8f" points="532,-24 462,-24 462,0 532,0 532,-24"/>
<text text-anchor="middle" x="497" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">t_of_tm_qv</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~t_of_tm_qv -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge59" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~t_of_tm_qv</title>
<path fill="none" stroke="#000000" d="M300.7,-104.92C320.04,-86.48 359.69,-51.51 400,-33 416.18,-25.57 435.12,-20.71 451.88,-17.56"/>
<polygon fill="#000000" stroke="#000000" points="452.73,-20.96 461.99,-15.81 451.54,-14.06 452.73,-20.96"/>
</g>
<!-- proc~clamp_int32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node56" class="node">
<title>proc~clamp_int32</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node56"><a xlink:href="../proc/clamp_int32.html" xlink:title="clamp_int32">
<polygon fill="#d94e8f" stroke="#d94e8f" points="764,-234 686,-234 686,-210 764,-210 764,-234"/>
<text text-anchor="middle" x="725" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_int32</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_int32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge60" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_int32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.37,-184.9C561.39,-191.78 629.42,-204.42 675.66,-213.02"/>
<polygon fill="#000000" stroke="#000000" points="675.29,-216.51 685.76,-214.89 676.57,-209.63 675.29,-216.51"/>
</g>
<!-- proc~clamp_int64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node57" class="node">
<title>proc~clamp_int64</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node57"><a xlink:href="../proc/clamp_int64.html" xlink:title="clamp_int64">
<polygon fill="#d94e8f" stroke="#d94e8f" points="764,-192 686,-192 686,-168 764,-168 764,-192"/>
<text text-anchor="middle" x="725" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_int64</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_int64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge61" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_int64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.37,-180C561.39,-180 629.42,-180 675.66,-180"/>
<polygon fill="#000000" stroke="#000000" points="675.76,-183.5 685.76,-180 675.76,-176.5 675.76,-183.5"/>
</g>
<!-- proc~clamp_real32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node58" class="node">
<title>proc~clamp_real32</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node58"><a xlink:href="../proc/clamp_real32.html" xlink:title="clamp_real32">
<polygon fill="#d94e8f" stroke="#d94e8f" points="767.5,-150 682.5,-150 682.5,-126 767.5,-126 767.5,-150"/>
<text text-anchor="middle" x="725" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_real32</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_real32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge62" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_real32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.37,-175.1C560.52,-168.38 626.25,-156.17 672.38,-147.59"/>
<polygon fill="#000000" stroke="#000000" points="673.3,-150.98 682.49,-145.71 672.02,-144.1 673.3,-150.98"/>
</g>
<!-- proc~clamp_real64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node59" class="node">
<title>proc~clamp_real64</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node59"><a xlink:href="../proc/clamp_real64.html" xlink:title="clamp_real64">
<polygon fill="#d94e8f" stroke="#d94e8f" points="767.5,-108 682.5,-108 682.5,-84 767.5,-84 767.5,-108"/>
<text text-anchor="middle" x="725" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_real64</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_real64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge63" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_real64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.1,-178.78C544.4,-176.81 572.62,-171.78 594,-159 615.1,-146.39 608.93,-129.66 630,-117 642.57,-109.45 657.56,-104.6 671.84,-101.5"/>
<polygon fill="#000000" stroke="#000000" points="672.91,-104.86 682.07,-99.54 671.59,-97.99 672.91,-104.86"/>
</g>
<!-- proc~exner_function_of_cpd_p0_rd_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node74" class="node">
<title>proc~exner_function_of_cpd_p0_rd_p</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node74"><a xlink:href="../proc/exner_function_of_cpd_p0_rd_p.html" xlink:title="exner_function_of_cpd_p0_rd_p">
<polygon fill="#d94e8f" stroke="#d94e8f" points="814.5,-680 635.5,-680 635.5,-656 814.5,-656 814.5,-680"/>
<text text-anchor="middle" x="725" y="-665.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner_function_of_cpd_p0_rd_p</text>
</a>
</g>
</g>
<!-- interface~exner_function&#45;&gt;proc~exner_function_of_cpd_p0_rd_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge64" class="edge">
<title>interface~exner_function&#45;&gt;proc~exner_function_of_cpd_p0_rd_p</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.65,-651.15C566.36,-653.35 596.49,-656.15 625.35,-658.83"/>
<polygon fill="#000000" stroke="#000000" points="625.21,-662.34 635.49,-659.78 625.86,-655.37 625.21,-662.34"/>
</g>
<!-- proc~exner_function_of_kappa_p0_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node75" class="node">
<title>proc~exner_function_of_kappa_p0_p</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node75"><a xlink:href="../proc/exner_function_of_kappa_p0_p.html" xlink:title="exner_function_of_kappa_p0_p">
<polygon fill="#d94e8f" stroke="#d94e8f" points="813,-638 637,-638 637,-614 813,-614 813,-638"/>
<text text-anchor="middle" x="725" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner_function_of_kappa_p0_p</text>
</a>
</g>
</g>
<!-- interface~exner_function&#45;&gt;proc~exner_function_of_kappa_p0_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge65" class="edge">
<title>interface~exner_function&#45;&gt;proc~exner_function_of_kappa_p0_p</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.65,-642.85C566.7,-640.62 597.37,-637.77 626.61,-635.05"/>
<polygon fill="#000000" stroke="#000000" points="627.25,-638.51 636.88,-634.09 626.6,-631.54 627.25,-638.51"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node61" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node61"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0">
<polygon fill="#d9534f" stroke="#d9534f" points="1606,-1031 1250,-1031 1250,-1007 1606,-1007 1606,-1031"/>
<text text-anchor="middle" x="1428" y="-1016.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge66" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1174.6,-1187.25C1188.98,-1182.61 1202.51,-1175.78 1214,-1166 1258.36,-1128.26 1205.65,-1077.76 1250,-1040 1251.21,-1038.97 1252.45,-1037.96 1253.71,-1037"/>
<polygon fill="#000000" stroke="#000000" points="1256.07,-1039.62 1262.32,-1031.06 1252.1,-1033.86 1256.07,-1039.62"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node62" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c1</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node62"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1">
<polygon fill="#d9534f" stroke="#d9534f" points="1606,-1199 1250,-1199 1250,-1175 1606,-1175 1606,-1199"/>
<text text-anchor="middle" x="1428" y="-1184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge67" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1174.68,-1187C1195.82,-1187 1217.92,-1187 1239.89,-1187"/>
<polygon fill="#000000" stroke="#000000" points="1239.97,-1190.5 1249.97,-1187 1239.97,-1183.5 1239.97,-1190.5"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node63" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node63"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="1604.5,-989 1251.5,-989 1251.5,-965 1604.5,-965 1604.5,-989"/>
<text text-anchor="middle" x="1428" y="-974.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge68" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1174.82,-1188.15C1189.25,-1183.37 1202.73,-1176.26 1214,-1166 1270.46,-1114.59 1193.55,-1049.43 1250,-998 1251,-997.09 1252.01,-996.21 1253.04,-995.35"/>
<polygon fill="#000000" stroke="#000000" points="1255.33,-998.01 1261.26,-989.23 1251.15,-992.4 1255.33,-998.01"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node64" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i1</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node64"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="1604.5,-1115 1251.5,-1115 1251.5,-1091 1604.5,-1091 1604.5,-1115"/>
<text text-anchor="middle" x="1428" y="-1100.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge69" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1174.71,-1181.02C1188.43,-1177.4 1201.78,-1172.51 1214,-1166 1235.69,-1154.43 1228.31,-1135.57 1250,-1124 1253.51,-1122.13 1257.11,-1120.39 1260.79,-1118.78"/>
<polygon fill="#000000" stroke="#000000" points="1262.11,-1122.02 1270.08,-1115.03 1259.49,-1115.53 1262.11,-1122.02"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node65" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node65"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="1604.5,-1157 1251.5,-1157 1251.5,-1133 1604.5,-1133 1604.5,-1157"/>
<text text-anchor="middle" x="1428" y="-1142.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge70" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1147.78,-1174.99C1196.98,-1169.71 1254.89,-1163.49 1305.18,-1158.09"/>
<polygon fill="#000000" stroke="#000000" points="1305.57,-1161.56 1315.13,-1157.02 1304.82,-1154.6 1305.57,-1161.56"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node66" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i3</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node66"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="1604.5,-1451 1251.5,-1451 1251.5,-1427 1604.5,-1427 1604.5,-1451"/>
<text text-anchor="middle" x="1428" y="-1436.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge71" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1042.81,-1199.05C1065.88,-1238.58 1145.5,-1364.81 1250,-1418 1253.8,-1419.93 1257.7,-1421.72 1261.69,-1423.37"/>
<polygon fill="#000000" stroke="#000000" points="1260.54,-1426.68 1271.13,-1426.98 1263.04,-1420.14 1260.54,-1426.68"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node67" class="node">
<title>proc~dyn_mpas_get_variable_pointer_l0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node67"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_l0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0">
<polygon fill="#d9534f" stroke="#d9534f" points="1604.5,-947 1251.5,-947 1251.5,-923 1604.5,-923 1604.5,-947"/>
<text text-anchor="middle" x="1428" y="-932.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge72" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1174.8,-1188.75C1189.32,-1183.89 1202.83,-1176.6 1214,-1166 1282.69,-1100.82 1181.33,-1021.21 1250,-956 1250.98,-955.07 1251.97,-954.17 1252.99,-953.29"/>
<polygon fill="#000000" stroke="#000000" points="1255.31,-955.92 1261.08,-947.03 1251.03,-950.38 1255.31,-955.92"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node68" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node68"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0">
<polygon fill="#d9534f" stroke="#d9534f" points="1605.5,-1073 1250.5,-1073 1250.5,-1049 1605.5,-1049 1605.5,-1073"/>
<text text-anchor="middle" x="1428" y="-1058.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge73" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1174.78,-1185.37C1188.87,-1181 1202.28,-1174.75 1214,-1166 1246.54,-1141.69 1217.47,-1106.32 1250,-1082 1251.67,-1080.75 1253.38,-1079.55 1255.12,-1078.4"/>
<polygon fill="#000000" stroke="#000000" points="1257.28,-1081.19 1264.07,-1073.05 1253.69,-1075.18 1257.28,-1081.19"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node69" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r1</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node69"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1">
<polygon fill="#d9534f" stroke="#d9534f" points="1605.5,-1409 1250.5,-1409 1250.5,-1385 1605.5,-1385 1605.5,-1409"/>
<text text-anchor="middle" x="1428" y="-1394.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge74" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1045.43,-1199.49C1072.64,-1234.49 1155.44,-1333.68 1250,-1376 1254.73,-1378.12 1259.61,-1380.05 1264.58,-1381.81"/>
<polygon fill="#000000" stroke="#000000" points="1263.66,-1385.19 1274.25,-1384.98 1265.84,-1378.54 1263.66,-1385.19"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node70" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node70"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2">
<polygon fill="#d9534f" stroke="#d9534f" points="1605.5,-1367 1250.5,-1367 1250.5,-1343 1605.5,-1343 1605.5,-1367"/>
<text text-anchor="middle" x="1428" y="-1352.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge75" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1048.71,-1199.15C1079.98,-1228.22 1164.37,-1301.77 1250,-1334 1256.23,-1336.34 1262.66,-1338.44 1269.21,-1340.32"/>
<polygon fill="#000000" stroke="#000000" points="1268.33,-1343.71 1278.89,-1342.91 1270.14,-1336.94 1268.33,-1343.71"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node71" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r3</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node71"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3">
<polygon fill="#d9534f" stroke="#d9534f" points="1605.5,-1325 1250.5,-1325 1250.5,-1301 1605.5,-1301 1605.5,-1325"/>
<text text-anchor="middle" x="1428" y="-1310.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge76" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1054.87,-1199.01C1091.09,-1221.44 1173.6,-1269.44 1250,-1292 1258.92,-1294.63 1268.19,-1296.94 1277.59,-1298.96"/>
<polygon fill="#000000" stroke="#000000" points="1276.94,-1302.4 1287.44,-1300.96 1278.34,-1295.54 1276.94,-1302.4"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node72" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r4</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node72"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r4.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4">
<polygon fill="#d9534f" stroke="#d9534f" points="1605.5,-1283 1250.5,-1283 1250.5,-1259 1605.5,-1259 1605.5,-1283"/>
<text text-anchor="middle" x="1428" y="-1268.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge77" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1070.39,-1199.08C1112.3,-1213.33 1185.5,-1236.78 1250,-1250 1263.79,-1252.83 1278.27,-1255.31 1292.76,-1257.49"/>
<polygon fill="#000000" stroke="#000000" points="1292.39,-1260.97 1302.79,-1258.95 1293.4,-1254.04 1292.39,-1260.97"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node73" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r5</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node73"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r5.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5">
<polygon fill="#d9534f" stroke="#d9534f" points="1605.5,-1241 1250.5,-1241 1250.5,-1217 1605.5,-1217 1605.5,-1241"/>
<text text-anchor="middle" x="1428" y="-1226.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge78" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1147.78,-1199.01C1196.98,-1204.29 1254.89,-1210.51 1305.18,-1215.91"/>
<polygon fill="#000000" stroke="#000000" points="1304.82,-1219.4 1315.13,-1216.98 1305.57,-1212.44 1304.82,-1219.4"/>
</g>
<!-- proc~dyn_debug_print&#45;&gt;stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge79" class="edge">
<title>proc~dyn_debug_print&#45;&gt;stringify</title>
<path fill="none" stroke="#000000" d="M1478.8,-816.57C1515.72,-810.94 1566.29,-799.76 1606,-778 1684.39,-735.04 1754.62,-652.6 1784.61,-614.38"/>
<polygon fill="#000000" stroke="#000000" points="1787.67,-616.14 1791.03,-606.09 1782.14,-611.85 1787.67,-616.14"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge85" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M729.22,-920.22C739.87,-958.03 777.86,-1073.56 856,-1124 890.77,-1146.44 937.45,-1151.24 974.29,-1150.66"/>
<polygon fill="#000000" stroke="#000000" points="974.51,-1154.15 984.4,-1150.36 974.3,-1147.16 974.51,-1154.15"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;cam_constituents_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge80" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;cam_constituents_array</title>
<path fill="none" stroke="#000000" d="M731.37,-895.68C745.87,-862.43 786.89,-767.99 820,-689 836.33,-650.03 824.9,-629.61 856,-601 883.13,-576.05 921.3,-562.21 955.34,-554.54"/>
<polygon fill="#000000" stroke="#000000" points="956.22,-557.94 965.29,-552.45 954.78,-551.09 956.22,-557.94"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge81" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M820.08,-903.42C872,-900.89 934.68,-897.84 978.73,-895.69"/>
<polygon fill="#000000" stroke="#000000" points="979.13,-899.18 988.95,-895.19 978.79,-892.18 979.13,-899.18"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;const_is_water_species -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge83" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;const_is_water_species</title>
<path fill="none" stroke="#000000" d="M733.65,-920.13C751.38,-947.06 798.22,-1011.72 856,-1040 886.89,-1055.12 924.29,-1061.1 956.82,-1063.01"/>
<polygon fill="#000000" stroke="#000000" points="957.05,-1066.53 967.2,-1063.5 957.37,-1059.53 957.05,-1066.53"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;endrun -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge84" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;endrun</title>
<path fill="none" stroke="#000000" d="M732.14,-895.97C748.53,-863.41 793.86,-770.56 820,-689 842.91,-617.52 808.57,-582.18 856,-524 891.77,-480.13 956.89,-459.85 997.66,-451.07"/>
<polygon fill="#000000" stroke="#000000" points="998.62,-454.45 1007.73,-449.03 997.23,-447.59 998.62,-454.45"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;none~get_variable_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge86" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M727.98,-920.08C735.57,-962.26 767.04,-1103.73 856,-1166 865.08,-1172.35 875.07,-1177.35 885.55,-1181.23"/>
<polygon fill="#000000" stroke="#000000" points="884.71,-1184.64 895.3,-1184.5 886.93,-1178 884.71,-1184.64"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;pdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge87" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;pdel</title>
<path fill="none" stroke="#000000" d="M738.78,-920.13C760.75,-940.19 807.99,-979.85 856,-998 902.62,-1015.63 960.59,-1019.42 997.46,-1019.79"/>
<polygon fill="#000000" stroke="#000000" points="997.72,-1023.29 1007.72,-1019.8 997.73,-1016.29 997.72,-1023.29"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;pdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge88" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;pdeldry</title>
<path fill="none" stroke="#000000" d="M752.81,-920.03C778.7,-931.13 819.27,-947.18 856,-956 904.19,-967.57 961.32,-972.87 997.61,-975.23"/>
<polygon fill="#000000" stroke="#000000" points="997.53,-978.73 1007.72,-975.84 997.95,-971.74 997.53,-978.73"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_constituent_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge90" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_constituent_index</title>
<path fill="none" stroke="#000000" d="M730.49,-895.85C747.86,-849.44 811.92,-684.4 856,-652 863.51,-646.48 871.68,-641.84 880.25,-637.94"/>
<polygon fill="#000000" stroke="#000000" points="881.81,-641.08 889.69,-634 879.12,-634.62 881.81,-641.08"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge91" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index</title>
<path fill="none" stroke="#000000" d="M731.03,-920.4C745.12,-953.3 788.39,-1042.99 856,-1082 858.9,-1083.67 861.87,-1085.24 864.89,-1086.71"/>
<polygon fill="#000000" stroke="#000000" points="863.58,-1089.96 874.14,-1090.84 866.44,-1083.57 863.58,-1089.96"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~reverse -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge92" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M820.08,-916.25C880.06,-921.51 954.41,-928.02 997.79,-931.83"/>
<polygon fill="#000000" stroke="#000000" points="997.6,-935.32 1007.87,-932.71 998.21,-928.35 997.6,-935.32"/>
</g>
<!-- const_is_dry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node55" class="node">
<title>const_is_dry</title>
<polygon fill="#777777" stroke="#777777" points="1073.5,-685 996.5,-685 996.5,-661 1073.5,-661 1073.5,-685"/>
<text text-anchor="middle" x="1035" y="-670.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">const_is_dry</text>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;const_is_dry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge82" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;const_is_dry</title>
<path fill="none" stroke="#000000" d="M729.25,-895.89C740.02,-858.42 778.29,-743.94 856,-694 894.64,-669.17 947.91,-665.99 986.08,-667.75"/>
<polygon fill="#000000" stroke="#000000" points="986.23,-671.27 996.42,-668.37 986.65,-664.28 986.23,-671.27"/>
</g>
<!-- proc~dyn_mpas_exchange_halo -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node60" class="node">
<title>proc~dyn_mpas_exchange_halo</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node60"><a xlink:href="../proc/dyn_mpas_exchange_halo.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_exchange_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="1189.5,-727 880.5,-727 880.5,-703 1189.5,-703 1189.5,-727"/>
<text text-anchor="middle" x="1035" y="-712.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_exchange_halo</text>
</a>
</g>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge89" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M745.27,-895.93C797.88,-862.96 944.17,-771.29 1005.92,-732.59"/>
<polygon fill="#000000" stroke="#000000" points="1008.13,-735.34 1014.74,-727.07 1004.41,-729.41 1008.13,-735.34"/>
</g>
<!-- mpas_dmpar_exch_halo_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node76" class="node">
<title>mpas_dmpar_exch_halo_field</title>
<polygon fill="#777777" stroke="#777777" points="1512.5,-769 1343.5,-769 1343.5,-745 1512.5,-745 1512.5,-769"/>
<text text-anchor="middle" x="1428" y="-754.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dmpar_exch_halo_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge93" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field</title>
<path fill="none" stroke="#000000" d="M1147.78,-727.01C1206.42,-733.31 1277.45,-740.94 1333.2,-746.92"/>
<polygon fill="#000000" stroke="#000000" points="1333.11,-750.43 1343.42,-748.02 1333.85,-743.47 1333.11,-750.43"/>
</g>
<!-- mpas_pool_get_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node80" class="node">
<title>mpas_pool_get_field</title>
<polygon fill="#777777" stroke="#777777" points="1488.5,-727 1367.5,-727 1367.5,-703 1488.5,-703 1488.5,-727"/>
<text text-anchor="middle" x="1428" y="-712.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge94" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field</title>
<path fill="none" stroke="#000000" d="M1189.69,-715C1247.54,-715 1310.51,-715 1357.04,-715"/>
<polygon fill="#000000" stroke="#000000" points="1357.31,-718.5 1367.31,-715 1357.31,-711.5 1357.31,-718.5"/>
</g>
<!-- mpas_pool_get_field_info -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node81" class="node">
<title>mpas_pool_get_field_info</title>
<polygon fill="#777777" stroke="#777777" points="1501.5,-685 1354.5,-685 1354.5,-661 1501.5,-661 1501.5,-685"/>
<text text-anchor="middle" x="1428" y="-670.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field_info</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge95" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info</title>
<path fill="none" stroke="#000000" d="M1147.78,-702.99C1210.38,-696.27 1287.09,-688.03 1344.26,-681.89"/>
<polygon fill="#000000" stroke="#000000" points="1344.77,-685.35 1354.34,-680.81 1344.02,-678.39 1344.77,-685.35"/>
</g>
<!-- proc~dyn_mpas_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node82" class="node">
<title>proc~dyn_mpas_debug_print</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node82"><a xlink:href="../proc/dyn_mpas_debug_print.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="1574,-234 1282,-234 1282,-210 1574,-210 1574,-234"/>
<text text-anchor="middle" x="1428" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_debug_print</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge96" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print</title>
<path fill="none" stroke="#000000" d="M1189.8,-710.04C1198.55,-705.84 1206.73,-700.57 1214,-694 1268.73,-644.55 1223.42,-600.8 1250,-532 1295.01,-415.51 1378.83,-290.33 1412.48,-242.32"/>
<polygon fill="#000000" stroke="#000000" points="1415.43,-244.21 1418.33,-234.02 1409.71,-240.18 1415.43,-244.21"/>
</g>
<!-- proc~stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node84" class="node">
<title>proc~stringify</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node84"><a xlink:href="../proc/stringify.html" xlink:title="stringify">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1828.5,-384 1773.5,-384 1773.5,-360 1828.5,-360 1828.5,-384"/>
<text text-anchor="middle" x="1801" y="-369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge97" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1189.78,-704.45C1198.18,-701.55 1206.31,-698.1 1214,-694 1235.69,-682.43 1230.68,-667.2 1250,-652 1422.67,-516.18 1671.55,-418.31 1763.81,-384.73"/>
<polygon fill="#000000" stroke="#000000" points="1765.04,-388 1773.26,-381.31 1762.66,-381.42 1765.04,-388"/>
</g>
<!-- mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node77" class="node">
<title>mpas_pool_get_array</title>
<polygon fill="#777777" stroke="#777777" points="1864.5,-1241 1737.5,-1241 1737.5,-1217 1864.5,-1217 1864.5,-1241"/>
<text text-anchor="middle" x="1801" y="-1226.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_array</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge98" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1594.74,-1031.23C1598.69,-1033.85 1602.45,-1036.77 1606,-1040 1662.45,-1091.43 1585.92,-1156.18 1642,-1208 1664.64,-1228.92 1697.5,-1235.61 1727.39,-1236.49"/>
<polygon fill="#000000" stroke="#000000" points="1727.37,-1239.99 1737.4,-1236.58 1727.43,-1232.99 1727.37,-1239.99"/>
</g>
<!-- mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node78" class="node">
<title>mpas_pool_get_config</title>
<polygon fill="#777777" stroke="#777777" points="1866.5,-1010 1735.5,-1010 1735.5,-986 1866.5,-986 1866.5,-1010"/>
<text text-anchor="middle" x="1801" y="-995.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_config</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge99" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1606.08,-1008.98C1648.17,-1006.59 1690.84,-1004.18 1725.39,-1002.22"/>
<polygon fill="#000000" stroke="#000000" points="1725.59,-1005.72 1735.38,-1001.66 1725.2,-998.73 1725.59,-1005.72"/>
</g>
<!-- proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node83" class="node">
<title>proc~dyn_mpas_get_pool_pointer</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node83"><a xlink:href="../proc/dyn_mpas_get_pool_pointer.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_pool_pointer">
<polygon fill="#d9534f" stroke="#d9534f" points="1960,-1199 1642,-1199 1642,-1175 1960,-1175 1960,-1199"/>
<text text-anchor="middle" x="1801" y="-1184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_pool_pointer</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge100" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1590.19,-1031.12C1595.68,-1033.72 1600.97,-1036.67 1606,-1040 1632.89,-1057.8 1618.85,-1080.55 1642,-1103 1674.37,-1134.4 1720.84,-1157.2 1755,-1171.06"/>
<polygon fill="#000000" stroke="#000000" points="1754.15,-1174.48 1764.74,-1174.9 1756.72,-1167.97 1754.15,-1174.48"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge101" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1535.31,-1199.04C1596.89,-1206.01 1672.81,-1214.6 1727.52,-1220.8"/>
<polygon fill="#000000" stroke="#000000" points="1727.15,-1224.28 1737.49,-1221.92 1727.94,-1217.32 1727.15,-1224.28"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge102" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1606.08,-1187C1614.66,-1187 1623.26,-1187 1631.81,-1187"/>
<polygon fill="#000000" stroke="#000000" points="1631.82,-1190.5 1641.82,-1187 1631.82,-1183.5 1631.82,-1190.5"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge103" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1594.92,-989.03C1598.82,-991.72 1602.52,-994.7 1606,-998 1674.67,-1063.21 1573.79,-1142.31 1642,-1208 1664.29,-1229.47 1697.27,-1236.19 1727.34,-1236.95"/>
<polygon fill="#000000" stroke="#000000" points="1727.39,-1240.45 1737.4,-1236.99 1727.42,-1233.45 1727.39,-1240.45"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge104" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1604.72,-986.95C1647.17,-989.35 1690.3,-991.79 1725.19,-993.77"/>
<polygon fill="#000000" stroke="#000000" points="1725.09,-997.27 1735.27,-994.34 1725.49,-990.28 1725.09,-997.27"/>
</g>
<!-- mpas_pool_get_dimension -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node79" class="node">
<title>mpas_pool_get_dimension</title>
<polygon fill="#777777" stroke="#777777" points="1878,-1094 1724,-1094 1724,-1070 1878,-1070 1878,-1094"/>
<text text-anchor="middle" x="1801" y="-1079.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_dimension</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge105" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1573.08,-989.03C1584.34,-991.51 1595.44,-994.46 1606,-998 1623.56,-1003.88 1625.35,-1010.88 1642,-1019 1679.52,-1037.3 1723.79,-1054.6 1755.91,-1066.43"/>
<polygon fill="#000000" stroke="#000000" points="1754.87,-1069.77 1765.46,-1069.91 1757.27,-1063.2 1754.87,-1069.77"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge106" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1593.06,-989.09C1597.58,-991.74 1601.91,-994.7 1606,-998 1644.38,-1028.99 1609.98,-1065.47 1642,-1103 1670.38,-1136.27 1715.32,-1158.35 1750.03,-1171.49"/>
<polygon fill="#000000" stroke="#000000" points="1748.93,-1174.81 1759.53,-1174.96 1751.33,-1168.24 1748.93,-1174.81"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge107" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1591.93,-1115.05C1596.83,-1117.69 1601.54,-1120.66 1606,-1124 1638.53,-1148.32 1609.64,-1183.45 1642,-1208 1665.96,-1226.18 1698.05,-1232.71 1727.06,-1234.2"/>
<polygon fill="#000000" stroke="#000000" points="1727.06,-1237.7 1737.17,-1234.53 1727.29,-1230.71 1727.06,-1237.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge108" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1604.72,-1093.05C1642.58,-1090.91 1680.98,-1088.74 1713.59,-1086.89"/>
<polygon fill="#000000" stroke="#000000" points="1714.19,-1090.36 1723.97,-1086.3 1713.79,-1083.37 1714.19,-1090.36"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge109" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1556.16,-1115.04C1573.01,-1117.52 1589.98,-1120.48 1606,-1124 1660.37,-1135.93 1721.11,-1156.96 1759.9,-1171.42"/>
<polygon fill="#000000" stroke="#000000" points="1758.68,-1174.7 1769.27,-1174.94 1761.14,-1168.15 1758.68,-1174.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge110" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1585.92,-1157.03C1592.85,-1159.61 1599.58,-1162.58 1606,-1166 1627.69,-1177.57 1620.39,-1196.27 1642,-1208 1667.67,-1221.93 1699.03,-1227.94 1727.02,-1230.2"/>
<polygon fill="#000000" stroke="#000000" points="1726.96,-1233.7 1737.17,-1230.87 1727.42,-1226.72 1726.96,-1233.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge111" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1535.31,-1157.04C1581.79,-1162.3 1636.43,-1168.48 1683.96,-1173.86"/>
<polygon fill="#000000" stroke="#000000" points="1683.66,-1177.35 1693.99,-1175 1684.45,-1170.4 1683.66,-1177.35"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge112" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1583.31,-1427C1591.13,-1424.44 1598.74,-1421.46 1606,-1418 1688.46,-1378.65 1757.51,-1290.15 1786,-1249.78"/>
<polygon fill="#000000" stroke="#000000" points="1788.92,-1251.7 1791.75,-1241.49 1783.17,-1247.71 1788.92,-1251.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge113" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1594.92,-1426.97C1598.82,-1424.28 1602.52,-1421.3 1606,-1418 1674.67,-1352.79 1573.79,-1273.69 1642,-1208 1642.95,-1207.08 1643.93,-1206.19 1644.92,-1205.33"/>
<polygon fill="#000000" stroke="#000000" points="1647.08,-1208.08 1652.86,-1199.2 1642.8,-1202.54 1647.08,-1208.08"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge114" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1543.96,-947.03C1564.66,-949.65 1586.01,-952.66 1606,-956 1651.55,-963.62 1702.58,-974.77 1740.87,-983.67"/>
<polygon fill="#000000" stroke="#000000" points="1740.28,-987.12 1750.81,-986 1741.87,-980.31 1740.28,-987.12"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge115" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1594.24,-947.11C1598.36,-949.77 1602.29,-952.72 1606,-956 1656.38,-1000.57 1600.7,-1049.91 1642,-1103 1668.33,-1136.84 1712.2,-1158.61 1747.04,-1171.49"/>
<polygon fill="#000000" stroke="#000000" points="1746.01,-1174.83 1756.6,-1174.88 1748.35,-1168.24 1746.01,-1174.83"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge116" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1593.68,-1073.06C1597.99,-1075.72 1602.11,-1078.69 1606,-1082 1650.35,-1119.76 1597.92,-1169.93 1642,-1208 1665.04,-1227.9 1697.47,-1234.57 1726.95,-1235.71"/>
<polygon fill="#000000" stroke="#000000" points="1727.17,-1239.22 1737.23,-1235.9 1727.3,-1232.22 1727.17,-1239.22"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge117" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1543.96,-1048.97C1564.66,-1046.35 1586.01,-1043.34 1606,-1040 1651.55,-1032.38 1702.58,-1021.23 1740.87,-1012.33"/>
<polygon fill="#000000" stroke="#000000" points="1741.87,-1015.69 1750.81,-1010 1740.28,-1008.88 1741.87,-1015.69"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge118" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1573.08,-1073.03C1584.34,-1075.51 1595.44,-1078.46 1606,-1082 1623.56,-1087.88 1625.82,-1093.98 1642,-1103 1685.1,-1127.02 1735.54,-1153.56 1767.62,-1170.26"/>
<polygon fill="#000000" stroke="#000000" points="1766.07,-1173.4 1776.55,-1174.9 1769.29,-1167.19 1766.07,-1173.4"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge119" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1579.15,-1384.91C1588.37,-1382.42 1597.39,-1379.47 1606,-1376 1679.65,-1346.3 1749.72,-1280.99 1781.77,-1248.35"/>
<polygon fill="#000000" stroke="#000000" points="1784.28,-1250.79 1788.73,-1241.17 1779.26,-1245.92 1784.28,-1250.79"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge120" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1594.74,-1384.77C1598.69,-1382.15 1602.45,-1379.23 1606,-1376 1662.45,-1324.57 1585.92,-1259.82 1642,-1208 1643,-1207.08 1644.02,-1206.18 1645.06,-1205.31"/>
<polygon fill="#000000" stroke="#000000" points="1647.41,-1207.92 1653.38,-1199.16 1643.25,-1202.29 1647.41,-1207.92"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge121" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1571.07,-1342.98C1583.01,-1340.52 1594.79,-1337.55 1606,-1334 1670.78,-1313.46 1738.97,-1270.94 1774.72,-1246.78"/>
<polygon fill="#000000" stroke="#000000" points="1776.8,-1249.6 1783.08,-1241.06 1772.85,-1243.82 1776.8,-1249.6"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge122" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1593.68,-1342.94C1597.99,-1340.28 1602.11,-1337.31 1606,-1334 1650.35,-1296.24 1597.92,-1246.07 1642,-1208 1643.33,-1206.85 1644.7,-1205.74 1646.09,-1204.68"/>
<polygon fill="#000000" stroke="#000000" points="1648.06,-1207.57 1654.36,-1199.05 1644.12,-1201.78 1648.06,-1207.57"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge123" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1556.16,-1300.96C1573.01,-1298.48 1589.98,-1295.52 1606,-1292 1660.37,-1280.07 1721.11,-1259.04 1759.9,-1244.58"/>
<polygon fill="#000000" stroke="#000000" points="1761.14,-1247.85 1769.27,-1241.06 1758.68,-1241.3 1761.14,-1247.85"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge124" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1591.93,-1300.95C1596.83,-1298.31 1601.54,-1295.34 1606,-1292 1638.53,-1267.68 1609.64,-1232.55 1642,-1208 1643.65,-1206.75 1645.35,-1205.55 1647.07,-1204.4"/>
<polygon fill="#000000" stroke="#000000" points="1649.17,-1207.22 1655.98,-1199.11 1645.6,-1201.21 1649.17,-1207.22"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge125" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1535.31,-1258.96C1596.89,-1251.99 1672.81,-1243.4 1727.52,-1237.2"/>
<polygon fill="#000000" stroke="#000000" points="1727.94,-1240.68 1737.49,-1236.08 1727.15,-1233.72 1727.94,-1240.68"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge126" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1585.92,-1258.97C1592.85,-1256.39 1599.58,-1253.42 1606,-1250 1627.69,-1238.43 1620.39,-1219.73 1642,-1208 1645.36,-1206.18 1648.82,-1204.49 1652.35,-1202.93"/>
<polygon fill="#000000" stroke="#000000" points="1653.91,-1206.07 1661.87,-1199.08 1651.29,-1199.58 1653.91,-1206.07"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge127" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1605.54,-1229C1648.55,-1229 1692.21,-1229 1727.23,-1229"/>
<polygon fill="#000000" stroke="#000000" points="1727.34,-1232.5 1737.34,-1229 1727.34,-1225.5 1727.34,-1232.5"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge128" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1535.31,-1216.96C1581.79,-1211.7 1636.43,-1205.52 1683.96,-1200.14"/>
<polygon fill="#000000" stroke="#000000" points="1684.45,-1203.6 1693.99,-1199 1683.66,-1196.65 1684.45,-1203.6"/>
</g>
<!-- proc~dyn_mpas_debug_print&#45;&gt;proc~stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge129" class="edge">
<title>proc~dyn_mpas_debug_print&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1556.35,-234.06C1573.33,-237.59 1590.29,-242.13 1606,-248 1674.01,-273.39 1743.16,-325.16 1777.6,-353.1"/>
<polygon fill="#000000" stroke="#000000" points="1775.64,-356.02 1785.59,-359.67 1780.09,-350.61 1775.64,-356.02"/>
</g>
<!-- mpas_pool_get_subpool -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node85" class="node">
<title>mpas_pool_get_subpool</title>
<polygon fill="#777777" stroke="#777777" points="2136,-1199 1996,-1199 1996,-1175 2136,-1175 2136,-1199"/>
<text text-anchor="middle" x="2066" y="-1184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_subpool</text>
</g>
<!-- proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge130" class="edge">
<title>proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool</title>
<path fill="none" stroke="#000000" d="M1960.3,-1187C1968.94,-1187 1977.43,-1187 1985.59,-1187"/>
<polygon fill="#000000" stroke="#000000" points="1985.75,-1190.5 1995.75,-1187 1985.75,-1183.5 1985.75,-1190.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocdynamics_to_physics_couplingCallsGraph = svgPanZoom('#procdynamics_to_physics_couplingCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Called by</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dynamics_to_physics_coupling~~CalledByGraph Pages: 1 -->
<svg id="procdynamics_to_physics_couplingCalledByGraph" width="552pt" height="32pt"
 viewBox="0.00 0.00 552.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~dynamics_to_physics_coupling~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 548,-28 548,4 -4,4"/>
<!-- proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_node1" class="node">
<title>proc~dynamics_to_physics_coupling</title>
<polygon fill="none" stroke="black" points="544,-24 369,-24 369,0 544,0 544,-24"/>
<text text-anchor="middle" x="456.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">dynamics_to_physics_coupling</text>
</g>
<!-- interface~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_node2" class="node">
<title>interface~dynamics_to_physics_coupling</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CalledByGraph_node2"><a xlink:href="../interface/dynamics_to_physics_coupling.html" xlink:title="dynamics_to_physics_coupling">
<polygon fill="#a7506f" stroke="#a7506f" points="333,-24 158,-24 158,0 333,0 333,-24"/>
<text text-anchor="middle" x="245.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dynamics_to_physics_coupling</text>
</a>
</g>
</g>
<!-- interface~dynamics_to_physics_coupling&#45;&gt;proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_edge1" class="edge">
<title>interface~dynamics_to_physics_coupling&#45;&gt;proc~dynamics_to_physics_coupling</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M333.02,-12C341.49,-12 350.13,-12 358.7,-12"/>
<polygon fill="#000000" stroke="#000000" points="358.71,-15.5 368.71,-12 358.71,-8.5 358.71,-15.5"/>
</g>
<!-- proc~stepon_timestep_init -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_node3" class="node">
<title>proc~stepon_timestep_init</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CalledByGraph_node3"><a xlink:href="../proc/stepon_timestep_init.html" xlink:title="stepon_timestep_init">
<polygon fill="#d9534f" stroke="#d9534f" points="122,-24 0,-24 0,0 122,0 122,-24"/>
<text text-anchor="middle" x="61" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stepon_timestep_init</text>
</a>
</g>
</g>
<!-- proc~stepon_timestep_init&#45;&gt;interface~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_edge2" class="edge">
<title>proc~stepon_timestep_init&#45;&gt;interface~dynamics_to_physics_coupling</title>
<path fill="none" stroke="#000000" d="M122.01,-12C130.22,-12 138.82,-12 147.49,-12"/>
<polygon fill="#000000" stroke="#000000" points="147.68,-15.5 157.68,-12 147.68,-8.5 147.68,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
      <br>


        <section>
          <h2>Variables</h2>
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-column_index"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>column_index</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dp_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dp_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dpd_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dpd_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dz_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dz_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-exner"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>exner</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-index_qv~4"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>index_qv</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-is_water_species_index~2"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>is_water_species_index</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omega_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>omega_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p_int_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>p_int_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>p_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pd_int_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>pd_int_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pd_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>pd_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-qv_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>qv_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rho_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rho_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rho_zz"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>rho_zz</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rhod_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rhod_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scalars~4"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>scalars</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sigma_all_q_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>sigma_all_q_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-subname~68"></span>
              character(len=*),
            </td>
              <td>private,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>subname</strong></td>
<td> =</td>
                <td>&#39;dyn_coupling::dynamics_to_physics_coupling&#39;</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>t_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-theta_m"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>theta_m</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tm_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>tm_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tv_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>tv_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>u_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ucellmeridional~3"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>ucellmeridional</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ucellzonal~3"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>ucellzonal</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-v_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>v_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w~2"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>w</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z_int_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>z_int_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zgrid~3"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>zgrid</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zz~2"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>zz</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

        </section>
        <br>






        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-final_shared_variables~2"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-final_shared_variables~2'>final_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Finalize variables that are shared and repeatedly used by the <code>update_shared_variables</code> and
<code>set_physics_state_column</code> internal subroutines.
(KCW, 2024-07-20)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-init_shared_variables~2"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-init_shared_variables~2'>init_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Initialize variables that are shared and repeatedly used by the <code>update_shared_variables</code> and
<code>set_physics_state_column</code> internal subroutines.
(KCW, 2024-07-20)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_physics_state_column"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-set_physics_state_column'>set_physics_state_column</a>(i)  
</h3></div>
    <div class="card-body">
          
  <p>Set variables for the specific column, indicated by <code>i</code>, in the <code>physics_state</code> derived type.
This subroutine and <code>update_shared_variables</code> should be called in pairs.
(KCW, 2024-07-30)</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-i~27"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_physics_state_external"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-set_physics_state_external'>set_physics_state_external</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set variables in the <code>physics_state</code> derived type by calling external procedures.
(KCW, 2024-07-30)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-update_shared_variables"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-update_shared_variables'>update_shared_variables</a>(i)  
</h3></div>
    <div class="card-body">
          
  <p>Update variables for the specific column, indicated by <code>i</code>. This subroutine and <code>set_physics_state_column</code>
should be called in pairs.
(KCW, 2024-07-30)</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-i~26"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

        </section>


        <section>
          <h2><span class="anchor" id="src"></span>Source Code</h2>
          <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">module subroutine </span><span class="n">dynamics_to_physics_coupling</span><span class="p">()</span>
<span class="w">        </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">        </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">debugout_info</span>
<span class="w">        </span><span class="k">use </span><span class="n">dyn_comp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_debug_print</span><span class="p">,</span><span class="w"> </span><span class="n">kind_dyn_mpas</span>
<span class="w">        </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">        </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">        </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">kind_r8</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_r8</span>

<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling&#39;</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">column_index</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">is_water_species_index</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">index_qv</span>
<span class="w">        </span><span class="c">! Variable name suffixes have the following meanings:</span>
<span class="w">        </span><span class="c">! `*_col`: Variable is of each column.</span>
<span class="w">        </span><span class="c">! `*_int`: Variable is at layer interfaces.</span>
<span class="w">        </span><span class="c">! `*_mid`: Variable is at layer midpoints.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pd_int_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Dry hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">pd_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Dry non-hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">p_int_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Full hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">p_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Full non-hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">z_int_col</span><span class="p">(:)</span><span class="w">           </span><span class="c">! Geometric height (m).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">          </span><span class="c">! Dry air pressure difference (Pa) between layer interfaces.</span>
<span class="w">                                      </span><span class="n">dp_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">           </span><span class="c">! Full air pressure difference (Pa) between layer interfaces.</span>
<span class="w">                                      </span><span class="n">dz_col</span><span class="p">(:)</span><span class="w">              </span><span class="c">! Geometric height difference (m) between layer interfaces.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Water vapor mixing ratio (kg kg-1).</span>
<span class="w">                                      </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="c">! Summation of all water species mixing ratios (kg kg-1).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">     </span><span class="c">! Dry air density (kg m-3).</span>
<span class="w">                                      </span><span class="n">rho_mid_col</span><span class="p">(:)</span><span class="w">         </span><span class="c">! Full air density (kg m-3).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Temperature (K).</span>
<span class="w">                                      </span><span class="n">tm_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Modified &quot;moist&quot; temperature (K).</span>
<span class="w">                                      </span><span class="n">tv_mid_col</span><span class="p">(:)</span><span class="w">          </span><span class="c">! Virtual temperature (K).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">u_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Eastward wind velocity (m s-1).</span>
<span class="w">                                      </span><span class="n">v_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Northward wind velocity (m s-1).</span>
<span class="w">                                      </span><span class="n">omega_mid_col</span><span class="p">(:)</span><span class="w">       </span><span class="c">! Vertical pressure velocity (Pa s-1).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">exner</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rho_zz</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scalars</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">theta_m</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">w</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; entered&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="k">call </span><span class="n">init_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_exchange_constituent_states</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">exchange</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="n">conversion</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_info</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting physics state variables column by column&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="c">! Set variables in the `physics_state` derived type column by column.</span>
<span class="w">        </span><span class="c">! This way, peak memory usage can be reduced.</span>
<span class="w">        </span><span class="k">do </span><span class="n">column_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">            </span><span class="k">call </span><span class="n">update_shared_variables</span><span class="p">(</span><span class="n">column_index</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">set_physics_state_column</span><span class="p">(</span><span class="n">column_index</span><span class="p">)</span>
<span class="w">        </span><span class="k">end do</span>

<span class="k">        call </span><span class="n">set_physics_state_external</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">final_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; completed&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">contains</span>
<span class="w">        </span><span class="c">!&gt; Initialize variables that are shared and repeatedly used by the `update_shared_variables` and</span>
<span class="w">        </span><span class="c">!&gt; `set_physics_state_column` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-20)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">init_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">const_is_water_species</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_comp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">mpas_dynamical_core</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::init_shared_variables&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">is_water_species</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_info</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Preparing for dynamics-physics coupling&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">exner</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_m</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">is_water_species</span><span class="p">(</span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;is_water_species(num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">                </span><span class="n">is_water_species</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">const_is_water_species</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            allocate</span><span class="p">(</span><span class="n">is_water_species_index</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="n">is_water_species</span><span class="p">)),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;is_water_species_index(count(is_water_species))&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="n">is_water_species_index</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="nb">pack</span><span class="p">([(</span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_mpas_scalar_index</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span><span class="p">)],</span><span class="w"> </span><span class="n">is_water_species</span><span class="p">)</span>

<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">is_water_species</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="n">pd_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;pd_int_col(pverp), pd_mid_col(pver), p_int_col(pverp), p_mid_col(pver), z_int_col(pverp)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">dpd_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">dz_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;dpd_col(pver), dp_col(pver), dz_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;qv_mid_col(pver), sigma_all_q_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">rhod_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;rhod_mid_col(pver), rho_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">t_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">tv_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;t_mid_col(pver), tm_mid_col(pver), tv_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">u_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">v_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">omega_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;u_mid_col(pver), v_mid_col(pver), omega_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dim&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;index_qv&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">exner</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;exner&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rho_zz&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scalars&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">theta_m</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;theta_m&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructZonal&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructMeridional&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zgrid</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zgrid&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zz&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">init_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Finalize variables that are shared and repeatedly used by the `update_shared_variables` and</span>
<span class="w">        </span><span class="c">!&gt; `set_physics_state_column` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-20)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">final_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::final_shared_variables&#39;</span>

<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">is_water_species_index</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">pd_int_col</span><span class="p">,</span><span class="w"> </span><span class="n">pd_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">,</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">dpd_col</span><span class="p">,</span><span class="w"> </span><span class="n">dp_col</span><span class="p">,</span><span class="w"> </span><span class="n">dz_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">rhod_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">t_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">tv_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">u_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">v_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">omega_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">exner</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_m</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">final_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Update variables for the specific column, indicated by `i`. This subroutine and `set_physics_state_column`</span>
<span class="w">        </span><span class="c">!&gt; should be called in pairs.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-30)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">update_shared_variables</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp_by_hydrostatic_equation</span><span class="p">,</span><span class="w"> </span><span class="n">omega_of_w_rho</span><span class="p">,</span><span class="w"> </span><span class="n">p_by_equation_of_state</span><span class="p">,</span><span class="w"> </span><span class="n">t_of_tm_qv</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rv</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rh2o</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span>
<span class="w">            </span><span class="c">! Module(s) from MPAS.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_mpas_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">clamp</span>

<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::update_shared_variables&#39;</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span>
<span class="w">            </span><span class="c">! Proximity limit, in fraction, on how close `p{,d}_mid_col` is allowed to be around its surrounding `p{,d}_int_col`.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05_kind_r8</span>

<span class="w">            </span><span class="c">! The summation term of equation 5 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scalars</span><span class="p">(</span><span class="n">is_water_species_index</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Compute thermodynamic variables.</span>

<span class="w">            </span><span class="c">! By definition.</span>
<span class="w">            </span><span class="n">z_int_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">dz_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">)</span>
<span class="w">            </span><span class="n">qv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">rhod_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Equation 5 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">rho_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span>

<span class="w">            </span><span class="c">! Hydrostatic equation.</span>
<span class="w">            </span><span class="n">dpd_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp_by_hydrostatic_equation</span><span class="p">(</span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">dz_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">dp_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp_by_hydrostatic_equation</span><span class="p">(</span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">dz_col</span><span class="p">)</span>

<span class="w">            </span><span class="c">! By definition of Exner function. Also see below.</span>
<span class="w">            </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">theta_m</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">exner</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>

<span class="w">            </span><span class="c">! The paragraph below equation 2.7 in doi:10.5065/1DFH-6P97.</span>
<span class="w">            </span><span class="c">! The paragraph below equation 2 in doi:10.1175/MWR-D-11-00215.1.</span>
<span class="w">            </span><span class="n">t_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_of_tm_qv</span><span class="p">(</span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rv</span><span class="p">,</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Equation 16 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="c">! The numerator terms are just `tm_mid_col` here (i.e., modified &quot;moist&quot; temperature).</span>
<span class="w">            </span><span class="n">tv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span>

<span class="w">            </span><span class="c">! Equation of state.</span>
<span class="w">            </span><span class="c">! Equation 11 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">pd_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_equation_of_state</span><span class="p">(</span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">t_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Equation 17 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">p_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_equation_of_state</span><span class="p">(</span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">tv_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="c">! By definition.</span>
<span class="w">            </span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pd_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span>
<span class="w">            </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Integrate downward.</span>
<span class="w">            </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                </span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">                </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="w">            </span><span class="c">! `p{,d}_mid_col` is not guaranteed to be bounded by `p{,d}_int_col` because the former is non-hydrostatic</span>
<span class="w">            </span><span class="c">! while the latter is hydrostatic. In high-resolution simulations, the former could exceed the latter,</span>
<span class="w">            </span><span class="c">! leading to a model crash in physics.</span>
<span class="w">            </span><span class="c">! Impose range limits on `p{,d}_mid_col` so it is bounded by `p{,d}_int_col`.</span>
<span class="w">            </span><span class="n">pd_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clamp</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pd_mid_col</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pd_int_col</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pd_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">)</span>
<span class="w">            </span><span class="n">p_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clamp</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">p_mid_col</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">p_int_col</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">p_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Compute momentum variables.</span>

<span class="w">            </span><span class="c">! By definition.</span>
<span class="w">            </span><span class="n">u_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">v_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">omega_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">omega_of_w_rho</span><span class="p">(</span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">update_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Set variables for the specific column, indicated by `i`, in the `physics_state` derived type.</span>
<span class="w">        </span><span class="c">!&gt; This subroutine and `update_shared_variables` should be called in pairs.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-30)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_physics_state_column</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">reverse</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span>
<span class="w">            </span><span class="k">use </span><span class="n">physics_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">phys_state</span>

<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::set_physics_state_column&#39;</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="c">! Always call `reverse` when assigning anything to/from the `physics_state` derived type.</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">u_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">v_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">omega</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">omega_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">psdry</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pd_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pintdry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">pd_int_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmiddry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">pd_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdeldry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">-</span><span class="n">dpd_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpintdry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pintdry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpmiddry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmiddry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">rpdeldry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdeldry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">ps</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">p_int_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">-</span><span class="n">dp_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">rpdel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">t_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">phis</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_physics_state_column</span>

<span class="w">        </span><span class="c">!&gt; Set variables in the `physics_state` derived type by calling external procedures.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-30)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_physics_state_external</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span><span class="p">,</span><span class="w"> </span><span class="n">endrun</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">const_qmin</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_thermo</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_thermo_dry_air_update</span><span class="p">,</span><span class="w"> </span><span class="n">cam_thermo_water_update</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_thermo_formula</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">energy_formula_dycore_mpas</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_comp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">mpas_dynamical_core</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">exner_function</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span>
<span class="w">            </span><span class="k">use </span><span class="n">physics_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cappav</span><span class="p">,</span><span class="w"> </span><span class="n">cp_or_cv_dycore</span><span class="p">,</span><span class="w"> </span><span class="n">cpairv</span><span class="p">,</span><span class="w"> </span><span class="n">lagrangian_vertical</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="p">,</span><span class="w"> </span><span class="n">rairv</span><span class="p">,</span><span class="w"> </span><span class="n">zvirv</span>
<span class="w">            </span><span class="k">use </span><span class="n">runtime_obj</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_runtime_opts</span>
<span class="w">            </span><span class="k">use </span><span class="n">string_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">stringify</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span>
<span class="w">            </span><span class="c">! Module(s) from CCPP.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_ccpp_cap</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_constituents_array</span><span class="p">,</span><span class="w"> </span><span class="n">cam_model_const_properties</span>
<span class="w">            </span><span class="k">use </span><span class="n">ccpp_constituent_prop_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ccpp_constituent_prop_ptr_t</span>
<span class="w">            </span><span class="k">use </span><span class="n">ccpp_kinds</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">kind_phys</span>
<span class="w">            </span><span class="k">use </span><span class="n">geopotential_temp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">geopotential_temp_run</span>
<span class="w">            </span><span class="k">use </span><span class="n">qneg</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">qneg_run</span>
<span class="w">            </span><span class="k">use </span><span class="n">static_energy</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">update_dry_static_energy_run</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::set_physics_state_external&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_phys</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">minimum_constituents</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_phys</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituents</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="k">type</span><span class="p">(</span><span class="n">ccpp_constituent_prop_ptr_t</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituent_properties</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_info</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting physics state variables externally&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituents</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituent_properties</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">minimum_constituents</span><span class="p">(</span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;minimum_constituents(num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">                </span><span class="n">minimum_constituents</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">const_qmin</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            </span><span class="n">constituents</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_constituents_array</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">constituents</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;constituents&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            </span><span class="n">constituent_properties</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_model_const_properties</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">constituent_properties</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;constituent_properties&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! Update `cappav`, `cpairv`, `rairv`, `zvirv`, etc. as needed by calling `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="c">! Note that this subroutine expects constituents to be dry.</span>
<span class="w">            </span><span class="k">call </span><span class="n">cam_thermo_dry_air_update</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">cam_runtime_opts</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">update_thermodynamic_variables</span><span class="p">())</span>

<span class="w">            </span><span class="c">! Update `cp_or_cv_dycore` by calling `cam_thermo_water_update`.</span>
<span class="w">            </span><span class="c">! Note that this subroutine expects constituents to be dry.</span>
<span class="w">            </span><span class="k">call </span><span class="n">cam_thermo_water_update</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">energy_formula_dycore_mpas</span><span class="p">,</span><span class="w"> </span><span class="n">cp_or_cv_dycore</span><span class="p">)</span>

<span class="w">            </span><span class="c">! This variable name is really misleading. It actually represents the reciprocal of Exner function</span>
<span class="w">            </span><span class="c">! with respect to surface pressure. This definition is sometimes used for boundary layer work. See</span>
<span class="w">            </span><span class="c">! the paragraph below equation 1.5.1c in doi:10.1007/978-94-009-3027-8.</span>
<span class="w">            </span><span class="c">! Also note that `cappav` is updated externally by `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exner</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">exner_function</span><span class="p">(</span><span class="n">cappav</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">ps</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="k">end do</span>

<span class="w">            </span><span class="c">! Note that constituents become moist after this.</span>
<span class="w">            </span><span class="k">call </span><span class="n">dyn_exchange_constituent_states</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">exchange</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">conversion</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="w">            </span><span class="c">! Impose minimum limits on constituents.</span>
<span class="w">            </span><span class="k">call </span><span class="n">qneg_run</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">minimum_constituents</span><span class="p">,</span><span class="w"> </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">cerr</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to impose minimum limits on constituents externally&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;External procedure returned with &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">stringify</span><span class="p">([</span><span class="n">ierr</span><span class="p">])</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! Set `zi` (i.e., geopotential height at layer interfaces) and `zm` (i.e., geopotential height at layer midpoints).</span>
<span class="w">            </span><span class="c">! Note that `rairv` and `zvirv` are updated externally by `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="k">call </span><span class="n">geopotential_temp_run</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">lagrangian_vertical</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpint</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pint</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdel</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">rpdel</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituents</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_constituent_index</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)),</span><span class="w"> </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituent_properties</span><span class="p">,</span><span class="w"> </span><span class="n">rairv</span><span class="p">,</span><span class="w"> </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">zvirv</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">zi</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">zm</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">cerr</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to set variable &quot;zi&quot; and &quot;zm&quot; externally&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;External procedure returned with &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">stringify</span><span class="p">([</span><span class="n">ierr</span><span class="p">])</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! Set `dse` (i.e., dry static energy).</span>
<span class="w">            </span><span class="c">! Note that `cpairv` is updated externally by `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="k">call </span><span class="n">update_dry_static_energy_run</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">zm</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">phis</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">dse</span><span class="p">,</span><span class="w"> </span><span class="n">cpairv</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">cerr</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to set variable &quot;dse&quot; externally&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;External procedure returned with &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">stringify</span><span class="p">([</span><span class="n">ierr</span><span class="p">])</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">minimum_constituents</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituents</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituent_properties</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_physics_state_external</span>
<span class="w">    </span><span class="k">end subroutine </span><span class="n">dynamics_to_physics_coupling</span>
</pre></div>

        </section>
        <br>
    </div>
  </div>
      <hr>
    </div>

    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              MPAS Dynamical Core
was developed by CAM-SIMA & MPAS Developers<br>              © 2025 
            </p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div>
    </footer>
  </body>
</html>