<!-- -*- mode: jinja2 -*- -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="MPAS dynamical core solves the fully compressible non-hydrostatic equations of atmospheric motion.">
    <meta name="author" content="CAM-SIMA & MPAS Developers">
    <link href="../favicon.png" rel="icon">

    <title>set_analytic_initial_condition â€“ MPAS Dynamical Core</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      crossorigin="anonymous"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      rel="stylesheet"
    >
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    ></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
      async
      crossorigin="anonymous"
      integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw="
    ></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>
    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html"
            >MPAS Dynamical Core </a
          >
          <button
            class="navbar-toggler"
            data-bs-target="#navbar"
            data-bs-toggle="collapse"
            type="button"
            aria-controls="navbar"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse collapse" id="navbar">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div>
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>
      set_analytic_initial_condition
      <small
        >          Subroutine
</small
      >
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 8.0% of total for procedures.">297 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dyn_comp_impl.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dyn_comp_impl.f90.html'>dyn_comp_impl.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/dyn_comp_impl.html'>dyn_comp_impl</a></li>
            <li class="breadcrumb-item active" aria-current="page">set_analytic_initial_condition</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">  <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-buffer_2d_real">buffer_2d_real</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-buffer_3d_real">buffer_3d_real</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-global_grid_index~2">global_grid_index</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-lat_rad">lat_rad</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-lon_rad">lon_rad</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-subname~55">subname</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-z_int">z_int</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-zgrid~2">zgrid</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-final_shared_variables">final_shared_variables</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-init_shared_variables">init_shared_variables</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_base_theta_base">set_mpas_state_rho_base_theta_base</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_theta">set_mpas_state_rho_theta</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_scalars">set_mpas_state_scalars</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_u">set_mpas_state_u</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_w">set_mpas_state_w</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#src">set_analytic_initial_condition</a>
      </div>
    </div>


  </div>
</div>

    <div class="col-md-9" id="text">
      <h2> subroutine set_analytic_initial_condition()  
</h2>
          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item">cam_logfile</li>
                  <li class="list-inline-item">shr_kind_mod</li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~set_analytic_initial_condition~~UsesGraph Pages: 1 -->
<svg id="procset_analytic_initial_conditionUsesGraph" width="295pt" height="74pt"
 viewBox="0.00 0.00 295.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~set_analytic_initial_condition~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>proc~~set_analytic_initial_condition~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-70 291,-70 291,4 -4,4"/>
<!-- proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_node1" class="node">
<title>proc~set_analytic_initial_condition</title>
<polygon fill="none" stroke="black" points="287,-45 122,-45 122,-21 287,-21 287,-45"/>
<text text-anchor="middle" x="204.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">set_analytic_initial_condition</text>
</g>
<!-- cam_logfile -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_node2" class="node">
<title>cam_logfile</title>
<polygon fill="#337ab7" stroke="#337ab7" points="80,-66 6,-66 6,-42 80,-42 80,-66"/>
<text text-anchor="middle" x="43" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_logfile</text>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;cam_logfile -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_edge1" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;cam_logfile</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M121.88,-43.75C111.07,-45.17 100.31,-46.59 90.39,-47.89"/>
<polygon fill="#000000" stroke="#000000" points="89.84,-44.43 80.39,-49.21 90.76,-51.37 89.84,-44.43"/>
</g>
<!-- shr_kind_mod -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_node3" class="node">
<title>shr_kind_mod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-24 0,-24 0,0 86,0 86,-24"/>
<text text-anchor="middle" x="43" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shr_kind_mod</text>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;shr_kind_mod -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_edge2" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;shr_kind_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M121.88,-22.25C113.15,-21.1 104.45,-19.96 96.2,-18.87"/>
<polygon fill="#000000" stroke="#000000" points="96.39,-15.37 86.02,-17.53 95.48,-22.31 96.39,-15.37"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 </div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


        <p>Set analytic initial condition for MPAS.
(KCW, 2024-05-22)</p>


      <h3>Arguments</h3>
        <em>None</em>
        <br>
        <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Calls</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~set_analytic_initial_condition~~CallsGraph Pages: 1 -->
<svg id="procset_analytic_initial_conditionCallsGraph" width="641pt" height="356pt"
 viewBox="0.00 0.00 641.00 355.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~set_analytic_initial_condition~~CallsGraph" class="graph" transform="scale(0.31 0.31) rotate(0) translate(4 1147.63)">
<title>proc~~set_analytic_initial_condition~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1147.63 2071,-1147.63 2071,4 -4,4"/>
<!-- proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node1" class="node">
<title>proc~set_analytic_initial_condition</title>
<polygon fill="none" stroke="black" points="165,-781.63 0,-781.63 0,-757.63 165,-757.63 165,-781.63"/>
<text text-anchor="middle" x="82.5" y="-767.23" font-family="Helvetica,sans-Serif" font-size="10.50">set_analytic_initial_condition</text>
</g>
<!-- interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node2" class="node">
<title>interface~dyn_debug_print</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node2"><a xlink:href="../interface/dyn_debug_print.html" xlink:title="dyn_debug_print">
<polygon fill="#a7506f" stroke="#a7506f" points="675,-861.63 574,-861.63 574,-837.63 675,-837.63 675,-861.63"/>
<text text-anchor="middle" x="624.5" y="-847.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_debug_print</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge1" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M164.64,-781.65C274.12,-797.87 466.6,-826.38 563.78,-840.78"/>
<polygon fill="#000000" stroke="#000000" points="563.33,-844.25 573.73,-842.25 564.35,-837.33 563.33,-844.25"/>
</g>
<!-- none~final_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node3" class="node">
<title>none~final_shared_variables</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node3"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-final_shared_variables" xlink:title="final_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="372.5,-903.63 241.5,-903.63 241.5,-879.63 372.5,-879.63 372.5,-903.63"/>
<text text-anchor="middle" x="307" y="-889.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">final_shared_variables</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~final_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge2" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~final_shared_variables</title>
<path fill="none" stroke="#000000" d="M93.74,-781.84C112.59,-803.44 155.06,-848.23 201,-870.63 210.43,-875.23 220.81,-878.82 231.26,-881.63"/>
<polygon fill="#000000" stroke="#000000" points="230.73,-885.1 241.27,-884.08 232.4,-878.3 230.73,-885.1"/>
</g>
<!-- none~init_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node4" class="node">
<title>none~init_shared_variables</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node4"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-init_shared_variables" xlink:title="init_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="369,-977.63 245,-977.63 245,-953.63 369,-953.63 369,-977.63"/>
<text text-anchor="middle" x="307" y="-963.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_shared_variables</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~init_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge3" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~init_shared_variables</title>
<path fill="none" stroke="#000000" d="M90.96,-781.79C107.77,-808.42 151.09,-872.66 201,-912.63 219.99,-927.83 244.04,-940.36 264.34,-949.42"/>
<polygon fill="#000000" stroke="#000000" points="263.09,-952.69 273.66,-953.45 265.87,-946.27 263.09,-952.69"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node5" class="node">
<title>none~set_mpas_state_rho_base_theta_base</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node5"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_base_theta_base" xlink:title="set_mpas_state_rho_base_theta_base">
<polygon fill="#d9534f" stroke="#d9534f" points="413,-752.63 201,-752.63 201,-728.63 413,-728.63 413,-752.63"/>
<text text-anchor="middle" x="307" y="-738.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_rho_base_theta_base</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_base_theta_base -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge4" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_base_theta_base</title>
<path fill="none" stroke="#000000" d="M165.09,-758.99C177.74,-757.34 190.94,-755.62 203.97,-753.93"/>
<polygon fill="#000000" stroke="#000000" points="204.43,-757.4 213.89,-752.63 203.53,-750.45 204.43,-757.4"/>
</g>
<!-- none~set_mpas_state_rho_theta -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node6" class="node">
<title>none~set_mpas_state_rho_theta</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node6"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_theta" xlink:title="set_mpas_state_rho_theta">
<polygon fill="#d9534f" stroke="#d9534f" points="382.5,-599.63 231.5,-599.63 231.5,-575.63 382.5,-575.63 382.5,-599.63"/>
<text text-anchor="middle" x="307" y="-585.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_rho_theta</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_theta -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge5" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_theta</title>
<path fill="none" stroke="#000000" d="M98.44,-757.4C136.6,-726.19 237.82,-643.4 283.3,-606.19"/>
<polygon fill="#000000" stroke="#000000" points="285.6,-608.84 291.12,-599.8 281.16,-603.42 285.6,-608.84"/>
</g>
<!-- none~set_mpas_state_scalars -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node7" class="node">
<title>none~set_mpas_state_scalars</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node7"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_scalars" xlink:title="set_mpas_state_scalars">
<polygon fill="#d9534f" stroke="#d9534f" points="375.5,-295.63 238.5,-295.63 238.5,-271.63 375.5,-271.63 375.5,-295.63"/>
<text text-anchor="middle" x="307" y="-281.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_scalars</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_scalars -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge6" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_scalars</title>
<path fill="none" stroke="#000000" d="M84.9,-757.3C91.08,-707.11 119.26,-514.53 201,-382.63 221.57,-349.43 256.01,-319.96 279.81,-301.98"/>
<polygon fill="#000000" stroke="#000000" points="282.09,-304.65 288.05,-295.9 277.93,-299.02 282.09,-304.65"/>
</g>
<!-- none~set_mpas_state_u -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node8" class="node">
<title>none~set_mpas_state_u</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node8"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_u" xlink:title="set_mpas_state_u">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-415.63 254,-415.63 254,-391.63 360,-391.63 360,-415.63"/>
<text text-anchor="middle" x="307" y="-401.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_u</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_u -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge7" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_u</title>
<path fill="none" stroke="#000000" d="M90.19,-757.61C107.83,-726.04 157.26,-638.21 201,-566.63 232.65,-514.83 271.82,-455.12 292.2,-424.35"/>
<polygon fill="#000000" stroke="#000000" points="295.28,-426.04 297.9,-415.77 289.45,-422.17 295.28,-426.04"/>
</g>
<!-- none~set_mpas_state_w -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node9" class="node">
<title>none~set_mpas_state_w</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node9"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_w" xlink:title="set_mpas_state_w">
<polygon fill="#d9534f" stroke="#d9534f" points="361,-861.63 253,-861.63 253,-837.63 361,-837.63 361,-861.63"/>
<text text-anchor="middle" x="307" y="-847.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_w</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_w -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge8" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_w</title>
<path fill="none" stroke="#000000" d="M114.83,-781.63C138.45,-790.62 171.68,-803.11 201,-813.63 220.37,-820.57 241.86,-827.99 260.32,-834.28"/>
<polygon fill="#000000" stroke="#000000" points="259.36,-837.65 269.95,-837.55 261.61,-831.02 259.36,-837.65"/>
</g>
<!-- proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node18" class="node">
<title>proc~dyn_debug_print</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node18"><a xlink:href="../proc/dyn_debug_print.html" xlink:title="dyn_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="1041,-910.63 940,-910.63 940,-886.63 1041,-886.63 1041,-910.63"/>
<text text-anchor="middle" x="990.5" y="-896.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_debug_print</text>
</a>
</g>
</g>
<!-- interface~dyn_debug_print&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge9" class="edge">
<title>interface~dyn_debug_print&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675.35,-856.34C741.69,-865.27 858.87,-881.04 929.84,-890.6"/>
<polygon fill="#000000" stroke="#000000" points="929.58,-894.09 939.96,-891.96 930.52,-887.16 929.58,-894.09"/>
</g>
<!-- none~init_shared_variables&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge15" class="edge">
<title>none~init_shared_variables&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M340.87,-953.54C398.4,-932.39 517.26,-888.69 580.97,-865.26"/>
<polygon fill="#000000" stroke="#000000" points="582.52,-868.42 590.7,-861.69 580.11,-861.85 582.52,-868.42"/>
</g>
<!-- cam_grid_get_latvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node10" class="node">
<title>cam_grid_get_latvals</title>
<polygon fill="#777777" stroke="#777777" points="686.5,-1059.63 562.5,-1059.63 562.5,-1035.63 686.5,-1035.63 686.5,-1059.63"/>
<text text-anchor="middle" x="624.5" y="-1045.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_get_latvals</text>
</g>
<!-- none~init_shared_variables&#45;&gt;cam_grid_get_latvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge10" class="edge">
<title>none~init_shared_variables&#45;&gt;cam_grid_get_latvals</title>
<path fill="none" stroke="#000000" d="M330.23,-977.65C357.41,-991.78 405.23,-1014.79 449,-1026.63 482.22,-1035.61 520.05,-1040.75 551.97,-1043.7"/>
<polygon fill="#000000" stroke="#000000" points="551.84,-1047.2 562.11,-1044.58 552.45,-1040.23 551.84,-1047.2"/>
</g>
<!-- cam_grid_get_lonvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node11" class="node">
<title>cam_grid_get_lonvals</title>
<polygon fill="#777777" stroke="#777777" points="688,-1017.63 561,-1017.63 561,-993.63 688,-993.63 688,-1017.63"/>
<text text-anchor="middle" x="624.5" y="-1003.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_get_lonvals</text>
</g>
<!-- none~init_shared_variables&#45;&gt;cam_grid_get_lonvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge11" class="edge">
<title>none~init_shared_variables&#45;&gt;cam_grid_get_lonvals</title>
<path fill="none" stroke="#000000" d="M369.21,-973.39C421.16,-979.97 495.83,-989.44 550.82,-996.41"/>
<polygon fill="#000000" stroke="#000000" points="550.49,-999.9 560.85,-997.68 551.37,-992.95 550.49,-999.9"/>
</g>
<!-- cam_grid_id -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node12" class="node">
<title>cam_grid_id</title>
<polygon fill="#777777" stroke="#777777" points="663,-1143.63 586,-1143.63 586,-1119.63 663,-1119.63 663,-1143.63"/>
<text text-anchor="middle" x="624.5" y="-1129.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_id</text>
</g>
<!-- none~init_shared_variables&#45;&gt;cam_grid_id -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge12" class="edge">
<title>none~init_shared_variables&#45;&gt;cam_grid_id</title>
<path fill="none" stroke="#000000" d="M315.41,-977.63C333.89,-1006.36 385.12,-1079.01 449,-1110.63 488.45,-1130.15 538.85,-1134.34 575.33,-1134.28"/>
<polygon fill="#000000" stroke="#000000" points="575.75,-1137.77 585.71,-1134.14 575.66,-1130.77 575.75,-1137.77"/>
</g>
<!-- check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node13" class="node">
<title>check_allocate</title>
<polygon fill="#777777" stroke="#777777" points="670.5,-537.63 578.5,-537.63 578.5,-513.63 670.5,-513.63 670.5,-537.63"/>
<text text-anchor="middle" x="624.5" y="-523.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_allocate</text>
</g>
<!-- none~init_shared_variables&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge13" class="edge">
<title>none~init_shared_variables&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M354.23,-953.56C375.61,-945.53 399.27,-932.67 413,-912.63 459.19,-845.21 391.84,-605.04 449,-546.63 479.17,-515.8 529.23,-512.61 568.02,-515.94"/>
<polygon fill="#000000" stroke="#000000" points="567.82,-519.44 578.12,-516.98 568.53,-512.48 567.82,-519.44"/>
</g>
<!-- endrun -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node16" class="node">
<title>endrun</title>
<polygon fill="#777777" stroke="#777777" points="651.5,-1101.63 597.5,-1101.63 597.5,-1077.63 651.5,-1077.63 651.5,-1101.63"/>
<text text-anchor="middle" x="624.5" y="-1087.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endrun</text>
</g>
<!-- none~init_shared_variables&#45;&gt;endrun -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge14" class="edge">
<title>none~init_shared_variables&#45;&gt;endrun</title>
<path fill="none" stroke="#000000" d="M319.88,-977.72C342.61,-1000.02 394.85,-1047.29 449,-1068.63 494.35,-1086.49 551.04,-1090.24 587.27,-1090.53"/>
<polygon fill="#000000" stroke="#000000" points="587.37,-1094.03 597.37,-1090.53 587.37,-1087.03 587.37,-1094.03"/>
</g>
<!-- none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node17" class="node">
<title>none~get_variable_pointer</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node17"><a xlink:href="../type/mpas_dynamical_core_type.html#boundprocedure-get_variable_pointer" xlink:title="mpas_dynamical_core_type%get_variable_pointer">
<polygon fill="#a7506f" stroke="#a7506f" points="1130,-645.63 851,-645.63 851,-621.63 1130,-621.63 1130,-645.63"/>
<text text-anchor="middle" x="990.5" y="-631.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%get_variable_pointer</text>
</a>
</g>
</g>
<!-- none~init_shared_variables&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge16" class="edge">
<title>none~init_shared_variables&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M369.37,-967.83C484.78,-970.9 728.9,-971.97 800,-929.63 807.01,-925.45 934.69,-721.46 976.42,-654.6"/>
<polygon fill="#000000" stroke="#000000" points="979.61,-656.11 981.93,-645.77 973.67,-652.4 979.61,-656.11"/>
</g>
<!-- proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node25" class="node">
<title>proc~reverse</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node25"><a xlink:href="../proc/reverse.html" xlink:title="reverse">
<polygon fill="#d94e8f" stroke="#d94e8f" points="651.5,-415.63 597.5,-415.63 597.5,-391.63 651.5,-391.63 651.5,-415.63"/>
<text text-anchor="middle" x="624.5" y="-401.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reverse</text>
</a>
</g>
</g>
<!-- none~init_shared_variables&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge17" class="edge">
<title>none~init_shared_variables&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M354.66,-953.57C376.01,-945.56 399.51,-932.71 413,-912.63 468.95,-829.36 387.31,-541.74 449,-462.63 482.02,-420.29 546.78,-408.11 587.45,-404.74"/>
<polygon fill="#000000" stroke="#000000" points="587.75,-408.22 597.48,-404.04 587.26,-401.24 587.75,-408.22"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge19" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M346.37,-752.78C367.15,-760.39 392.66,-771.45 413,-785.63 432.09,-798.93 428.37,-812.88 449,-823.63 484.23,-841.98 528.56,-848.41 563.71,-850.29"/>
<polygon fill="#000000" stroke="#000000" points="563.7,-853.79 573.84,-850.72 564,-846.79 563.7,-853.79"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge18" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M318.77,-728.35C338.54,-705.56 381.47,-654.82 413,-608.63 430.97,-582.31 422.39,-564.15 449,-546.63 483.94,-523.62 531.51,-519.23 568.16,-520.12"/>
<polygon fill="#000000" stroke="#000000" points="568.06,-523.62 578.19,-520.5 568.32,-516.63 568.06,-523.62"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge20" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M336.8,-752.72C364.86,-763.8 409.01,-779.4 449,-785.63 603.14,-809.63 652.83,-837.36 800,-785.63 875.51,-759.08 943.21,-688.36 973.18,-653.55"/>
<polygon fill="#000000" stroke="#000000" points="975.86,-655.8 979.65,-645.91 970.51,-651.28 975.86,-655.8"/>
</g>
<!-- proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node20" class="node">
<title>proc~dyn_mpas_exchange_halo</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node20"><a xlink:href="../proc/dyn_mpas_exchange_halo.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_exchange_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="1145,-313.63 836,-313.63 836,-289.63 1145,-289.63 1145,-313.63"/>
<text text-anchor="middle" x="990.5" y="-299.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_exchange_halo</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge21" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M377.4,-752.68C497.17,-771.82 736.02,-802.23 800,-752.63 850.77,-713.26 813.66,-672.87 836,-612.63 878.2,-498.83 949.1,-371.44 977.35,-322.4"/>
<polygon fill="#000000" stroke="#000000" points="980.43,-324.07 982.41,-313.66 974.37,-320.56 980.43,-324.07"/>
</g>
<!-- proc~p_by_hypsometric_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node23" class="node">
<title>proc~p_by_hypsometric_equation</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node23"><a xlink:href="../proc/p_by_hypsometric_equation.html" xlink:title="p_by_hypsometric_equation">
<polygon fill="#d94e8f" stroke="#d94e8f" points="705,-701.63 544,-701.63 544,-677.63 705,-677.63 705,-701.63"/>
<text text-anchor="middle" x="624.5" y="-687.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_by_hypsometric_equation</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~p_by_hypsometric_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge22" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~p_by_hypsometric_equation</title>
<path fill="none" stroke="#000000" d="M359.03,-728.61C385.72,-722.62 419,-715.61 449,-710.63 476.36,-706.08 506.29,-702.11 533.51,-698.89"/>
<polygon fill="#000000" stroke="#000000" points="534.27,-702.33 543.8,-697.69 533.46,-695.37 534.27,-702.33"/>
</g>
<!-- proc~rho_by_equation_of_state -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node26" class="node">
<title>proc~rho_by_equation_of_state</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node26"><a xlink:href="../proc/rho_by_equation_of_state.html" xlink:title="rho_by_equation_of_state">
<polygon fill="#d94e8f" stroke="#d94e8f" points="698.5,-659.63 550.5,-659.63 550.5,-635.63 698.5,-635.63 698.5,-659.63"/>
<text text-anchor="middle" x="624.5" y="-645.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rho_by_equation_of_state</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~rho_by_equation_of_state -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge23" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~rho_by_equation_of_state</title>
<path fill="none" stroke="#000000" d="M326.26,-728.62C352.31,-712.13 402.2,-682.9 449,-668.63 477.98,-659.79 510.73,-654.65 539.97,-651.67"/>
<polygon fill="#000000" stroke="#000000" points="540.53,-655.13 550.15,-650.7 539.87,-648.16 540.53,-655.13"/>
</g>
<!-- proc~theta_by_poisson_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node27" class="node">
<title>proc~theta_by_poisson_equation</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node27"><a xlink:href="../proc/theta_by_poisson_equation.html" xlink:title="theta_by_poisson_equation">
<polygon fill="#d94e8f" stroke="#d94e8f" points="703,-743.63 546,-743.63 546,-719.63 703,-719.63 703,-743.63"/>
<text text-anchor="middle" x="624.5" y="-729.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">theta_by_poisson_equation</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~theta_by_poisson_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge24" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~theta_by_poisson_equation</title>
<path fill="none" stroke="#000000" d="M413.06,-737.63C452.88,-736.49 497.76,-735.21 535.82,-734.13"/>
<polygon fill="#000000" stroke="#000000" points="535.95,-737.63 545.85,-733.84 535.75,-730.63 535.95,-737.63"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge27" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M316.01,-599.69C335.82,-628.82 389.79,-704.2 449,-752.63 491.61,-787.47 548.51,-816.42 585.57,-833.37"/>
<polygon fill="#000000" stroke="#000000" points="584.45,-836.7 595,-837.62 587.32,-830.32 584.45,-836.7"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge25" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M343.53,-575.55C371.8,-566.36 412.53,-554.07 449,-546.63 488.42,-538.58 533.53,-533.25 568.01,-529.98"/>
<polygon fill="#000000" stroke="#000000" points="568.71,-533.43 578.35,-529.02 568.07,-526.45 568.71,-533.43"/>
</g>
<!-- dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node15" class="node">
<title>dyn_set_inic_col</title>
<polygon fill="#777777" stroke="#777777" points="673.5,-335.63 575.5,-335.63 575.5,-311.63 673.5,-311.63 673.5,-335.63"/>
<text text-anchor="middle" x="624.5" y="-321.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_set_inic_col</text>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge26" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;dyn_set_inic_col</title>
<path fill="none" stroke="#000000" d="M315.7,-575.5C342.4,-533.6 430.35,-396.72 449,-382.63 483.05,-356.9 529.02,-341.96 565.23,-333.55"/>
<polygon fill="#000000" stroke="#000000" points="566.16,-336.93 575.17,-331.35 564.64,-330.1 566.16,-336.93"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge28" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M382.56,-592.66C492.26,-600.06 699.43,-614.05 840.92,-623.6"/>
<polygon fill="#000000" stroke="#000000" points="840.78,-627.1 851,-624.28 841.25,-620.11 840.78,-627.1"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge29" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M317.31,-575.32C337.81,-549.28 389.77,-488.84 449,-462.63 592.49,-399.14 652.16,-477.22 800,-424.63 867.45,-400.63 935.05,-348.32 968.3,-320.28"/>
<polygon fill="#000000" stroke="#000000" points="970.67,-322.86 975.99,-313.7 966.12,-317.54 970.67,-322.86"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~p_by_hypsometric_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge30" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~p_by_hypsometric_equation</title>
<path fill="none" stroke="#000000" d="M323.9,-599.66C348.99,-617.95 399.97,-652.35 449,-668.63 475.82,-677.53 506.08,-682.74 533.77,-685.77"/>
<polygon fill="#000000" stroke="#000000" points="533.55,-689.26 543.85,-686.79 534.25,-682.3 533.55,-689.26"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge31" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M314.66,-575.58C332.16,-545.21 382.68,-465.43 449,-429.63 492.3,-406.25 549.97,-401.97 586.92,-402.03"/>
<polygon fill="#000000" stroke="#000000" points="587.19,-405.54 597.23,-402.16 587.27,-398.54 587.19,-405.54"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~rho_by_equation_of_state -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge32" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~rho_by_equation_of_state</title>
<path fill="none" stroke="#000000" d="M353.5,-599.68C381.01,-606.7 416.87,-615.37 449,-621.63 478.58,-627.39 511.21,-632.56 540.16,-636.75"/>
<polygon fill="#000000" stroke="#000000" points="539.84,-640.24 550.24,-638.19 540.83,-633.31 539.84,-640.24"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~theta_by_poisson_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge33" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~theta_by_poisson_equation</title>
<path fill="none" stroke="#000000" d="M317.38,-599.68C338.02,-625.2 390.23,-684.49 449,-710.63 475.81,-722.55 507.1,-728.48 535.72,-731.24"/>
<polygon fill="#000000" stroke="#000000" points="535.46,-734.73 545.72,-732.08 536.05,-727.75 535.46,-734.73"/>
</g>
<!-- proc~tm_of_t_qv -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node28" class="node">
<title>proc~tm_of_t_qv</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node28"><a xlink:href="../proc/tm_of_t_qv.html" xlink:title="tm_of_t_qv">
<polygon fill="#d94e8f" stroke="#d94e8f" points="659.5,-579.63 589.5,-579.63 589.5,-555.63 659.5,-555.63 659.5,-579.63"/>
<text text-anchor="middle" x="624.5" y="-565.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tm_of_t_qv</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~tm_of_t_qv -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge34" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~tm_of_t_qv</title>
<path fill="none" stroke="#000000" d="M382.77,-582.89C443.97,-579.01 528.47,-573.65 579.36,-570.43"/>
<polygon fill="#000000" stroke="#000000" points="579.62,-573.92 589.38,-569.79 579.18,-566.93 579.62,-573.92"/>
</g>
<!-- proc~tv_of_tm_qv -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node29" class="node">
<title>proc~tv_of_tm_qv</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node29"><a xlink:href="../proc/tv_of_tm_qv.html" xlink:title="tv_of_tm_qv">
<polygon fill="#d94e8f" stroke="#d94e8f" points="662.5,-495.63 586.5,-495.63 586.5,-471.63 662.5,-471.63 662.5,-495.63"/>
<text text-anchor="middle" x="624.5" y="-481.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tv_of_tm_qv</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~tv_of_tm_qv -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge35" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~tv_of_tm_qv</title>
<path fill="none" stroke="#000000" d="M323.44,-575.6C348.31,-556.92 399.49,-521.36 449,-504.63 490.57,-490.58 540.5,-485.69 576.28,-484.1"/>
<polygon fill="#000000" stroke="#000000" points="576.58,-487.59 586.44,-483.72 576.32,-480.59 576.58,-487.59"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge39" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M327.94,-295.83C352.67,-312.18 393.92,-343.71 413,-382.63 485.74,-530.97 358.42,-614.45 449,-752.63 476.47,-794.54 528.57,-820.05 568.72,-834.32"/>
<polygon fill="#000000" stroke="#000000" points="567.79,-837.7 578.39,-837.62 570.05,-831.07 567.79,-837.7"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge36" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M325.99,-295.87C349.41,-312.72 390.05,-345.27 413,-382.63 442.59,-430.8 405.83,-468.13 449,-504.63 481.48,-532.09 530.33,-535.87 568.09,-533.62"/>
<polygon fill="#000000" stroke="#000000" points="568.71,-537.08 578.42,-532.84 568.18,-530.1 568.71,-537.08"/>
</g>
<!-- const_is_advected -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node14" class="node">
<title>const_is_advected</title>
<polygon fill="#777777" stroke="#777777" points="679,-87.63 570,-87.63 570,-63.63 679,-63.63 679,-87.63"/>
<text text-anchor="middle" x="624.5" y="-73.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">const_is_advected</text>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;const_is_advected -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge37" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;const_is_advected</title>
<path fill="none" stroke="#000000" d="M313.07,-271.32C327.98,-236.83 375.35,-139.02 449,-96.63 482.22,-77.51 524.84,-72.1 559.65,-71.54"/>
<polygon fill="#000000" stroke="#000000" points="559.73,-75.04 569.72,-71.51 559.71,-68.04 559.73,-75.04"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge38" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;dyn_set_inic_col</title>
<path fill="none" stroke="#000000" d="M375.68,-292.21C432.16,-299.37 511.79,-309.46 565.41,-316.26"/>
<polygon fill="#000000" stroke="#000000" points="565.08,-319.75 575.44,-317.53 565.96,-312.8 565.08,-319.75"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge40" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M375.86,-278.34C493.8,-270.44 730.64,-260.6 800,-302.63 918.34,-374.32 969.74,-549.5 984.64,-611.46"/>
<polygon fill="#000000" stroke="#000000" points="981.27,-612.4 986.94,-621.35 988.09,-610.82 981.27,-612.4"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge41" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M311.02,-271.38C321.66,-231.23 361.57,-103.47 449,-54.63 585.19,21.45 660.09,14.38 800,-54.63 898.18,-103.05 959.63,-229.47 981.01,-280.15"/>
<polygon fill="#000000" stroke="#000000" points="977.81,-281.58 984.85,-289.5 984.28,-278.92 977.81,-281.58"/>
</g>
<!-- proc~dyn_mpas_get_constituent_name -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node21" class="node">
<title>proc~dyn_mpas_get_constituent_name</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node21"><a xlink:href="../proc/dyn_mpas_get_constituent_name.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_constituent_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="797.5,-213.63 451.5,-213.63 451.5,-189.63 797.5,-189.63 797.5,-213.63"/>
<text text-anchor="middle" x="624.5" y="-199.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_constituent_name</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_get_constituent_name -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge42" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_get_constituent_name</title>
<path fill="none" stroke="#000000" d="M330.23,-271.61C357.41,-257.48 405.23,-234.46 449,-222.63 458.93,-219.94 469.28,-217.6 479.75,-215.56"/>
<polygon fill="#000000" stroke="#000000" points="480.63,-218.95 489.83,-213.69 479.36,-212.07 480.63,-218.95"/>
</g>
<!-- proc~dyn_mpas_map_constituent_index -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node22" class="node">
<title>proc~dyn_mpas_map_constituent_index</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node22"><a xlink:href="../proc/dyn_mpas_map_constituent_index.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_map_constituent_index">
<polygon fill="#d94e8f" stroke="#d94e8f" points="800,-171.63 449,-171.63 449,-147.63 800,-147.63 800,-171.63"/>
<text text-anchor="middle" x="624.5" y="-157.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_map_constituent_index</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_map_constituent_index -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge43" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_map_constituent_index</title>
<path fill="none" stroke="#000000" d="M319.88,-271.53C342.61,-249.23 394.85,-201.96 449,-180.63 454.78,-178.35 460.74,-176.31 466.81,-174.47"/>
<polygon fill="#000000" stroke="#000000" points="467.78,-177.83 476.45,-171.74 465.88,-171.09 467.78,-177.83"/>
</g>
<!-- proc~qv_of_sh -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node24" class="node">
<title>proc~qv_of_sh</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node24"><a xlink:href="../proc/qv_of_sh.html" xlink:title="qv_of_sh">
<polygon fill="#d94e8f" stroke="#d94e8f" points="653.5,-129.63 595.5,-129.63 595.5,-105.63 653.5,-105.63 653.5,-129.63"/>
<text text-anchor="middle" x="624.5" y="-115.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qv_of_sh</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~qv_of_sh -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge44" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~qv_of_sh</title>
<path fill="none" stroke="#000000" d="M315.41,-271.62C333.89,-242.89 385.12,-170.24 449,-138.63 492.06,-117.32 548.17,-114.28 584.98,-115.09"/>
<polygon fill="#000000" stroke="#000000" points="585.17,-118.6 595.28,-115.43 585.41,-111.61 585.17,-118.6"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge45" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M333.98,-295.63C362.07,-308.43 408.3,-328.97 449,-344.63 496.27,-362.81 551.84,-381.07 587.34,-392.36"/>
<polygon fill="#000000" stroke="#000000" points="586.65,-395.81 597.24,-395.49 588.77,-389.14 586.65,-395.81"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge48" class="edge">
<title>none~set_mpas_state_u&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M318.22,-415.8C339.43,-441.74 388.3,-505.09 413,-566.63 444.37,-644.77 399.58,-684.46 449,-752.63 478.88,-793.85 531.93,-819.7 571.71,-834.25"/>
<polygon fill="#000000" stroke="#000000" points="570.66,-837.59 581.26,-837.62 572.99,-830.99 570.66,-837.59"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge46" class="edge">
<title>none~set_mpas_state_u&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M320.29,-415.83C343.29,-437.83 395.39,-483.79 449,-504.63 487.05,-519.42 532.99,-524.48 568.18,-525.95"/>
<polygon fill="#000000" stroke="#000000" points="568.16,-529.45 578.27,-526.29 568.39,-522.45 568.16,-529.45"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge47" class="edge">
<title>none~set_mpas_state_u&#45;&gt;dyn_set_inic_col</title>
<path fill="none" stroke="#000000" d="M334.2,-391.61C362.09,-379.29 407.8,-360.45 449,-349.63 486.99,-339.65 530.7,-333.14 564.88,-329.14"/>
<polygon fill="#000000" stroke="#000000" points="565.62,-332.57 575.16,-327.97 564.83,-325.62 565.62,-332.57"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge49" class="edge">
<title>none~set_mpas_state_u&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M360.02,-394C386.55,-389.57 419.38,-384.82 449,-382.63 604.57,-371.11 660.36,-313.08 800,-382.63 899.22,-432.04 960.25,-560.93 981.26,-612.17"/>
<polygon fill="#000000" stroke="#000000" points="978.07,-613.62 985.03,-621.6 984.57,-611.02 978.07,-613.62"/>
</g>
<!-- proc~dyn_mpas_compute_edge_wind -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node19" class="node">
<title>proc~dyn_mpas_compute_edge_wind</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node19"><a xlink:href="../proc/dyn_mpas_compute_edge_wind.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_compute_edge_wind">
<polygon fill="#d9534f" stroke="#d9534f" points="793.5,-255.63 455.5,-255.63 455.5,-231.63 793.5,-231.63 793.5,-255.63"/>
<text text-anchor="middle" x="624.5" y="-241.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_compute_edge_wind</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_u&#45;&gt;proc~dyn_mpas_compute_edge_wind -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge50" class="edge">
<title>none~set_mpas_state_u&#45;&gt;proc~dyn_mpas_compute_edge_wind</title>
<path fill="none" stroke="#000000" d="M321.9,-391.5C346.2,-370.82 398.63,-328.46 449,-302.63 486.17,-283.57 530.83,-268.6 565.67,-258.51"/>
<polygon fill="#000000" stroke="#000000" points="567.02,-261.76 575.68,-255.66 565.1,-255.03 567.02,-261.76"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge51" class="edge">
<title>none~set_mpas_state_u&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M360.1,-403.63C424.22,-403.63 531.46,-403.63 587.26,-403.63"/>
<polygon fill="#000000" stroke="#000000" points="587.39,-407.13 597.39,-403.63 587.39,-400.13 587.39,-407.13"/>
</g>
<!-- none~set_mpas_state_w&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge52" class="edge">
<title>none~set_mpas_state_w&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M361.16,-849.63C417.16,-849.63 505.15,-849.63 563.58,-849.63"/>
<polygon fill="#000000" stroke="#000000" points="563.77,-853.13 573.77,-849.63 563.77,-846.13 563.77,-853.13"/>
</g>
<!-- none~set_mpas_state_w&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge53" class="edge">
<title>none~set_mpas_state_w&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M361.13,-854.52C378.34,-857.58 397.09,-862.55 413,-870.63 432.35,-880.45 428.77,-895.76 449,-903.63 521.69,-931.9 730.79,-939.61 800,-903.63 853.08,-876.03 945.73,-713.66 978.01,-654.87"/>
<polygon fill="#000000" stroke="#000000" points="981.27,-656.21 982.99,-645.75 975.13,-652.85 981.27,-656.21"/>
</g>
<!-- none~set_mpas_state_w&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge54" class="edge">
<title>none~set_mpas_state_w&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M361.2,-860.68C474.78,-882.91 735.91,-926.4 800,-870.63 843.67,-832.63 818.97,-667.96 836,-612.63 871.62,-496.9 945.99,-371.09 976.26,-322.44"/>
<polygon fill="#000000" stroke="#000000" points="979.35,-324.1 981.7,-313.76 973.42,-320.38 979.35,-324.1"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node34" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node34"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0">
<polygon fill="#d9534f" stroke="#d9534f" points="1537,-498.63 1181,-498.63 1181,-474.63 1537,-474.63 1537,-498.63"/>
<text text-anchor="middle" x="1359" y="-484.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge55" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1004.97,-621.31C1034.37,-595.24 1107.58,-534.63 1181,-507.63 1187.44,-505.26 1194.09,-503.14 1200.87,-501.25"/>
<polygon fill="#000000" stroke="#000000" points="1202.09,-504.55 1210.88,-498.65 1200.32,-497.78 1202.09,-504.55"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node35" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c1</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node35"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1">
<polygon fill="#d9534f" stroke="#d9534f" points="1537,-540.63 1181,-540.63 1181,-516.63 1537,-516.63 1537,-540.63"/>
<text text-anchor="middle" x="1359" y="-526.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge56" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.88,-621.59C1047.18,-602.87 1117.14,-567.14 1181,-549.63 1190.84,-546.93 1201.08,-544.58 1211.45,-542.53"/>
<polygon fill="#000000" stroke="#000000" points="1212.25,-545.94 1221.43,-540.66 1210.95,-539.06 1212.25,-545.94"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node36" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node36"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-582.63 1182.5,-582.63 1182.5,-558.63 1535.5,-558.63 1535.5,-582.63"/>
<text text-anchor="middle" x="1359" y="-568.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge57" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1039.53,-621.59C1077.68,-612.36 1132.49,-599.86 1181,-591.63 1197.58,-588.81 1215.09,-586.25 1232.4,-583.95"/>
<polygon fill="#000000" stroke="#000000" points="1233.09,-587.39 1242.55,-582.63 1232.19,-580.45 1233.09,-587.39"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node37" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i1</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node37"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-918.63 1182.5,-918.63 1182.5,-894.63 1535.5,-894.63 1535.5,-918.63"/>
<text text-anchor="middle" x="1359" y="-904.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge58" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M996.43,-645.84C1014.06,-687.8 1078.51,-826.67 1181,-885.63 1183.95,-887.32 1186.97,-888.92 1190.06,-890.4"/>
<polygon fill="#000000" stroke="#000000" points="1188.93,-893.73 1199.49,-894.58 1191.76,-887.33 1188.93,-893.73"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node38" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i2</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node38"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-876.63 1182.5,-876.63 1182.5,-852.63 1535.5,-852.63 1535.5,-876.63"/>
<text text-anchor="middle" x="1359" y="-862.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge59" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M998.17,-645.87C1019.26,-683.17 1088.53,-795.79 1181,-843.63 1184.61,-845.49 1188.31,-847.22 1192.09,-848.83"/>
<polygon fill="#000000" stroke="#000000" points="1191.04,-852.17 1201.63,-852.55 1193.59,-845.65 1191.04,-852.17"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node39" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i3</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node39"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-834.63 1182.5,-834.63 1182.5,-810.63 1535.5,-810.63 1535.5,-834.63"/>
<text text-anchor="middle" x="1359" y="-820.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge60" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1000.54,-645.64C1025.31,-677.52 1097.96,-764.37 1181,-801.63 1185.53,-803.66 1190.18,-805.52 1194.93,-807.22"/>
<polygon fill="#000000" stroke="#000000" points="1194.2,-810.66 1204.79,-810.49 1196.4,-804.02 1194.2,-810.66"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node40" class="node">
<title>proc~dyn_mpas_get_variable_pointer_l0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node40"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_l0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-414.63 1182.5,-414.63 1182.5,-390.63 1535.5,-390.63 1535.5,-414.63"/>
<text text-anchor="middle" x="1359" y="-400.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge61" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M998.17,-621.39C1019.26,-584.09 1088.53,-471.46 1181,-423.63 1184.61,-421.76 1188.31,-420.03 1192.09,-418.43"/>
<polygon fill="#000000" stroke="#000000" points="1193.59,-421.6 1201.63,-414.7 1191.04,-415.08 1193.59,-421.6"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node41" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node41"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-456.63 1181.5,-456.63 1181.5,-432.63 1536.5,-432.63 1536.5,-456.63"/>
<text text-anchor="middle" x="1359" y="-442.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge62" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1000.54,-621.61C1025.31,-589.73 1097.96,-502.88 1181,-465.63 1185.53,-463.6 1190.18,-461.74 1194.93,-460.04"/>
<polygon fill="#000000" stroke="#000000" points="1196.4,-463.24 1204.79,-456.77 1194.2,-456.59 1196.4,-463.24"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node42" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r1</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node42"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-792.63 1181.5,-792.63 1181.5,-768.63 1536.5,-768.63 1536.5,-792.63"/>
<text text-anchor="middle" x="1359" y="-778.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge63" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1004.97,-645.94C1034.37,-672.02 1107.58,-732.62 1181,-759.63 1187.44,-762 1194.09,-764.11 1200.87,-766"/>
<polygon fill="#000000" stroke="#000000" points="1200.32,-769.47 1210.88,-768.61 1202.09,-762.7 1200.32,-769.47"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node43" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r2</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node43"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-750.63 1181.5,-750.63 1181.5,-726.63 1536.5,-726.63 1536.5,-750.63"/>
<text text-anchor="middle" x="1359" y="-736.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge64" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.88,-645.67C1047.18,-664.38 1117.14,-700.11 1181,-717.63 1190.84,-720.33 1201.08,-722.68 1211.45,-724.73"/>
<polygon fill="#000000" stroke="#000000" points="1210.95,-728.19 1221.43,-726.6 1212.25,-721.31 1210.95,-728.19"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node44" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r3</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node44"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-708.63 1181.5,-708.63 1181.5,-684.63 1536.5,-684.63 1536.5,-708.63"/>
<text text-anchor="middle" x="1359" y="-694.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge65" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1039.53,-645.67C1077.68,-654.89 1132.49,-667.4 1181,-675.63 1197.58,-678.44 1215.09,-681.01 1232.4,-683.3"/>
<polygon fill="#000000" stroke="#000000" points="1232.19,-686.8 1242.55,-684.62 1233.09,-679.86 1232.19,-686.8"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node45" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r4</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node45"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r4.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-666.63 1181.5,-666.63 1181.5,-642.63 1536.5,-642.63 1536.5,-666.63"/>
<text text-anchor="middle" x="1359" y="-652.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge66" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1130.06,-641.57C1143.52,-642.34 1157.31,-643.13 1171.14,-643.92"/>
<polygon fill="#000000" stroke="#000000" points="1171.03,-647.42 1181.21,-644.5 1171.43,-640.43 1171.03,-647.42"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node46" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r5</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node46"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r5.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-624.63 1181.5,-624.63 1181.5,-600.63 1536.5,-600.63 1536.5,-624.63"/>
<text text-anchor="middle" x="1359" y="-610.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge67" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1130.06,-625.69C1143.52,-624.92 1157.31,-624.13 1171.14,-623.33"/>
<polygon fill="#000000" stroke="#000000" points="1171.43,-626.82 1181.21,-622.76 1171.03,-619.84 1171.43,-626.82"/>
</g>
<!-- stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node48" class="node">
<title>stringify</title>
<polygon fill="#777777" stroke="#777777" points="1386.5,-960.63 1331.5,-960.63 1331.5,-936.63 1386.5,-936.63 1386.5,-960.63"/>
<text text-anchor="middle" x="1359" y="-946.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</g>
<!-- proc~dyn_debug_print&#45;&gt;stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge68" class="edge">
<title>proc~dyn_debug_print&#45;&gt;stringify</title>
<path fill="none" stroke="#000000" d="M1041.31,-906.72C1079.49,-912.81 1133.51,-921.18 1181,-927.63 1229.42,-934.2 1285.45,-940.66 1321.28,-944.64"/>
<polygon fill="#000000" stroke="#000000" points="1320.95,-948.12 1331.28,-945.74 1321.72,-941.16 1320.95,-948.12"/>
</g>
<!-- proc~dyn_mpas_compute_edge_wind&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge69" class="edge">
<title>proc~dyn_mpas_compute_edge_wind&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M775.03,-255.8C783.85,-259.56 792.27,-264.12 800,-269.63 815.79,-280.88 941.79,-536.28 979.12,-612.4"/>
<polygon fill="#000000" stroke="#000000" points="976.05,-614.09 983.59,-621.53 982.33,-611.01 976.05,-614.09"/>
</g>
<!-- proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge71" class="edge">
<title>proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M708.54,-255.66C737.5,-259.95 770.2,-264.89 800,-269.63 836.29,-275.39 876.43,-282.12 910.38,-287.92"/>
<polygon fill="#000000" stroke="#000000" points="909.8,-291.37 920.25,-289.6 910.98,-284.47 909.8,-291.37"/>
</g>
<!-- proc~dyn_mpas_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node33" class="node">
<title>proc~dyn_mpas_debug_print</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node33"><a xlink:href="../proc/dyn_mpas_debug_print.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="1505,-208.63 1213,-208.63 1213,-184.63 1505,-184.63 1505,-208.63"/>
<text text-anchor="middle" x="1359" y="-194.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_debug_print</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge70" class="edge">
<title>proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_debug_print</title>
<path fill="none" stroke="#000000" d="M793.55,-232.84C916.8,-224.94 1082.9,-214.28 1202.98,-206.57"/>
<polygon fill="#000000" stroke="#000000" points="1203.24,-210.06 1212.99,-205.93 1202.79,-203.08 1203.24,-210.06"/>
</g>
<!-- mpas_dmpar_exch_halo_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node30" class="node">
<title>mpas_dmpar_exch_halo_field</title>
<polygon fill="#777777" stroke="#777777" points="1443.5,-292.63 1274.5,-292.63 1274.5,-268.63 1443.5,-268.63 1443.5,-292.63"/>
<text text-anchor="middle" x="1359" y="-278.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dmpar_exch_halo_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge72" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field</title>
<path fill="none" stroke="#000000" d="M1145.07,-292.83C1185.56,-290.51 1228.05,-288.07 1264.32,-286"/>
<polygon fill="#000000" stroke="#000000" points="1264.59,-289.49 1274.38,-285.42 1264.19,-282.5 1264.59,-289.49"/>
</g>
<!-- mpas_pool_get_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node31" class="node">
<title>mpas_pool_get_field</title>
<polygon fill="#777777" stroke="#777777" points="1419.5,-250.63 1298.5,-250.63 1298.5,-226.63 1419.5,-226.63 1419.5,-250.63"/>
<text text-anchor="middle" x="1359" y="-236.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge73" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field</title>
<path fill="none" stroke="#000000" d="M1039.53,-289.59C1077.68,-280.36 1132.49,-267.86 1181,-259.63 1216.1,-253.67 1255.4,-248.83 1288.04,-245.3"/>
<polygon fill="#000000" stroke="#000000" points="1288.81,-248.74 1298.38,-244.2 1288.07,-241.78 1288.81,-248.74"/>
</g>
<!-- mpas_pool_get_field_info -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node32" class="node">
<title>mpas_pool_get_field_info</title>
<polygon fill="#777777" stroke="#777777" points="1432.5,-334.63 1285.5,-334.63 1285.5,-310.63 1432.5,-310.63 1432.5,-334.63"/>
<text text-anchor="middle" x="1359" y="-320.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field_info</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge74" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info</title>
<path fill="none" stroke="#000000" d="M1145.07,-310.43C1189.7,-312.98 1236.73,-315.68 1275.22,-317.88"/>
<polygon fill="#000000" stroke="#000000" points="1275.14,-321.39 1285.32,-318.46 1275.54,-314.4 1275.14,-321.39"/>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge75" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print</title>
<path fill="none" stroke="#000000" d="M1018.37,-289.46C1068.64,-266.74 1172.61,-219.93 1181,-217.63 1190.84,-214.93 1201.08,-212.58 1211.45,-210.53"/>
<polygon fill="#000000" stroke="#000000" points="1212.25,-213.94 1221.43,-208.66 1210.95,-207.06 1212.25,-213.94"/>
</g>
<!-- proc~stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node47" class="node">
<title>proc~stringify</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node47"><a xlink:href="../proc/stringify.html" xlink:title="stringify">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1759.5,-291.63 1704.5,-291.63 1704.5,-267.63 1759.5,-267.63 1759.5,-291.63"/>
<text text-anchor="middle" x="1732" y="-277.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge76" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1033.58,-313.73C1071.69,-324.02 1129.58,-338 1181,-343.63 1338.28,-360.85 1380.78,-368.73 1537,-343.63 1593.73,-334.51 1656.36,-311.3 1694.7,-295.48"/>
<polygon fill="#000000" stroke="#000000" points="1696.5,-298.53 1704.37,-291.44 1693.8,-292.07 1696.5,-298.53"/>
</g>
<!-- proc~dyn_mpas_debug_print&#45;&gt;proc~stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge77" class="edge">
<title>proc~dyn_mpas_debug_print&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1486.67,-208.67C1503.67,-211.16 1520.82,-214.12 1537,-217.63 1593.14,-229.81 1656.17,-251.51 1694.72,-265.73"/>
<polygon fill="#000000" stroke="#000000" points="1693.86,-269.14 1704.45,-269.35 1696.3,-262.58 1693.86,-269.14"/>
</g>
<!-- mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node49" class="node">
<title>mpas_pool_get_array</title>
<polygon fill="#777777" stroke="#777777" points="1795.5,-708.63 1668.5,-708.63 1668.5,-684.63 1795.5,-684.63 1795.5,-708.63"/>
<text text-anchor="middle" x="1732" y="-694.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_array</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge78" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1525.74,-498.85C1529.69,-501.48 1533.45,-504.4 1537,-507.63 1593.45,-559.05 1516.92,-623.8 1573,-675.63 1595.64,-696.55 1628.5,-703.24 1658.39,-704.12"/>
<polygon fill="#000000" stroke="#000000" points="1658.37,-707.62 1668.4,-704.21 1658.43,-700.62 1658.37,-707.62"/>
</g>
<!-- mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node50" class="node">
<title>mpas_pool_get_config</title>
<polygon fill="#777777" stroke="#777777" points="1797.5,-477.63 1666.5,-477.63 1666.5,-453.63 1797.5,-453.63 1797.5,-477.63"/>
<text text-anchor="middle" x="1732" y="-463.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_config</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge79" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1537.08,-476.6C1579.17,-474.22 1621.84,-471.81 1656.39,-469.85"/>
<polygon fill="#000000" stroke="#000000" points="1656.59,-473.34 1666.38,-469.29 1656.2,-466.36 1656.59,-473.34"/>
</g>
<!-- proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node52" class="node">
<title>proc~dyn_mpas_get_pool_pointer</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node52"><a xlink:href="../proc/dyn_mpas_get_pool_pointer.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_pool_pointer">
<polygon fill="#d9534f" stroke="#d9534f" points="1891,-666.63 1573,-666.63 1573,-642.63 1891,-642.63 1891,-666.63"/>
<text text-anchor="middle" x="1732" y="-652.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_pool_pointer</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge80" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1510.15,-498.71C1519.37,-501.21 1528.39,-504.16 1537,-507.63 1610.65,-537.32 1680.72,-602.64 1712.77,-635.28"/>
<polygon fill="#000000" stroke="#000000" points="1710.26,-637.71 1719.73,-642.46 1715.28,-632.84 1710.26,-637.71"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge81" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1524.68,-540.69C1528.99,-543.35 1533.11,-546.32 1537,-549.63 1581.35,-587.38 1528.92,-637.56 1573,-675.63 1596.04,-695.53 1628.47,-702.2 1657.95,-703.34"/>
<polygon fill="#000000" stroke="#000000" points="1658.17,-706.84 1668.23,-703.53 1658.3,-699.85 1658.17,-706.84"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge82" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1502.07,-540.64C1514.01,-543.11 1525.79,-546.07 1537,-549.63 1601.78,-570.17 1669.97,-612.69 1705.72,-636.84"/>
<polygon fill="#000000" stroke="#000000" points="1703.85,-639.81 1714.08,-642.56 1707.8,-634.03 1703.85,-639.81"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge83" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1522.93,-582.68C1527.83,-585.32 1532.54,-588.29 1537,-591.63 1569.53,-615.95 1540.64,-651.08 1573,-675.63 1596.96,-693.8 1629.05,-700.33 1658.06,-701.83"/>
<polygon fill="#000000" stroke="#000000" points="1658.06,-705.33 1668.17,-702.16 1658.29,-698.33 1658.06,-705.33"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge84" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1496.06,-558.57C1510,-556.12 1523.85,-553.17 1537,-549.63 1597.11,-533.42 1662.74,-501.81 1700.18,-482.33"/>
<polygon fill="#000000" stroke="#000000" points="1701.85,-485.4 1709.07,-477.65 1698.59,-479.21 1701.85,-485.4"/>
</g>
<!-- mpas_pool_get_dimension -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node51" class="node">
<title>mpas_pool_get_dimension</title>
<polygon fill="#777777" stroke="#777777" points="1809,-834.63 1655,-834.63 1655,-810.63 1809,-810.63 1809,-834.63"/>
<text text-anchor="middle" x="1732" y="-820.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_dimension</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge85" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1524.68,-582.69C1528.99,-585.35 1533.11,-588.32 1537,-591.63 1581.35,-629.38 1538.63,-670.61 1573,-717.63 1603.51,-759.36 1656.01,-789.39 1692.06,-806.38"/>
<polygon fill="#000000" stroke="#000000" points="1690.76,-809.63 1701.3,-810.62 1693.67,-803.27 1690.76,-809.63"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge86" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1487.16,-582.67C1504.01,-585.15 1520.98,-588.11 1537,-591.63 1591.37,-603.56 1652.11,-624.59 1690.9,-639.05"/>
<polygon fill="#000000" stroke="#000000" points="1689.68,-642.33 1700.27,-642.57 1692.14,-635.77 1689.68,-642.33"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge87" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1522.93,-894.57C1527.83,-891.93 1532.54,-888.96 1537,-885.63 1569.53,-861.31 1547,-832.83 1573,-801.63 1606.57,-761.32 1659.53,-730.53 1694.75,-713.01"/>
<polygon fill="#000000" stroke="#000000" points="1696.28,-716.16 1703.74,-708.63 1693.22,-709.86 1696.28,-716.16"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge88" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1487.16,-894.59C1504.01,-892.1 1520.98,-889.14 1537,-885.63 1591.37,-873.7 1652.11,-852.67 1690.9,-838.21"/>
<polygon fill="#000000" stroke="#000000" points="1692.14,-841.48 1700.27,-834.68 1689.68,-834.93 1692.14,-841.48"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge89" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1525.92,-894.59C1529.82,-891.91 1533.52,-888.93 1537,-885.63 1605.67,-820.42 1504.79,-741.31 1573,-675.63 1573.95,-674.71 1574.93,-673.82 1575.92,-672.95"/>
<polygon fill="#000000" stroke="#000000" points="1578.08,-675.71 1583.86,-666.83 1573.8,-670.17 1578.08,-675.71"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge90" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1516.92,-852.6C1523.85,-850.02 1530.58,-847.05 1537,-843.63 1558.69,-832.05 1554.59,-817.92 1573,-801.63 1613.47,-765.82 1666.97,-732.78 1700.17,-713.67"/>
<polygon fill="#000000" stroke="#000000" points="1702.01,-716.65 1708.97,-708.66 1698.54,-710.57 1702.01,-716.65"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge91" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1525.74,-852.4C1529.69,-849.77 1533.45,-846.86 1537,-843.63 1593.45,-792.2 1516.92,-727.45 1573,-675.63 1574,-674.7 1575.02,-673.81 1576.06,-672.94"/>
<polygon fill="#000000" stroke="#000000" points="1578.41,-675.55 1584.38,-666.79 1574.25,-669.92 1578.41,-675.55"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge92" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1502.07,-810.61C1514.01,-808.14 1525.79,-805.18 1537,-801.63 1601.78,-781.08 1669.97,-738.57 1705.72,-714.41"/>
<polygon fill="#000000" stroke="#000000" points="1707.8,-717.22 1714.08,-708.69 1703.85,-711.45 1707.8,-717.22"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge93" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1524.68,-810.57C1528.99,-807.91 1533.11,-804.94 1537,-801.63 1581.35,-763.87 1528.92,-713.69 1573,-675.63 1574.33,-674.48 1575.7,-673.37 1577.09,-672.31"/>
<polygon fill="#000000" stroke="#000000" points="1579.06,-675.2 1585.36,-666.67 1575.12,-669.41 1579.06,-675.2"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge94" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1474.96,-414.65C1495.66,-417.28 1517.01,-420.29 1537,-423.63 1582.55,-431.24 1633.58,-442.4 1671.87,-451.3"/>
<polygon fill="#000000" stroke="#000000" points="1671.28,-454.75 1681.81,-453.62 1672.87,-447.94 1671.28,-454.75"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge95" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1521.19,-414.75C1526.68,-417.35 1531.97,-420.3 1537,-423.63 1563.89,-441.43 1553.82,-460.7 1573,-486.63 1616.47,-545.38 1678.27,-605.76 1710.17,-635.58"/>
<polygon fill="#000000" stroke="#000000" points="1707.89,-638.24 1717.6,-642.48 1712.66,-633.11 1707.89,-638.24"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge96" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1525.92,-456.66C1529.82,-459.34 1533.52,-462.32 1537,-465.63 1605.67,-530.83 1504.79,-609.94 1573,-675.63 1595.29,-697.1 1628.27,-703.82 1658.34,-704.57"/>
<polygon fill="#000000" stroke="#000000" points="1658.39,-708.07 1668.4,-704.61 1658.42,-701.07 1658.39,-708.07"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge97" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1536.54,-454.62C1578.7,-457.01 1621.48,-459.43 1656.14,-461.39"/>
<polygon fill="#000000" stroke="#000000" points="1655.98,-464.89 1666.16,-461.96 1656.38,-457.9 1655.98,-464.89"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge98" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1514.31,-456.63C1522.13,-459.18 1529.74,-462.16 1537,-465.63 1579.56,-485.94 1674.52,-590.44 1713.64,-634.74"/>
<polygon fill="#000000" stroke="#000000" points="1711.25,-637.32 1720.48,-642.52 1716.5,-632.7 1711.25,-637.32"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge99" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1487.16,-768.59C1504.01,-766.1 1520.98,-763.14 1537,-759.63 1591.37,-747.7 1652.11,-726.67 1690.9,-712.21"/>
<polygon fill="#000000" stroke="#000000" points="1692.14,-715.48 1700.27,-708.68 1689.68,-708.93 1692.14,-715.48"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge100" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1522.93,-768.57C1527.83,-765.93 1532.54,-762.96 1537,-759.63 1569.53,-735.31 1540.64,-700.18 1573,-675.63 1574.65,-674.37 1576.35,-673.17 1578.07,-672.03"/>
<polygon fill="#000000" stroke="#000000" points="1580.17,-674.85 1586.98,-666.73 1576.6,-668.83 1580.17,-674.85"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge101" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1466.31,-726.59C1527.89,-719.62 1603.81,-711.03 1658.52,-704.83"/>
<polygon fill="#000000" stroke="#000000" points="1658.94,-708.31 1668.49,-703.7 1658.15,-701.35 1658.94,-708.31"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge102" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1516.92,-726.6C1523.85,-724.02 1530.58,-721.05 1537,-717.63 1558.69,-706.05 1551.39,-687.35 1573,-675.63 1576.36,-673.8 1579.82,-672.12 1583.35,-670.56"/>
<polygon fill="#000000" stroke="#000000" points="1584.91,-673.7 1592.87,-666.71 1582.29,-667.21 1584.91,-673.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge103" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1536.54,-696.63C1579.55,-696.63 1623.21,-696.63 1658.23,-696.63"/>
<polygon fill="#000000" stroke="#000000" points="1658.34,-700.13 1668.34,-696.63 1658.34,-693.13 1658.34,-700.13"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge104" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1466.31,-684.59C1512.79,-679.33 1567.43,-673.14 1614.96,-667.76"/>
<polygon fill="#000000" stroke="#000000" points="1615.45,-671.23 1624.99,-666.63 1614.66,-664.28 1615.45,-671.23"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge105" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1466.31,-666.66C1527.89,-673.63 1603.81,-682.23 1658.52,-688.42"/>
<polygon fill="#000000" stroke="#000000" points="1658.15,-691.9 1668.49,-689.55 1658.94,-684.95 1658.15,-691.9"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge106" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1536.54,-654.63C1545.26,-654.63 1554.02,-654.63 1562.72,-654.63"/>
<polygon fill="#000000" stroke="#000000" points="1562.91,-658.13 1572.91,-654.63 1562.91,-651.13 1562.91,-658.13"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge107" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1516.92,-624.66C1523.85,-627.23 1530.58,-630.2 1537,-633.63 1558.69,-645.2 1551.39,-663.9 1573,-675.63 1598.67,-689.56 1630.03,-695.57 1658.02,-697.83"/>
<polygon fill="#000000" stroke="#000000" points="1657.96,-701.33 1668.17,-698.5 1658.42,-694.34 1657.96,-701.33"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge108" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1466.31,-624.66C1512.79,-629.92 1567.43,-636.11 1614.96,-641.49"/>
<polygon fill="#000000" stroke="#000000" points="1614.66,-644.98 1624.99,-642.63 1615.45,-638.02 1614.66,-644.98"/>
</g>
<!-- mpas_pool_get_subpool -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node53" class="node">
<title>mpas_pool_get_subpool</title>
<polygon fill="#777777" stroke="#777777" points="2067,-666.63 1927,-666.63 1927,-642.63 2067,-642.63 2067,-666.63"/>
<text text-anchor="middle" x="1997" y="-652.23" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_subpool</text>
</g>
<!-- proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge109" class="edge">
<title>proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool</title>
<path fill="none" stroke="#000000" d="M1891.3,-654.63C1899.94,-654.63 1908.43,-654.63 1916.59,-654.63"/>
<polygon fill="#000000" stroke="#000000" points="1916.75,-658.13 1926.75,-654.63 1916.75,-651.13 1916.75,-658.13"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocset_analytic_initial_conditionCallsGraph = svgPanZoom('#procset_analytic_initial_conditionCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Called by</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~set_analytic_initial_condition~~CalledByGraph Pages: 1 -->
<svg id="procset_analytic_initial_conditionCalledByGraph" width="353pt" height="32pt"
 viewBox="0.00 0.00 353.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~set_analytic_initial_condition~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~set_analytic_initial_condition~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 349,-28 349,4 -4,4"/>
<!-- proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_node1" class="node">
<title>proc~set_analytic_initial_condition</title>
<polygon fill="none" stroke="black" points="345,-24 180,-24 180,0 345,0 345,-24"/>
<text text-anchor="middle" x="262.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">set_analytic_initial_condition</text>
</g>
<!-- proc~dyn_init -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_node2" class="node">
<title>proc~dyn_init</title>
<g id="a_proc~~set_analytic_initial_condition~~CalledByGraph_node2"><a xlink:href="../proc/dyn_init.html" xlink:title="dyn_init">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_init</text>
</a>
</g>
</g>
<!-- proc~dyn_init&#45;&gt;proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_edge1" class="edge">
<title>proc~dyn_init&#45;&gt;proc~set_analytic_initial_condition</title>
<path fill="none" stroke="#000000" d="M144.32,-12C151.87,-12 160.55,-12 169.71,-12"/>
<polygon fill="#000000" stroke="#000000" points="169.8,-15.5 179.8,-12 169.8,-8.5 169.8,-15.5"/>
</g>
<!-- interface~dyn_init -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_node3" class="node">
<title>interface~dyn_init</title>
<g id="a_proc~~set_analytic_initial_condition~~CalledByGraph_node3"><a xlink:href="../interface/dyn_init.html" xlink:title="dyn_init">
<polygon fill="#a7506f" stroke="#a7506f" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_init</text>
</a>
</g>
</g>
<!-- interface~dyn_init&#45;&gt;proc~dyn_init -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_edge2" class="edge">
<title>interface~dyn_init&#45;&gt;proc~dyn_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M54.4,-12C62.39,-12 71.31,-12 79.82,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-15.5 89.92,-12 79.92,-8.5 79.92,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
      <br>


        <section>
          <h2>Variables</h2>
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-buffer_2d_real"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>buffer_2d_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-buffer_3d_real"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>buffer_3d_real</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-global_grid_index~2"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>global_grid_index</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lat_rad"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>lat_rad</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lon_rad"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>lon_rad</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-subname~55"></span>
              character(len=*),
            </td>
              <td>private,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>subname</strong></td>
<td> =</td>
                <td>&#39;dyn_comp::set_analytic_initial_condition&#39;</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z_int"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>z_int</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zgrid~2"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>zgrid</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

        </section>
        <br>






        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-final_shared_variables"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-final_shared_variables'>final_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Finalize variables that are shared and repeatedly used by the <code>set_mpas_state_*</code> internal subroutines.
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-init_shared_variables"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-init_shared_variables'>init_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Initialize variables that are shared and repeatedly used by the <code>set_mpas_state_*</code> internal subroutines.
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_rho_base_theta_base"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_rho_base_theta_base'>set_mpas_state_rho_base_theta_base</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>rho_base</code> (i.e., base state dry air density) and <code>theta_base</code> (i.e., base state potential temperature).
(KCW, 2024-05-21)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_rho_theta"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_rho_theta'>set_mpas_state_rho_theta</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>rho</code> (i.e., dry air density) and <code>theta</code> (i.e., potential temperature).
(KCW, 2024-05-19)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_scalars"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_scalars'>set_mpas_state_scalars</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>scalars</code> (i.e., constituents).
(KCW, 2024-05-17)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_u"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_u'>set_mpas_state_u</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>u</code> (i.e., horizontal velocity at edge interfaces).
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_w"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_w'>set_mpas_state_w</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>w</code> (i.e., vertical velocity at cell interfaces).
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

        </section>


        <section>
          <h2><span class="anchor" id="src"></span>Source Code</h2>
          <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">set_analytic_initial_condition</span><span class="p">()</span>
<span class="w">        </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">        </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_debug</span>
<span class="w">        </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">        </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">kind_r8</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_r8</span>

<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition&#39;</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">buffer_3d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">(:),</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">z_int</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">   </span><span class="c">! Geometric height (m) at layer interfaces.</span>
<span class="w">                                                    </span><span class="c">! Dimension and vertical index orders follow CAM-SIMA convention.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="c">! Geometric height (m) at layer interfaces.</span>
<span class="w">                                                    </span><span class="c">! Dimension and vertical index orders follow MPAS convention.</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; entered&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="k">call </span><span class="n">init_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_u</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_w</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_scalars</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_rho_theta</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_rho_base_theta_base</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">final_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; completed&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">contains</span>
<span class="w">        </span><span class="c">!&gt; Initialize variables that are shared and repeatedly used by the `set_mpas_state_*` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">init_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span><span class="p">,</span><span class="w"> </span><span class="n">endrun</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_grid_support</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_grid_get_latvals</span><span class="p">,</span><span class="w"> </span><span class="n">cam_grid_get_lonvals</span><span class="p">,</span><span class="w"> </span><span class="n">cam_grid_id</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">reverse</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">deg_to_rad</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pverp</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::init_shared_variables&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">indextocellid</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lat_deg</span><span class="p">(:),</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Preparing to set analytic initial condition&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">indextocellid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">,</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">global_grid_index</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;global_grid_index(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">indextocellid</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;indexToCellID&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="n">global_grid_index</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indextocellid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">indextocellid</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lat_rad(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">lon_rad</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lon_rad(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="c">! &quot;mpas_cell&quot; is a registered grid name that is defined in `dyn_grid`.</span>
<span class="w">            </span><span class="n">lat_deg</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_grid_get_latvals</span><span class="p">(</span><span class="n">cam_grid_id</span><span class="p">(</span><span class="s1">&#39;mpas_cell&#39;</span><span class="p">))</span>
<span class="w">            </span><span class="n">lon_deg</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_grid_get_lonvals</span><span class="p">(</span><span class="n">cam_grid_id</span><span class="p">(</span><span class="s1">&#39;mpas_cell&#39;</span><span class="p">))</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;lat_deg&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">lon_deg</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;lon_deg&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            </span><span class="n">lat_rad</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat_deg</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">deg_to_rad</span>
<span class="w">            </span><span class="n">lon_rad</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">deg_to_rad</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">,</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">z_int</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;z_int(ncells_solve, pverp)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zgrid</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zgrid&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">z_int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">        end subroutine </span><span class="n">init_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Finalize variables that are shared and repeatedly used by the `set_mpas_state_*` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">final_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::final_shared_variables&#39;</span>

<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">global_grid_index</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">z_int</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">final_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `u` (i.e., horizontal velocity at edge interfaces).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_u</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">reverse</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_tests_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">vc_height</span>
<span class="w">            </span><span class="k">use </span><span class="n">inic_analytic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_set_inic_col</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_u&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;u&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;buffer_2d_real(ncells_solve, pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructZonal&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructMeridional&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">compute_edge_wind</span><span class="p">(</span><span class="n">wind_tendency</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_u</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `w` (i.e., vertical velocity at cell interfaces).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_w</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_w&#39;</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;w&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="n">w</span><span class="p">(:,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_dyn_mpas</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_w</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `scalars` (i.e., constituents).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-17)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_scalars</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">num_constituents</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">const_is_advected</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">qv_of_sh</span><span class="p">,</span><span class="w"> </span><span class="n">reverse</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_tests_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">vc_height</span>
<span class="w">            </span><span class="k">use </span><span class="n">inic_analytic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_set_inic_col</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="c">! CCPP standard name of `qv`, which denotes water vapor mixing ratio.</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituent_qv_standard_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;water_vapor_mixing_ratio_wrt_dry_air&#39;</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_scalars&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituent_index</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">index_qv</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scalars</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;scalars&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">buffer_3d_real</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;buffer_3d_real(ncells_solve, pver, num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">constituent_index</span><span class="p">(</span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;constituent_index(num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dim&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;index_qv&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scalars&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="n">buffer_3d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="c">! Extract indices for all advected constituents.</span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_constituents</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">const_is_advected</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">constituent_index</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">num_advected</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        exit</span><span class="w"> </span><span class="c">!Break out of loop if no more advected constituents</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end if</span>
<span class="k">            end do</span>

<span class="k">            call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">buffer_3d_real</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">m_cnst</span><span class="o">=</span><span class="n">constituent_index</span><span class="p">)</span>

<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="c">! `j` is indexing into `scalars`, so it is regarded as MPAS scalar index.</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">                    </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">                    </span><span class="n">scalars</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="kt">real</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_3d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_constituent_index</span><span class="p">(</span><span class="n">j</span><span class="p">))),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end do</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_constituent_name</span><span class="p">(</span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_constituent_index</span><span class="p">(</span><span class="n">index_qv</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituent_qv_standard_name</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! The definition of `qv` matches exactly what MPAS wants. No conversion is needed.</span>
<span class="w">                </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No conversion is needed for water vapor mixing ratio&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="c">! The definition of `qv` actually represents specific humidity. Conversion is needed.</span>
<span class="w">                </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Conversion is needed and applied for water vapor mixing ratio&#39;</span><span class="p">)</span>

<span class="w">                </span><span class="c">! Convert specific humidity to water vapor mixing ratio.</span>
<span class="w">                </span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">qv_of_sh</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="kt">real</span><span class="p">(</span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">buffer_3d_real</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">constituent_index</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;scalars&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_scalars</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `rho` (i.e., dry air density) and `theta` (i.e., potential temperature).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-19)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_rho_theta</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">,</span><span class="w"> </span><span class="n">rho_by_equation_of_state</span><span class="p">,</span><span class="w"> </span><span class="n">theta_by_poisson_equation</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                      </span><span class="n">tm_of_t_qv</span><span class="p">,</span><span class="w"> </span><span class="n">tv_of_tm_qv</span><span class="p">,</span><span class="w"> </span><span class="n">reverse</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_tests_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">vc_height</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_cpd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cpair</span><span class="p">,</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span><span class="p">,</span><span class="w"> </span><span class="n">constant_p0</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pref</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rv</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rh2o</span>
<span class="w">            </span><span class="k">use </span><span class="n">inic_analytic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_set_inic_col</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_rho_theta&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">index_qv</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">(:)</span><span class="w">  </span><span class="c">! Pressure (Pa) at layer midpoints of each column. This is full pressure,</span>
<span class="w">                                                        </span><span class="c">! which also accounts for water vapor.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_sfc</span><span class="p">(:)</span><span class="w">      </span><span class="c">! Pressure (Pa) at surface. This is full pressure,</span>
<span class="w">                                                        </span><span class="c">! which also accounts for water vapor.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="c">! Water vapor mixing ratio (kg/kg) at layer midpoints of each column.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">   </span><span class="c">! Temperature (K) at layer midpoints.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="c">! Modified &quot;moist&quot; temperature (K) at layer midpoints of each column.</span>
<span class="w">                                                        </span><span class="c">! Be advised that it is not virtual temperature.</span>
<span class="w">                                                        </span><span class="c">! See doi:10.5065/1DFH-6P97 and doi:10.1175/MWR-D-11-00215.1 for details.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="c">! Virtual temperature (K) at layer midpoints of each column.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rho</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">theta</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scalars</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;rho&quot; and &quot;theta&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">p_sfc</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;p_sfc(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="n">p_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">ps</span><span class="o">=</span><span class="n">p_sfc</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;buffer_2d_real(ncells_solve, pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">t_mid</span><span class="p">(</span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;t_mid(pver, ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">=</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;p_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;qv_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">tm_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tm_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">tv_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tv_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dim&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;index_qv&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rho&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scalars&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Set `rho` and `theta` column by column. This way, peak memory usage can be reduced.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">qv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">                </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tm_of_t_qv</span><span class="p">(</span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rv</span><span class="p">,</span><span class="w"> </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">)</span>
<span class="w">                </span><span class="n">tv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tv_of_tm_qv</span><span class="p">(</span><span class="n">tm_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">)</span>

<span class="w">                </span><span class="c">! Piecewise integrate hypsometric equation to derive `p_mid_col(1)`.</span>
<span class="w">                </span><span class="c">! The formulation used here is exact.</span>
<span class="w">                </span><span class="n">p_mid_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">p_sfc</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">tv_mid_col</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>

<span class="w">                </span><span class="c">! Piecewise integrate hypsometric equation to derive subsequent `p_mid_col(k)`.</span>
<span class="w">                </span><span class="c">! The formulation used here is exact.</span>
<span class="w">                </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span>
<span class="w">                    </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">tv_mid_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">tv_mid_col</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>
<span class="w">                </span><span class="k">end do</span>

<span class="k">                </span><span class="n">rho</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">rho_by_equation_of_state</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">                </span><span class="n">theta</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">theta_by_poisson_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">constant_cpd</span><span class="p">,</span><span class="w"> </span><span class="n">constant_p0</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">p_sfc</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">t_mid</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">tm_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">tv_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_rho_theta</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `rho_base` (i.e., base state dry air density) and `theta_base` (i.e., base state potential temperature).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-21)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_rho_base_theta_base</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">,</span><span class="w"> </span><span class="n">rho_by_equation_of_state</span><span class="p">,</span><span class="w"> </span><span class="n">theta_by_poisson_equation</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_cpd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cpair</span><span class="p">,</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span><span class="p">,</span><span class="w"> </span><span class="n">constant_p0</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pref</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_rho_base_theta_base&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t_base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="mf">0.0_kind_r8</span><span class="w"> </span><span class="c">! Base state temperature (K) of dry isothermal atmosphere.</span>
<span class="w">                                                               </span><span class="c">! The value used here is identical to MPAS.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_base</span><span class="p">(:)</span><span class="w">            </span><span class="c">! Base state pressure (Pa) at layer midpoints of each column.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rho_base</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">theta_base</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;rho_base&quot; and &quot;theta_base&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">p_base</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;p_base(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">rho_base</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rho_base&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">theta_base</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;theta_base&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zz&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Set `rho_base` and `theta_base` column by column. This way, peak memory usage can be reduced.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span>
<span class="w">                    </span><span class="c">! Derive `p_base` by hypsometric equation.</span>
<span class="w">                    </span><span class="c">! The formulation used here is exact and identical to MPAS.</span>
<span class="w">                    </span><span class="n">p_base</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">constant_p0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mf">0.0_kind_r8</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">t_base</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>
<span class="w">                </span><span class="k">end do</span>

<span class="k">                </span><span class="n">rho_base</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">rho_by_equation_of_state</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">p_base</span><span class="p">,</span><span class="w"> </span><span class="n">t_base</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">                </span><span class="n">theta_base</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">theta_by_poisson_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">constant_cpd</span><span class="p">,</span><span class="w"> </span><span class="n">constant_p0</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">t_base</span><span class="p">,</span><span class="w"> </span><span class="n">p_base</span><span class="p">),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">p_base</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;rho_base&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;theta_base&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_rho_base_theta_base</span>
<span class="w">    </span><span class="k">end subroutine </span><span class="n">set_analytic_initial_condition</span>
</pre></div>

        </section>
        <br>
    </div>
  </div>
      <hr>
    </div>

    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              MPAS Dynamical Core
was developed by CAM-SIMA & MPAS Developers<br>              Â© 2026 
            </p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div>
    </footer>
  </body>
</html>